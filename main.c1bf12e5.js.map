{"version":3,"file":"main.c1bf12e5.js","sources":["./environment-dep-replace.cjs??ruleSet[1].rules[2].use[0]!./node_modules/@mui/material/ButtonBase/TouchRipple.js","./environment-dep-replace.cjs??ruleSet[1].rules[2].use[0]!./node_modules/@mui/material/LinearProgress/LinearProgress.js","./environment-dep-replace.cjs??ruleSet[1].rules[2].use[0]!../x-data-spreadsheet/dist/xspreadsheet.js","./environment-dep-replace.cjs??ruleSet[1].rules[2].use[0]!./src/components/Pages/Settings.tsx","./environment-dep-replace.cjs??ruleSet[1].rules[2].use[0]!./src/slices/phraseSlice.ts"],"sourcesContent":["'use client';\n\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nconst _excluded = [\"center\", \"classes\", \"className\"];\nlet _ = t => t,\n  _t,\n  _t2,\n  _t3,\n  _t4;\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport { TransitionGroup } from 'react-transition-group';\nimport clsx from 'clsx';\nimport { keyframes } from '@mui/system';\nimport styled from '../styles/styled';\nimport useThemeProps from '../styles/useThemeProps';\nimport Ripple from './Ripple';\nimport touchRippleClasses from './touchRippleClasses';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nconst DURATION = 550;\nexport const DELAY_RIPPLE = 80;\nconst enterKeyframe = keyframes(_t || (_t = _`\n  0% {\n    transform: scale(0);\n    opacity: 0.1;\n  }\n\n  100% {\n    transform: scale(1);\n    opacity: 0.3;\n  }\n`));\nconst exitKeyframe = keyframes(_t2 || (_t2 = _`\n  0% {\n    opacity: 1;\n  }\n\n  100% {\n    opacity: 0;\n  }\n`));\nconst pulsateKeyframe = keyframes(_t3 || (_t3 = _`\n  0% {\n    transform: scale(1);\n  }\n\n  50% {\n    transform: scale(0.92);\n  }\n\n  100% {\n    transform: scale(1);\n  }\n`));\nexport const TouchRippleRoot = styled('span', {\n  name: 'MuiTouchRipple',\n  slot: 'Root'\n})({\n  overflow: 'hidden',\n  pointerEvents: 'none',\n  position: 'absolute',\n  zIndex: 0,\n  top: 0,\n  right: 0,\n  bottom: 0,\n  left: 0,\n  borderRadius: 'inherit'\n});\n\n// This `styled()` function invokes keyframes. `styled-components` only supports keyframes\n// in string templates. Do not convert these styles in JS object as it will break.\nexport const TouchRippleRipple = styled(Ripple, {\n  name: 'MuiTouchRipple',\n  slot: 'Ripple'\n})(_t4 || (_t4 = _`\n  opacity: 0;\n  position: absolute;\n\n  &.${0} {\n    opacity: 0.3;\n    transform: scale(1);\n    animation-name: ${0};\n    animation-duration: ${0}ms;\n    animation-timing-function: ${0};\n  }\n\n  &.${0} {\n    animation-duration: ${0}ms;\n  }\n\n  & .${0} {\n    opacity: 1;\n    display: block;\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    background-color: currentColor;\n  }\n\n  & .${0} {\n    opacity: 0;\n    animation-name: ${0};\n    animation-duration: ${0}ms;\n    animation-timing-function: ${0};\n  }\n\n  & .${0} {\n    position: absolute;\n    /* @noflip */\n    left: 0px;\n    top: 0;\n    animation-name: ${0};\n    animation-duration: 2500ms;\n    animation-timing-function: ${0};\n    animation-iteration-count: infinite;\n    animation-delay: 200ms;\n  }\n`), touchRippleClasses.rippleVisible, enterKeyframe, DURATION, ({\n  theme\n}) => theme.transitions.easing.easeInOut, touchRippleClasses.ripplePulsate, ({\n  theme\n}) => theme.transitions.duration.shorter, touchRippleClasses.child, touchRippleClasses.childLeaving, exitKeyframe, DURATION, ({\n  theme\n}) => theme.transitions.easing.easeInOut, touchRippleClasses.childPulsate, pulsateKeyframe, ({\n  theme\n}) => theme.transitions.easing.easeInOut);\n\n/**\n * @ignore - internal component.\n *\n * TODO v5: Make private\n */\nconst TouchRipple = /*#__PURE__*/React.forwardRef(function TouchRipple(inProps, ref) {\n  const props = useThemeProps({\n    props: inProps,\n    name: 'MuiTouchRipple'\n  });\n  const {\n      center: centerProp = false,\n      classes = {},\n      className\n    } = props,\n    other = _objectWithoutPropertiesLoose(props, _excluded);\n  const [ripples, setRipples] = React.useState([]);\n  const nextKey = React.useRef(0);\n  const rippleCallback = React.useRef(null);\n  React.useEffect(() => {\n    if (rippleCallback.current) {\n      rippleCallback.current();\n      rippleCallback.current = null;\n    }\n  }, [ripples]);\n\n  // Used to filter out mouse emulated events on mobile.\n  const ignoringMouseDown = React.useRef(false);\n  // We use a timer in order to only show the ripples for touch \"click\" like events.\n  // We don't want to display the ripple for touch scroll events.\n  const startTimer = React.useRef(0);\n\n  // This is the hook called once the previous timeout is ready.\n  const startTimerCommit = React.useRef(null);\n  const container = React.useRef(null);\n  React.useEffect(() => {\n    return () => {\n      if (startTimer.current) {\n        clearTimeout(startTimer.current);\n      }\n    };\n  }, []);\n  const startCommit = React.useCallback(params => {\n    const {\n      pulsate,\n      rippleX,\n      rippleY,\n      rippleSize,\n      cb\n    } = params;\n    setRipples(oldRipples => [...oldRipples, /*#__PURE__*/_jsx(TouchRippleRipple, {\n      classes: {\n        ripple: clsx(classes.ripple, touchRippleClasses.ripple),\n        rippleVisible: clsx(classes.rippleVisible, touchRippleClasses.rippleVisible),\n        ripplePulsate: clsx(classes.ripplePulsate, touchRippleClasses.ripplePulsate),\n        child: clsx(classes.child, touchRippleClasses.child),\n        childLeaving: clsx(classes.childLeaving, touchRippleClasses.childLeaving),\n        childPulsate: clsx(classes.childPulsate, touchRippleClasses.childPulsate)\n      },\n      timeout: DURATION,\n      pulsate: pulsate,\n      rippleX: rippleX,\n      rippleY: rippleY,\n      rippleSize: rippleSize\n    }, nextKey.current)]);\n    nextKey.current += 1;\n    rippleCallback.current = cb;\n  }, [classes]);\n  const start = React.useCallback((event = {}, options = {}, cb = () => {}) => {\n    const {\n      pulsate = false,\n      center = centerProp || options.pulsate,\n      fakeElement = false // For test purposes\n    } = options;\n    if ((event == null ? void 0 : event.type) === 'mousedown' && ignoringMouseDown.current) {\n      ignoringMouseDown.current = false;\n      return;\n    }\n    if ((event == null ? void 0 : event.type) === 'touchstart') {\n      ignoringMouseDown.current = true;\n    }\n    const element = fakeElement ? null : container.current;\n    const rect = element ? element.getBoundingClientRect() : {\n      width: 0,\n      height: 0,\n      left: 0,\n      top: 0\n    };\n\n    // Get the size of the ripple\n    let rippleX;\n    let rippleY;\n    let rippleSize;\n    if (center || event === undefined || event.clientX === 0 && event.clientY === 0 || !event.clientX && !event.touches) {\n      rippleX = Math.round(rect.width / 2);\n      rippleY = Math.round(rect.height / 2);\n    } else {\n      const {\n        clientX,\n        clientY\n      } = event.touches && event.touches.length > 0 ? event.touches[0] : event;\n      rippleX = Math.round(clientX - rect.left);\n      rippleY = Math.round(clientY - rect.top);\n    }\n    if (center) {\n      rippleSize = Math.sqrt((2 * rect.width ** 2 + rect.height ** 2) / 3);\n\n      // For some reason the animation is broken on Mobile Chrome if the size is even.\n      if (rippleSize % 2 === 0) {\n        rippleSize += 1;\n      }\n    } else {\n      const sizeX = Math.max(Math.abs((element ? element.clientWidth : 0) - rippleX), rippleX) * 2 + 2;\n      const sizeY = Math.max(Math.abs((element ? element.clientHeight : 0) - rippleY), rippleY) * 2 + 2;\n      rippleSize = Math.sqrt(sizeX ** 2 + sizeY ** 2);\n    }\n\n    // Touche devices\n    if (event != null && event.touches) {\n      // check that this isn't another touchstart due to multitouch\n      // otherwise we will only clear a single timer when unmounting while two\n      // are running\n      if (startTimerCommit.current === null) {\n        // Prepare the ripple effect.\n        startTimerCommit.current = () => {\n          startCommit({\n            pulsate,\n            rippleX,\n            rippleY,\n            rippleSize,\n            cb\n          });\n        };\n        // Delay the execution of the ripple effect.\n        startTimer.current = setTimeout(() => {\n          if (startTimerCommit.current) {\n            startTimerCommit.current();\n            startTimerCommit.current = null;\n          }\n        }, DELAY_RIPPLE); // We have to make a tradeoff with this value.\n      }\n    } else {\n      startCommit({\n        pulsate,\n        rippleX,\n        rippleY,\n        rippleSize,\n        cb\n      });\n    }\n  }, [centerProp, startCommit]);\n  const pulsate = React.useCallback(() => {\n    start({}, {\n      pulsate: true\n    });\n  }, [start]);\n  const stop = React.useCallback((event, cb) => {\n    clearTimeout(startTimer.current);\n\n    // The touch interaction occurs too quickly.\n    // We still want to show ripple effect.\n    if ((event == null ? void 0 : event.type) === 'touchend' && startTimerCommit.current) {\n      startTimerCommit.current();\n      startTimerCommit.current = null;\n      startTimer.current = setTimeout(() => {\n        stop(event, cb);\n      });\n      return;\n    }\n    startTimerCommit.current = null;\n    setRipples(oldRipples => {\n      if (oldRipples.length > 0) {\n        return oldRipples.slice(1);\n      }\n      return oldRipples;\n    });\n    rippleCallback.current = cb;\n  }, []);\n  React.useImperativeHandle(ref, () => ({\n    pulsate,\n    start,\n    stop\n  }), [pulsate, start, stop]);\n  return /*#__PURE__*/_jsx(TouchRippleRoot, _extends({\n    className: clsx(touchRippleClasses.root, classes.root, className),\n    ref: container\n  }, other, {\n    children: /*#__PURE__*/_jsx(TransitionGroup, {\n      component: null,\n      exit: true,\n      children: ripples\n    })\n  }));\n});\nprocess.env.NODE_ENV !== \"production\" ? TouchRipple.propTypes = {\n  /**\n   * If `true`, the ripple starts at the center of the component\n   * rather than at the point of interaction.\n   */\n  center: PropTypes.bool,\n  /**\n   * Override or extend the styles applied to the component.\n   * See [CSS API](#css) below for more details.\n   */\n  classes: PropTypes.object,\n  /**\n   * @ignore\n   */\n  className: PropTypes.string\n} : void 0;\nexport default TouchRipple;","'use client';\n\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nconst _excluded = [\"className\", \"color\", \"value\", \"valueBuffer\", \"variant\"];\nlet _ = t => t,\n  _t,\n  _t2,\n  _t3,\n  _t4,\n  _t5,\n  _t6;\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport { unstable_composeClasses as composeClasses } from '@mui/base/composeClasses';\nimport { keyframes, css, darken, lighten } from '@mui/system';\nimport capitalize from '../utils/capitalize';\nimport useTheme from '../styles/useTheme';\nimport styled from '../styles/styled';\nimport useThemeProps from '../styles/useThemeProps';\nimport { getLinearProgressUtilityClass } from './linearProgressClasses';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nconst TRANSITION_DURATION = 4; // seconds\nconst indeterminate1Keyframe = keyframes(_t || (_t = _`\n  0% {\n    left: -35%;\n    right: 100%;\n  }\n\n  60% {\n    left: 100%;\n    right: -90%;\n  }\n\n  100% {\n    left: 100%;\n    right: -90%;\n  }\n`));\nconst indeterminate2Keyframe = keyframes(_t2 || (_t2 = _`\n  0% {\n    left: -200%;\n    right: 100%;\n  }\n\n  60% {\n    left: 107%;\n    right: -8%;\n  }\n\n  100% {\n    left: 107%;\n    right: -8%;\n  }\n`));\nconst bufferKeyframe = keyframes(_t3 || (_t3 = _`\n  0% {\n    opacity: 1;\n    background-position: 0 -23px;\n  }\n\n  60% {\n    opacity: 0;\n    background-position: 0 -23px;\n  }\n\n  100% {\n    opacity: 1;\n    background-position: -200px -23px;\n  }\n`));\nconst useUtilityClasses = ownerState => {\n  const {\n    classes,\n    variant,\n    color\n  } = ownerState;\n  const slots = {\n    root: ['root', `color${capitalize(color)}`, variant],\n    dashed: ['dashed', `dashedColor${capitalize(color)}`],\n    bar1: ['bar', `barColor${capitalize(color)}`, (variant === 'indeterminate' || variant === 'query') && 'bar1Indeterminate', variant === 'determinate' && 'bar1Determinate', variant === 'buffer' && 'bar1Buffer'],\n    bar2: ['bar', variant !== 'buffer' && `barColor${capitalize(color)}`, variant === 'buffer' && `color${capitalize(color)}`, (variant === 'indeterminate' || variant === 'query') && 'bar2Indeterminate', variant === 'buffer' && 'bar2Buffer']\n  };\n  return composeClasses(slots, getLinearProgressUtilityClass, classes);\n};\nconst getColorShade = (theme, color) => {\n  if (color === 'inherit') {\n    return 'currentColor';\n  }\n  if (theme.vars) {\n    return theme.vars.palette.LinearProgress[`${color}Bg`];\n  }\n  return theme.palette.mode === 'light' ? lighten(theme.palette[color].main, 0.62) : darken(theme.palette[color].main, 0.5);\n};\nconst LinearProgressRoot = styled('span', {\n  name: 'MuiLinearProgress',\n  slot: 'Root',\n  overridesResolver: (props, styles) => {\n    const {\n      ownerState\n    } = props;\n    return [styles.root, styles[`color${capitalize(ownerState.color)}`], styles[ownerState.variant]];\n  }\n})(({\n  ownerState,\n  theme\n}) => _extends({\n  position: 'relative',\n  overflow: 'hidden',\n  display: 'block',\n  height: 4,\n  zIndex: 0,\n  // Fix Safari's bug during composition of different paint.\n  '@media print': {\n    colorAdjust: 'exact'\n  },\n  backgroundColor: getColorShade(theme, ownerState.color)\n}, ownerState.color === 'inherit' && ownerState.variant !== 'buffer' && {\n  backgroundColor: 'none',\n  '&::before': {\n    content: '\"\"',\n    position: 'absolute',\n    left: 0,\n    top: 0,\n    right: 0,\n    bottom: 0,\n    backgroundColor: 'currentColor',\n    opacity: 0.3\n  }\n}, ownerState.variant === 'buffer' && {\n  backgroundColor: 'transparent'\n}, ownerState.variant === 'query' && {\n  transform: 'rotate(180deg)'\n}));\nconst LinearProgressDashed = styled('span', {\n  name: 'MuiLinearProgress',\n  slot: 'Dashed',\n  overridesResolver: (props, styles) => {\n    const {\n      ownerState\n    } = props;\n    return [styles.dashed, styles[`dashedColor${capitalize(ownerState.color)}`]];\n  }\n})(({\n  ownerState,\n  theme\n}) => {\n  const backgroundColor = getColorShade(theme, ownerState.color);\n  return _extends({\n    position: 'absolute',\n    marginTop: 0,\n    height: '100%',\n    width: '100%'\n  }, ownerState.color === 'inherit' && {\n    opacity: 0.3\n  }, {\n    backgroundImage: `radial-gradient(${backgroundColor} 0%, ${backgroundColor} 16%, transparent 42%)`,\n    backgroundSize: '10px 10px',\n    backgroundPosition: '0 -23px'\n  });\n}, css(_t4 || (_t4 = _`\n    animation: ${0} 3s infinite linear;\n  `), bufferKeyframe));\nconst LinearProgressBar1 = styled('span', {\n  name: 'MuiLinearProgress',\n  slot: 'Bar1',\n  overridesResolver: (props, styles) => {\n    const {\n      ownerState\n    } = props;\n    return [styles.bar, styles[`barColor${capitalize(ownerState.color)}`], (ownerState.variant === 'indeterminate' || ownerState.variant === 'query') && styles.bar1Indeterminate, ownerState.variant === 'determinate' && styles.bar1Determinate, ownerState.variant === 'buffer' && styles.bar1Buffer];\n  }\n})(({\n  ownerState,\n  theme\n}) => _extends({\n  width: '100%',\n  position: 'absolute',\n  left: 0,\n  bottom: 0,\n  top: 0,\n  transition: 'transform 0.2s linear',\n  transformOrigin: 'left',\n  backgroundColor: ownerState.color === 'inherit' ? 'currentColor' : (theme.vars || theme).palette[ownerState.color].main\n}, ownerState.variant === 'determinate' && {\n  transition: `transform .${TRANSITION_DURATION}s linear`\n}, ownerState.variant === 'buffer' && {\n  zIndex: 1,\n  transition: `transform .${TRANSITION_DURATION}s linear`\n}), ({\n  ownerState\n}) => (ownerState.variant === 'indeterminate' || ownerState.variant === 'query') && css(_t5 || (_t5 = _`\n      width: auto;\n      animation: ${0} 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;\n    `), indeterminate1Keyframe));\nconst LinearProgressBar2 = styled('span', {\n  name: 'MuiLinearProgress',\n  slot: 'Bar2',\n  overridesResolver: (props, styles) => {\n    const {\n      ownerState\n    } = props;\n    return [styles.bar, styles[`barColor${capitalize(ownerState.color)}`], (ownerState.variant === 'indeterminate' || ownerState.variant === 'query') && styles.bar2Indeterminate, ownerState.variant === 'buffer' && styles.bar2Buffer];\n  }\n})(({\n  ownerState,\n  theme\n}) => _extends({\n  width: '100%',\n  position: 'absolute',\n  left: 0,\n  bottom: 0,\n  top: 0,\n  transition: 'transform 0.2s linear',\n  transformOrigin: 'left'\n}, ownerState.variant !== 'buffer' && {\n  backgroundColor: ownerState.color === 'inherit' ? 'currentColor' : (theme.vars || theme).palette[ownerState.color].main\n}, ownerState.color === 'inherit' && {\n  opacity: 0.3\n}, ownerState.variant === 'buffer' && {\n  backgroundColor: getColorShade(theme, ownerState.color),\n  transition: `transform .${TRANSITION_DURATION}s linear`\n}), ({\n  ownerState\n}) => (ownerState.variant === 'indeterminate' || ownerState.variant === 'query') && css(_t6 || (_t6 = _`\n      width: auto;\n      animation: ${0} 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite;\n    `), indeterminate2Keyframe));\n\n/**\n * ## ARIA\n *\n * If the progress bar is describing the loading progress of a particular region of a page,\n * you should use `aria-describedby` to point to the progress bar, and set the `aria-busy`\n * attribute to `true` on that region until it has finished loading.\n */\nconst LinearProgress = /*#__PURE__*/React.forwardRef(function LinearProgress(inProps, ref) {\n  const props = useThemeProps({\n    props: inProps,\n    name: 'MuiLinearProgress'\n  });\n  const {\n      className,\n      color = 'primary',\n      value,\n      valueBuffer,\n      variant = 'indeterminate'\n    } = props,\n    other = _objectWithoutPropertiesLoose(props, _excluded);\n  const ownerState = _extends({}, props, {\n    color,\n    variant\n  });\n  const classes = useUtilityClasses(ownerState);\n  const theme = useTheme();\n  const rootProps = {};\n  const inlineStyles = {\n    bar1: {},\n    bar2: {}\n  };\n  if (variant === 'determinate' || variant === 'buffer') {\n    if (value !== undefined) {\n      rootProps['aria-valuenow'] = Math.round(value);\n      rootProps['aria-valuemin'] = 0;\n      rootProps['aria-valuemax'] = 100;\n      let transform = value - 100;\n      if (theme.direction === 'rtl') {\n        transform = -transform;\n      }\n      inlineStyles.bar1.transform = `translateX(${transform}%)`;\n    } else if (process.env.NODE_ENV !== 'production') {\n      console.error('MUI: You need to provide a value prop ' + 'when using the determinate or buffer variant of LinearProgress .');\n    }\n  }\n  if (variant === 'buffer') {\n    if (valueBuffer !== undefined) {\n      let transform = (valueBuffer || 0) - 100;\n      if (theme.direction === 'rtl') {\n        transform = -transform;\n      }\n      inlineStyles.bar2.transform = `translateX(${transform}%)`;\n    } else if (process.env.NODE_ENV !== 'production') {\n      console.error('MUI: You need to provide a valueBuffer prop ' + 'when using the buffer variant of LinearProgress.');\n    }\n  }\n  return /*#__PURE__*/_jsxs(LinearProgressRoot, _extends({\n    className: clsx(classes.root, className),\n    ownerState: ownerState,\n    role: \"progressbar\"\n  }, rootProps, {\n    ref: ref\n  }, other, {\n    children: [variant === 'buffer' ? /*#__PURE__*/_jsx(LinearProgressDashed, {\n      className: classes.dashed,\n      ownerState: ownerState\n    }) : null, /*#__PURE__*/_jsx(LinearProgressBar1, {\n      className: classes.bar1,\n      ownerState: ownerState,\n      style: inlineStyles.bar1\n    }), variant === 'determinate' ? null : /*#__PURE__*/_jsx(LinearProgressBar2, {\n      className: classes.bar2,\n      ownerState: ownerState,\n      style: inlineStyles.bar2\n    })]\n  }));\n});\nprocess.env.NODE_ENV !== \"production\" ? LinearProgress.propTypes /* remove-proptypes */ = {\n  // ----------------------------- Warning --------------------------------\n  // | These PropTypes are generated from the TypeScript type definitions |\n  // |     To update them edit the d.ts file and run \"yarn proptypes\"     |\n  // ----------------------------------------------------------------------\n  /**\n   * Override or extend the styles applied to the component.\n   */\n  classes: PropTypes.object,\n  /**\n   * @ignore\n   */\n  className: PropTypes.string,\n  /**\n   * The color of the component.\n   * It supports both default and custom theme colors, which can be added as shown in the\n   * [palette customization guide](https://mui.com/material-ui/customization/palette/#custom-colors).\n   * @default 'primary'\n   */\n  color: PropTypes /* @typescript-to-proptypes-ignore */.oneOfType([PropTypes.oneOf(['inherit', 'primary', 'secondary']), PropTypes.string]),\n  /**\n   * The system prop that allows defining system overrides as well as additional CSS styles.\n   */\n  sx: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.func, PropTypes.object, PropTypes.bool])), PropTypes.func, PropTypes.object]),\n  /**\n   * The value of the progress indicator for the determinate and buffer variants.\n   * Value between 0 and 100.\n   */\n  value: PropTypes.number,\n  /**\n   * The value for the buffer variant.\n   * Value between 0 and 100.\n   */\n  valueBuffer: PropTypes.number,\n  /**\n   * The variant to use.\n   * Use indeterminate or query when there is no progress value.\n   * @default 'indeterminate'\n   */\n  variant: PropTypes.oneOf(['buffer', 'determinate', 'indeterminate', 'query'])\n} : void 0;\nexport default LinearProgress;","var __webpack_modules__={6293:function(e,t,i){\"use strict\";function s(){return window.devicePixelRatio||1}function l(){return s()-.5}function r(e){return parseInt(e*s(),10)}function n(e){let t=r(e);return t>0?t-.5:.5}i.r(t),i.d(t,{Draw:function(){return o},DrawBox:function(){return h},thinLineWidth:function(){return l},npx:function(){return r}});class h{constructor(e,t,i,s,l=0){this.x=e,this.y=t,this.width=i,this.height=s,this.padding=l,this.bgcolor=\"#ffffff\",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null}setBorders({top:e,bottom:t,left:i,right:s}){e&&(this.borderTop=e),s&&(this.borderRight=s),t&&(this.borderBottom=t),i&&(this.borderLeft=i)}innerWidth(){return this.width-2*this.padding-2}innerHeight(){return this.height-2*this.padding-2}textx(e){let{width:t,padding:i}=this,{x:s}=this;return\"left\"===e?s+=i:\"center\"===e?s+=t/2:\"right\"===e&&(s+=t-i),s}texty(e,t){let{height:i,padding:s}=this,{y:l}=this;return\"top\"===e?l+=s:\"middle\"===e?l+=i/2-t/2:\"bottom\"===e&&(l+=i-s-t),l}topxys(){let{x:e,y:t,width:i}=this;return[[e,t],[e+i,t]]}rightxys(){let{x:e,y:t,width:i,height:s}=this;return[[e+i,t],[e+i,t+s]]}bottomxys(){let{x:e,y:t,width:i,height:s}=this;return[[e,t+s],[e+i,t+s]]}leftxys(){let{x:e,y:t,height:i}=this;return[[e,t],[e,t+i]]}}function a(e,t,i,s,l,r,n){let h={x:0,y:0};\"underline\"===e?\"bottom\"===l?h.y=0:\"top\"===l?h.y=-(r+2):h.y=-r/2:\"strike\"===e&&(\"bottom\"===l?h.y=r/2:\"top\"===l&&(h.y=-(r/2+2))),\"center\"===s?h.x=n/2:\"right\"===s&&(h.x=n),this.line([t-h.x,i-h.y],[t-h.x+n,i-h.y])}class o{constructor(e,t,i){this.el=e,this.ctx=e.getContext(\"2d\"),this.resize(t,i),this.ctx.scale(s(),s())}resize(e,t){this.el.style.width=`${e}px`,this.el.style.height=`${t}px`,this.el.width=r(e),this.el.height=r(t)}clear(){let{width:e,height:t}=this.el;return this.ctx.clearRect(0,0,e,t),this}attr(e){return Object.assign(this.ctx,e),this}save(){return this.ctx.save(),this.ctx.beginPath(),this}restore(){return this.ctx.restore(),this}beginPath(){return this.ctx.beginPath(),this}translate(e,t){return this.ctx.translate(r(e),r(t)),this}scale(e,t){return this.ctx.scale(e,t),this}clearRect(e,t,i,s){return this.ctx.clearRect(e,t,i,s),this}fillRect(e,t,i,s){return this.ctx.fillRect(r(e)-.5,r(t)-.5,r(i),r(s)),this}fillText(e,t,i){return this.ctx.fillText(e,r(t),r(i)),this}text(e,t,i={},s=!0){let{ctx:l}=this,{align:n,valign:h,font:o,color:c,strike:d,underline:u}=i,f=t.textx(n);l.save(),l.beginPath(),this.attr({textAlign:n,textBaseline:h,font:`${o.italic?\"italic\":\"\"} ${o.bold?\"bold\":\"\"} ${r(o.size)}px ${o.name}`,fillStyle:c,strokeStyle:c});let g=`${e}`.split(\"\\n\"),p=t.innerWidth(),m=[];g.forEach(e=>{let t=l.measureText(e).width;if(s&&t>r(p)){let t={w:0,len:0,start:0};for(let i=0;i<e.length;i+=1)t.w>=r(p)&&(m.push(e.substr(t.start,t.len)),t={w:0,len:0,start:i}),t.len+=1,t.w+=l.measureText(e[i]).width+1;t.len>0&&m.push(e.substr(t.start,t.len))}else m.push(e)});let w=(m.length-1)*(o.size+2),v=t.texty(h,w);return m.forEach(e=>{let t=l.measureText(e).width;this.fillText(e,f,v),d&&a.call(this,\"strike\",f,v,n,h,o.size,t),u&&a.call(this,\"underline\",f,v,n,h,o.size,t),v+=o.size+2}),l.restore(),this}border(e,t){let{ctx:i}=this;return i.lineWidth=l,i.strokeStyle=t,\"medium\"===e?i.lineWidth=r(2)-.5:\"thick\"===e?i.lineWidth=r(3):\"dashed\"===e?i.setLineDash([r(3),r(2)]):\"dotted\"===e?i.setLineDash([r(1),r(1)]):\"double\"===e&&i.setLineDash([r(2),0]),this}line(...e){let{ctx:t}=this;if(e.length>1){t.beginPath();let[i,s]=e[0];t.moveTo(n(i),n(s));for(let i=1;i<e.length;i+=1){let[s,l]=e[i];t.lineTo(n(s),n(l))}t.stroke()}return this}strokeBorders(e){let{ctx:t}=this;t.save();let{borderTop:i,borderRight:s,borderBottom:l,borderLeft:r}=e;i&&(this.border(...i),this.line(...e.topxys())),s&&(this.border(...s),this.line(...e.rightxys())),l&&(this.border(...l),this.line(...e.bottomxys())),r&&(this.border(...r),this.line(...e.leftxys())),t.restore()}dropdown(e){let{ctx:t}=this,{x:i,y:s,width:l,height:n}=e,h=i+l-15,a=s+n-15;t.save(),t.beginPath(),t.moveTo(r(h),r(a)),t.lineTo(r(h+8),r(a)),t.lineTo(r(h+4),r(a+6)),t.closePath(),t.fillStyle=\"rgba(0, 0, 0, .45)\",t.fill(),t.restore()}error(e){let{ctx:t}=this,{x:i,y:s,width:l}=e,n=i+l-1;t.save(),t.beginPath(),t.moveTo(r(n-8),r(s-1)),t.lineTo(r(n),r(s-1)),t.lineTo(r(n),r(s+8)),t.closePath(),t.fillStyle=\"rgba(255, 0, 0, .65)\",t.fill(),t.restore()}frozen(e){let{ctx:t}=this,{x:i,y:s,width:l}=e,n=i+l-1;t.save(),t.beginPath(),t.moveTo(r(n-8),r(s-1)),t.lineTo(r(n),r(s-1)),t.lineTo(r(n),r(s+8)),t.closePath(),t.fillStyle=\"rgba(0, 255, 0, .85)\",t.fill(),t.restore()}rect(e,t){let{ctx:i}=this,{x:s,y:l,width:h,height:a,bgcolor:o}=e;i.save(),i.beginPath(),i.fillStyle=o||\"#fff\",i.rect(n(s+1),n(l+1),r(h-2),r(a-2)),i.clip(),i.fill(),t(),i.restore()}}},5270:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"3129\"),r=i(\"9992\"),n=i(\"9074\"),h=i(\"4735\"),a=i(\"91\");function o(...e){return(0,l.h)(\"table\",\"\").child((0,l.h)(\"tbody\",\"\").children(...e))}function c(e){return(0,l.h)(\"td\",\"\").child((0,l.h)(\"div\",`${a.cssPrefix}-border-palette-cell`).child(new r.default(`border-${e}`)).on(\"click\",()=>{this.mode=e;let{mode:t,style:i,color:s}=this;this.change({mode:t,style:i,color:s})}))}s=class{constructor(){this.color=\"#000\",this.style=\"thin\",this.mode=\"all\",this.change=()=>{},this.ddColor=new n.default(\"line-color\",this.color),this.ddColor.change=e=>{this.color=e},this.ddType=new h.default(this.style),this.ddType.change=([e])=>{this.style=e},this.el=(0,l.h)(\"div\",`${a.cssPrefix}-border-palette`);let e=o((0,l.h)(\"tr\",\"\").children((0,l.h)(\"td\",`${a.cssPrefix}-border-palette-left`).child(o((0,l.h)(\"tr\",\"\").children(...[\"all\",\"inside\",\"horizontal\",\"vertical\",\"outside\"].map(e=>c.call(this,e))),(0,l.h)(\"tr\",\"\").children(...[\"left\",\"top\",\"right\",\"bottom\",\"none\"].map(e=>c.call(this,e))))),(0,l.h)(\"td\",`${a.cssPrefix}-border-palette-right`).children((0,l.h)(\"div\",`${a.cssPrefix}-toolbar-btn`).child(this.ddColor.el),(0,l.h)(\"div\",`${a.cssPrefix}-toolbar-btn`).child(this.ddType.el))));this.el.child(e)}}},8467:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"3129\"),r=i(\"1092\"),n=i(\"91\"),h=i(\"9992\"),a=i(\"6322\"),o=i(\"450\"),c=i(\"2182\");class d extends o.default{constructor(e){let t=new h.default(\"ellipsis\");super(t,\"auto\",!1,\"top-left\"),this.contentClick=e}reset(e){let t=e.map((e,t)=>(0,l.h)(\"div\",`${n.cssPrefix}-item`).css(\"width\",\"150px\").css(\"font-weight\",\"normal\").on(\"click\",()=>{this.contentClick(t),this.hide()}).child(e));this.setContentChildren(...t)}setTitle(){}}let u=[{key:\"delete\",title:(0,c.tf)(\"contextmenu.deleteSheet\")}];function f(e){return(0,l.h)(\"div\",`${n.cssPrefix}-item`).child(e.title()).on(\"click\",()=>{this.itemClick(e.key),this.hide()})}function g(){return u.map(e=>f.call(this,e))}class p{constructor(){this.el=(0,l.h)(\"div\",`${n.cssPrefix}-contextmenu`).css(\"width\",\"160px\").children(...g.call(this)).hide(),this.itemClick=()=>{}}hide(){let{el:e}=this;e.hide(),(0,r.unbindClickoutside)(e)}setOffset(e){let{el:t}=this;t.offset(e),t.show(),(0,r.bindClickoutside)(t)}}s=class{constructor(e=()=>{},t=()=>{},i=()=>{},s=()=>{}){this.swapFunc=t,this.updateFunc=s,this.dataNames=[],this.activeEl=null,this.deleteEl=null,this.items=[],this.moreEl=new d(e=>{this.clickSwap2(this.items[e])}),this.contextMenu=new p,this.contextMenu.itemClick=i,this.el=(0,l.h)(\"div\",`${n.cssPrefix}-bottombar`).children(this.contextMenu.el,this.menuEl=(0,l.h)(\"ul\",`${n.cssPrefix}-menu`).child((0,l.h)(\"li\",\"\").children(new(0,h.default)(\"add\").on(\"click\",()=>{e()}),(0,l.h)(\"span\",\"\").child(this.moreEl))))}addItem(e,t,i){this.dataNames.push(e);let s=(0,l.h)(\"li\",t?\"active\":\"\").child(e);s.on(\"click\",()=>{this.clickSwap2(s)}).on(\"contextmenu\",e=>{if(\"read\"===i.mode)return;let{offsetLeft:t,offsetHeight:l}=e.target;this.contextMenu.setOffset({left:t,bottom:l+1}),this.deleteEl=s}).on(\"dblclick\",()=>{if(\"read\"===i.mode)return;let e=s.html(),t=new a.default(\"auto\",\"\");t.val(e),t.input.on(\"blur\",({target:t})=>{let{value:i}=t,s=this.dataNames.findIndex(t=>t===e);this.renameItem(s,i)}),s.html(\"\").child(t.el),t.focus()}),t&&this.clickSwap(s),this.items.push(s),this.menuEl.child(s),this.moreEl.reset(this.dataNames)}renameItem(e,t){this.dataNames.splice(e,1,t),this.moreEl.reset(this.dataNames),this.items[e].html(\"\").child(t),this.updateFunc(e,t)}clear(){this.items.forEach(e=>{this.menuEl.removeChild(e.el)}),this.items=[],this.dataNames=[],this.moreEl.reset(this.dataNames)}deleteItem(){let{activeEl:e,deleteEl:t}=this;if(this.items.length>1){let i=this.items.findIndex(e=>e===t);if(this.items.splice(i,1),this.dataNames.splice(i,1),this.menuEl.removeChild(t.el),this.moreEl.reset(this.dataNames),e===t){let[e]=this.items;return this.activeEl=e,this.activeEl.toggle(),[i,0]}return[i,-1]}return[-1]}clickSwap2(e){let t=this.items.findIndex(t=>t===e);this.clickSwap(e),this.activeEl.toggle(),this.swapFunc(t)}clickSwap(e){null!==this.activeEl&&this.activeEl.toggle(),this.activeEl=e}}},5339:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"3129\"),r=i(\"91\"),n=i(\"2182\");s=class extends l.Element{constructor(e,t=\"\"){super(\"div\",`${r.cssPrefix}-button ${t}`),this.child((0,n.t)(`button.${e}`))}}},3936:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"3129\"),r=i(\"9992\"),n=i(\"2182\");function h(e,t){e.setMonth(e.getMonth()+t)}s=class{constructor(e){this.value=e,this.cvalue=new Date(e),this.headerLeftEl=(0,l.h)(\"div\",\"calendar-header-left\"),this.bodyEl=(0,l.h)(\"tbody\",\"\"),this.buildAll(),this.el=(0,l.h)(\"div\",\"x-spreadsheet-calendar\").children((0,l.h)(\"div\",\"calendar-header\").children(this.headerLeftEl,(0,l.h)(\"div\",\"calendar-header-right\").children((0,l.h)(\"a\",\"calendar-prev\").on(\"click.stop\",()=>this.prev()).child(new r.default(\"chevron-left\")),(0,l.h)(\"a\",\"calendar-next\").on(\"click.stop\",()=>this.next()).child(new r.default(\"chevron-right\")))),(0,l.h)(\"table\",\"calendar-body\").children((0,l.h)(\"thead\",\"\").child((0,l.h)(\"tr\",\"\").children(...(0,n.t)(\"calendar.weeks\").map(e=>(0,l.h)(\"th\",\"cell\").child(e)))),this.bodyEl)),this.selectChange=()=>{}}setValue(e){this.value=e,this.cvalue=new Date(e),this.buildAll()}prev(){let{value:e}=this;h(e,-1),this.buildAll()}next(){let{value:e}=this;h(e,1),this.buildAll()}buildAll(){this.buildHeaderLeft(),this.buildBody()}buildHeaderLeft(){let{value:e}=this;this.headerLeftEl.html(`${(0,n.t)(\"calendar.months\")[e.getMonth()]} ${e.getFullYear()}`)}buildBody(){let{value:e,cvalue:t,bodyEl:i}=this,s=function(e,t,i){let s=new Date(e,t,1,23,59,59),l=[[],[],[],[],[],[]];for(let e=0;e<6;e+=1)for(let r=0;r<7;r+=1){let n=7*e+r,h=function(e,t){let i=new Date(e);return i.setDate(t-e.getDay()+1),i}(s,n),a=h.getMonth()!==t,o=h.getMonth()===i.getMonth()&&h.getDate()===i.getDate();l[e][r]={d:h,disabled:a,active:o}}return l}(e.getFullYear(),e.getMonth(),t),r=s.map(e=>{let t=e.map(e=>{let t=\"cell\";return e.disabled&&(t+=\" disabled\"),e.active&&(t+=\" active\"),(0,l.h)(\"td\",\"\").child((0,l.h)(\"div\",t).on(\"click.stop\",()=>{this.selectChange(e.d)}).child(e.d.getDate().toString()))});return(0,l.h)(\"tr\",\"\").children(...t)});i.html(\"\").children(...r)}}},4741:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"3129\"),r=i(\"91\");let n=[\"#ffffff\",\"#000100\",\"#e7e5e6\",\"#445569\",\"#5b9cd6\",\"#ed7d31\",\"#a5a5a5\",\"#ffc001\",\"#4371c6\",\"#71ae47\"],h=[[\"#f2f2f2\",\"#7f7f7f\",\"#d0cecf\",\"#d5dce4\",\"#deeaf6\",\"#fce5d5\",\"#ededed\",\"#fff2cd\",\"#d9e2f3\",\"#e3efd9\"],[\"#d8d8d8\",\"#595959\",\"#afabac\",\"#adb8ca\",\"#bdd7ee\",\"#f7ccac\",\"#dbdbdb\",\"#ffe59a\",\"#b3c6e7\",\"#c5e0b3\"],[\"#bfbfbf\",\"#3f3f3f\",\"#756f6f\",\"#8596b0\",\"#9cc2e6\",\"#f4b184\",\"#c9c9c9\",\"#fed964\",\"#8eaada\",\"#a7d08c\"],[\"#a5a5a5\",\"#262626\",\"#3a3839\",\"#333f4f\",\"#2e75b5\",\"#c45a10\",\"#7b7b7b\",\"#bf8e01\",\"#2f5596\",\"#538136\"],[\"#7f7f7f\",\"#0c0c0c\",\"#171516\",\"#222a35\",\"#1f4e7a\",\"#843c0a\",\"#525252\",\"#7e6000\",\"#203864\",\"#365624\"]],a=[\"#c00000\",\"#fe0000\",\"#fdc101\",\"#ffff01\",\"#93d051\",\"#00b04e\",\"#01b0f1\",\"#0170c1\",\"#012060\",\"#7030a0\"];function o(e){return(0,l.h)(\"td\",\"\").child((0,l.h)(\"div\",`${r.cssPrefix}-color-palette-cell`).on(\"click.stop\",()=>this.change(e)).css(\"background-color\",e))}s=class{constructor(){this.el=(0,l.h)(\"div\",`${r.cssPrefix}-color-palette`),this.change=()=>{};let e=(0,l.h)(\"table\",\"\").children((0,l.h)(\"tbody\",\"\").children((0,l.h)(\"tr\",`${r.cssPrefix}-theme-color-placeholders`).children(...n.map(e=>o.call(this,e))),...h.map(e=>(0,l.h)(\"tr\",`${r.cssPrefix}-theme-colors`).children(...e.map(e=>o.call(this,e)))),(0,l.h)(\"tr\",`${r.cssPrefix}-standard-colors`).children(...a.map(e=>o.call(this,e)))));this.el.child(e)}}},3015:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"3129\"),r=i(\"1092\"),n=i(\"91\"),h=i(\"2182\");let a=[{key:\"copy\",title:(0,h.tf)(\"contextmenu.copy\"),label:\"Ctrl+C\"},{key:\"cut\",title:(0,h.tf)(\"contextmenu.cut\"),label:\"Ctrl+X\"},{key:\"paste\",title:(0,h.tf)(\"contextmenu.paste\"),label:\"Ctrl+V\"},{key:\"paste-value\",title:(0,h.tf)(\"contextmenu.pasteValue\"),label:\"Ctrl+Shift+V\"},{key:\"paste-format\",title:(0,h.tf)(\"contextmenu.pasteFormat\"),label:\"Ctrl+Alt+V\"},{key:\"divider\"},{key:\"insert-row\",title:(0,h.tf)(\"contextmenu.insertRow\")},{key:\"insert-column\",title:(0,h.tf)(\"contextmenu.insertColumn\")},{key:\"divider\"},{key:\"delete-row\",title:(0,h.tf)(\"contextmenu.deleteRow\")},{key:\"delete-column\",title:(0,h.tf)(\"contextmenu.deleteColumn\")},{key:\"delete-cell-text\",title:(0,h.tf)(\"contextmenu.deleteCellText\")},{key:\"hide\",title:(0,h.tf)(\"contextmenu.hide\")},{key:\"divider\"},{key:\"validation\",title:(0,h.tf)(\"contextmenu.validation\")},{key:\"divider\"},{key:\"cell-printable\",title:(0,h.tf)(\"contextmenu.cellprintable\")},{key:\"cell-non-printable\",title:(0,h.tf)(\"contextmenu.cellnonprintable\")},{key:\"divider\"},{key:\"cell-editable\",title:(0,h.tf)(\"contextmenu.celleditable\")},{key:\"cell-non-editable\",title:(0,h.tf)(\"contextmenu.cellnoneditable\")}];function o(e){return\"divider\"===e.key?(0,l.h)(\"div\",`${n.cssPrefix}-item divider`):(0,l.h)(\"div\",`${n.cssPrefix}-item`).on(\"click\",()=>{this.itemClick(e.key),this.hide()}).children(e.title(),(0,l.h)(\"div\",\"label\").child(e.label||\"\"))}function c(){return a.map(e=>o.call(this,e))}s=class{constructor(e,t=!1){this.menuItems=c.call(this),this.el=(0,l.h)(\"div\",`${n.cssPrefix}-contextmenu`).children(...this.menuItems).hide(),this.viewFn=e,this.itemClick=()=>{},this.isHide=t,this.setMode(\"range\")}setMode(e){let t=this.menuItems[12];\"row-col\"===e?t.show():t.hide()}hide(){let{el:e}=this;e.hide(),(0,r.unbindClickoutside)(e)}setPosition(e,t){if(this.isHide)return;let{el:i}=this,{width:s}=i.show().offset(),l=this.viewFn(),n=l.height/2,h=e;l.width-e<=s&&(h-=s),i.css(\"left\",`${h}px`),t>n?i.css(\"bottom\",`${l.height-t}px`).css(\"max-height\",`${t}px`).css(\"top\",\"auto\"):i.css(\"top\",`${t}px`).css(\"max-height\",`${l.height-t}px`).css(\"bottom\",\"auto\"),(0,r.bindClickoutside)(i)}}},3850:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"3936\"),r=i(\"3129\"),n=i(\"91\");s=class{constructor(){this.calendar=new l.default(new Date),this.el=(0,r.h)(\"div\",`${n.cssPrefix}-datepicker`).child(this.calendar.el).hide()}setValue(e){let{calendar:t}=this;return\"string\"==typeof e?/^\\d{4}-\\d{1,2}-\\d{1,2}$/.test(e)&&t.setValue(new Date(e.replace(/-/g,\"/\"))):e instanceof Date&&t.setValue(e),this}change(e){this.calendar.selectChange=t=>{e(t),this.hide()}}show(){this.el.show()}hide(){this.el.hide()}}},450:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"3129\"),r=i(\"1092\"),n=i(\"91\");s=class extends l.Element{constructor(e,t,i,s,...r){super(\"div\",`${n.cssPrefix}-dropdown ${s}`),this.title=e,this.change=()=>{},this.headerClick=()=>{},\"string\"==typeof e?this.title=(0,l.h)(\"div\",`${n.cssPrefix}-dropdown-title`).child(e):i&&this.title.addClass(\"arrow-left\"),this.contentEl=(0,l.h)(\"div\",`${n.cssPrefix}-dropdown-content`).css(\"width\",t).hide(),this.setContentChildren(...r),this.headerEl=(0,l.h)(\"div\",`${n.cssPrefix}-dropdown-header`),this.headerEl.on(\"click\",()=>{\"block\"!==this.contentEl.css(\"display\")?this.show():this.hide()}).children(this.title,i?(0,l.h)(\"div\",`${n.cssPrefix}-icon arrow-right`).child((0,l.h)(\"div\",`${n.cssPrefix}-icon-img arrow-down`)):\"\"),this.children(this.headerEl,this.contentEl)}setContentChildren(...e){this.contentEl.html(\"\"),e.length>0&&this.contentEl.children(...e)}setTitle(e){this.title.html(e),this.hide()}show(){let{contentEl:e}=this;e.show(),this.parent().active(),(0,r.bindClickoutside)(this.parent(),()=>{this.hide()})}hide(){this.parent().active(!1),this.contentEl.hide(),(0,r.unbindClickoutside)(this.parent())}}},5775:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"450\"),r=i(\"3129\"),n=i(\"9992\"),h=i(\"91\");s=class extends l.default{constructor(e,t){let i=new n.default(`align-${t}`),s=e.map(e=>{var t;return(t=`align-${e}`,(0,r.h)(\"div\",`${h.cssPrefix}-item`).child(new n.default(t))).on(\"click\",()=>{this.setTitle(e),this.change(e)})});super(i,\"auto\",!0,\"bottom-left\",...s)}setTitle(e){this.title.setName(`align-${e}`),this.hide()}}},8554:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"450\"),r=i(\"9992\"),n=i(\"5270\");s=class extends l.default{constructor(){let e=new r.default(\"border-all\"),t=new n.default;t.change=e=>{this.change(e),this.hide()},super(e,\"auto\",!1,\"bottom-left\",t.el)}}},9074:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"450\"),r=i(\"9992\"),n=i(\"4741\");s=class extends l.default{constructor(e,t){let i=new(0,r.default)(e).css(\"height\",\"16px\").css(\"border-bottom\",`3px solid ${t}`),s=new n.default;s.change=e=>{this.setTitle(e),this.change(e)},super(i,\"auto\",!1,\"bottom-left\",s.el)}setTitle(e){this.title.css(\"border-color\",e),this.hide()}}},1589:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"450\"),r=i(\"3129\"),n=i(\"1933\"),h=i(\"91\");s=class extends l.default{constructor(){let e=n.baseFonts.map(e=>(0,r.h)(\"div\",`${h.cssPrefix}-item`).on(\"click\",()=>{this.setTitle(e.title),this.change(e)}).child(e.title));super(n.baseFonts[0].title,\"160px\",!0,\"bottom-left\",...e)}}},8667:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"450\"),r=i(\"3129\"),n=i(\"1933\"),h=i(\"91\");s=class extends l.default{constructor(){let e=n.fontSizes.map(e=>(0,r.h)(\"div\",`${h.cssPrefix}-item`).on(\"click\",()=>{this.setTitle(`${e.pt}`),this.change(e)}).child(`${e.pt}`));super(\"10\",\"60px\",!0,\"bottom-left\",...e)}}},653:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"450\"),r=i(\"3129\"),n=i(\"5854\"),h=i(\"91\");s=class extends l.default{constructor(){let e=n.baseFormats.slice(0);e.splice(2,0,{key:\"divider\"}),e.splice(8,0,{key:\"divider\"}),super(\"Normal\",\"220px\",!0,\"bottom-left\",...e=e.map(e=>{let t=(0,r.h)(\"div\",`${h.cssPrefix}-item`);return\"divider\"===e.key?t.addClass(\"divider\"):(t.child(e.title()).on(\"click\",()=>{this.setTitle(e.title()),this.change(e)}),e.label&&t.child((0,r.h)(\"div\",\"label\").html(e.label))),t}))}setTitle(e){for(let t=0;t<n.baseFormats.length;t+=1)n.baseFormats[t].key===e&&this.title.html((0,n.baseFormats)[t].title());this.hide()}}},2196:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"450\"),r=i(\"9992\"),n=i(\"3129\"),h=i(\"4913\"),a=i(\"91\");s=class extends l.default{constructor(){let e=h.baseFormulas.map(e=>(0,n.h)(\"div\",`${a.cssPrefix}-item`).on(\"click\",()=>{this.hide(),this.change(e)}).child(e.key));super(new r.default(\"formula\"),\"180px\",!0,\"bottom-left\",...e)}}},4735:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"450\"),r=i(\"3129\"),n=i(\"9992\"),h=i(\"91\");let a=[[\"thin\",'<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],[\"medium\",'<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"2\" style=\"user-select: none;\"><line x1=\"0\" y1=\"1.0\" x2=\"50\" y2=\"1.0\" stroke-width=\"2\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],[\"thick\",'<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"3\" style=\"user-select: none;\"><line x1=\"0\" y1=\"1.5\" x2=\"50\" y2=\"1.5\" stroke-width=\"3\" stroke=\"black\" style=\"user-select: none;\"></line></svg>'],[\"dashed\",'<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" stroke-dasharray=\"2\" style=\"user-select: none;\"></line></svg>'],[\"dotted\",'<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"1\" style=\"user-select: none;\"><line x1=\"0\" y1=\"0.5\" x2=\"50\" y2=\"0.5\" stroke-width=\"1\" stroke=\"black\" stroke-dasharray=\"1\" style=\"user-select: none;\"></line></svg>']];s=class extends l.default{constructor(e){let t=new n.default(\"line-type\"),i=0,s=a.map((t,l)=>(0,r.h)(\"div\",`${h.cssPrefix}-item state ${e===t[0]?\"checked\":\"\"}`).on(\"click\",()=>{s[i].toggle(\"checked\"),s[l].toggle(\"checked\"),i=l,this.hide(),this.change(t)}).child((0,r.h)(\"div\",`${h.cssPrefix}-line-type`).html(t[1])));super(t,\"auto\",!1,\"bottom-left\",...s)}}},8942:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"3129\"),r=i(\"4242\"),n=i(\"3850\"),h=i(\"91\");function a(){let{inputText:e}=this;if(!/^\\s*$/.test(e)){let{textlineEl:t,textEl:i,areaOffset:s}=this,l=e.split(\"\\n\"),r=Math.max(...l.map(e=>e.length)),n=t.offset(),h=n.width/e.length,a=(r+1)*h+5,o=this.viewFn().width-s.left-h,c=l.length;if(a>s.width){let e=a;a>o&&(e=o,c+=parseInt(a/o,10)+(a%o>0?1:0)),i.css(\"width\",`${e}px`)}(c*=this.rowHeight)>s.height&&i.css(\"height\",`${c}px`)}}function o({target:e},t){let{value:i,selectionEnd:s}=e,l=`${i.slice(0,s)}${t}${i.slice(s)}`;e.value=l,e.setSelectionRange(s+1,s+1),this.inputText=l,this.textlineEl.html(l),a.call(this)}function c(e){let{keyCode:t,altKey:i}=e;13!==t&&9!==t&&e.stopPropagation(),13===t&&i&&(o.call(this,e,\"\\n\"),e.stopPropagation()),13===t&&!i&&e.preventDefault()}function d(e){let t=e.target.value,{suggest:i,textlineEl:s,validator:l}=this,{cell:r}=this;if(null!==r){if(console.log(\"here0 \"+JSON.stringify(r)),\"editable\"in r&&!0===r.editable||void 0===r.editable){if(console.log(\"here\"),this.inputText=t,l)\"list\"===l.type?i.search(t):i.hide();else{let e=t.lastIndexOf(\"=\");-1!==e?i.search(t.substring(e+1)):i.hide()}s.html(t),a.call(this),this.change(\"input\",t)}else e.target.value=r.text||\"\"}else{if(this.inputText=t,l)\"list\"===l.type?i.search(t):i.hide();else{let e=t.lastIndexOf(\"=\");-1!==e?i.search(t.substring(e+1)):i.hide()}s.html(t),a.call(this),this.change(\"input\",t)}}function u(e){let{el:t}=this.textEl;setTimeout(()=>{t.focus(),t.setSelectionRange(e,e)},0)}function f(e,t){let{textEl:i,textlineEl:s}=this;i.el.blur(),i.val(e),s.html(e),u.call(this,t)}function g(e){let{inputText:t,validator:i}=this,s=0;if(i&&\"list\"===i.type)this.inputText=e,s=this.inputText.length;else{let i=t.lastIndexOf(\"=\"),l=t.substring(0,i+1),r=t.substring(i+1);r=-1!==r.indexOf(\")\")?r.substring(r.indexOf(\")\")):\"\",this.inputText=`${l+e.key}(`,s=this.inputText.length,this.inputText+=`)${r}`}f.call(this,this.inputText,s)}function p(){this.suggest.setItems(this.formulas)}s=class{constructor(e,t,i){this.viewFn=t,this.rowHeight=i,this.formulas=e,this.suggest=new r.default(e,e=>{g.call(this,e)}),this.datepicker=new n.default,this.datepicker.change(e=>{var t;let i,s;this.setText((i=(t=e).getMonth()+1,s=t.getDate(),i<10&&(i=`0${i}`),s<10&&(s=`0${s}`),`${t.getFullYear()}-${i}-${s}`)),this.clear()}),this.areaEl=(0,l.h)(\"div\",`${h.cssPrefix}-editor-area`).children(this.textEl=(0,l.h)(\"textarea\",\"\").on(\"input\",e=>d.call(this,e)).on(\"paste.stop\",()=>{}).on(\"keydown\",e=>c.call(this,e)),this.textlineEl=(0,l.h)(\"div\",\"textline\"),this.suggest.el,this.datepicker.el).on(\"mousemove.stop\",()=>{}).on(\"mousedown.stop\",()=>{}),this.el=(0,l.h)(\"div\",`${h.cssPrefix}-editor`).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText=\"\",this.change=()=>{}}setFreezeLengths(e,t){console.log(\"setFreezeLengths \"+JSON.stringify({width:e,height:t})),this.freeze.w=e,this.freeze.h=t}clear(){\"\"!==this.inputText&&this.change(\"finished\",this.inputText),this.cell=null,this.areaOffset=null,this.inputText=\"\",this.el.hide(),this.textEl.val(\"\"),this.textlineEl.html(\"\"),p.call(this),this.datepicker.hide()}setOffset(e,t=\"top\"){let{textEl:i,areaEl:s,suggest:l,freeze:r,el:n}=this;if(e){this.areaOffset=e;let{left:h,top:a,width:o,height:c,l:d,t:u}=e,f={left:0,top:0};r.w>d&&r.h>u||(r.w<d&&r.h<u?(f.left=r.w,f.top=r.h):r.w>d?f.top=r.h:r.h>u&&(f.left=r.w)),n.offset(f),s.offset({left:h-f.left-.8,top:a-f.top-.8}),i.offset({width:o-9+.8,height:c-3+.8});let g={left:0};g[t]=c,l.setOffset(g),l.hide()}}setCell(e,t){if(e&&!1===e.editable)return;let{el:i,datepicker:s,suggest:l}=this;i.show(),this.cell=e;let r=e&&e.text||\"\";if(this.setText(r),this.validator=t,t){let{type:e}=t;\"date\"===e&&(s.show(),!/^\\s*$/.test(r)&&s.setValue(r)),\"list\"===e&&(l.setItems(t.values()),l.search(\"\"))}}setText(e){this.inputText=e,f.call(this,e,e.length),a.call(this)}}},3129:function(e,t,i){\"use strict\";i.r(t),i.d(t,{Element:function(){return Element},h:function(){return s}});class Element{constructor(e,t=\"\"){\"string\"==typeof e?(this.el=document.createElement(e),this.el.className=t):this.el=e,this.data={}}data(e,t){return void 0!==t?(this.data[e]=t,this):this.data[e]}on(e,t){let[i,...s]=e.split(\".\"),l=i;return\"mousewheel\"===l&&/Firefox/i.test(window.navigator.userAgent)&&(l=\"DOMMouseScroll\"),this.el.addEventListener(l,e=>{t(e);for(let t=0;t<s.length;t+=1){let i=s[t];if(\"left\"===i&&0!==e.button||\"right\"===i&&2!==e.button)return;\"stop\"===i&&e.stopPropagation()}}),this}offset(e){if(void 0!==e)return Object.keys(e).forEach(t=>{this.css(t,`${e[t]}px`)}),this;let{offsetTop:t,offsetLeft:i,offsetHeight:s,offsetWidth:l}=this.el;return{top:t,left:i,height:s,width:l}}scroll(e){let{el:t}=this;return void 0!==e&&(void 0!==e.left&&(t.scrollLeft=e.left),void 0!==e.top&&(t.scrollTop=e.top)),{left:t.scrollLeft,top:t.scrollTop}}box(){return this.el.getBoundingClientRect()}parent(){return new Element(this.el.parentNode)}children(...e){return 0==arguments.length?this.el.childNodes:(e.forEach(e=>this.child(e)),this)}removeChild(e){this.el.removeChild(e)}child(e){let t=e;return\"string\"==typeof e?t=document.createTextNode(e):e instanceof Element&&(t=e.el),this.el.appendChild(t),this}contains(e){return this.el.contains(e)}className(e){return void 0!==e?(this.el.className=e,this):this.el.className}addClass(e){return this.el.classList.add(e),this}hasClass(e){return this.el.classList.contains(e)}removeClass(e){return this.el.classList.remove(e),this}toggle(e=\"active\"){return this.toggleClass(e)}toggleClass(e){return this.el.classList.toggle(e)}active(e=!0,t=\"active\"){return e?this.addClass(t):this.removeClass(t),this}checked(e=!0){return this.active(e,\"checked\"),this}disabled(e=!0){return e?this.addClass(\"disabled\"):this.removeClass(\"disabled\"),this}attr(e,t){if(void 0!==t)this.el.setAttribute(e,t);else{if(\"string\"==typeof e)return this.el.getAttribute(e);Object.keys(e).forEach(t=>{this.el.setAttribute(t,e[t])})}return this}removeAttr(e){return this.el.removeAttribute(e),this}html(e){return void 0!==e?(this.el.innerHTML=e,this):this.el.innerHTML}val(e){return void 0!==e?(this.el.value=e,this):this.el.value}focus(){this.el.focus()}cssRemoveKeys(...e){return e.forEach(e=>this.el.style.removeProperty(e)),this}css(e,t){return void 0===t&&\"string\"!=typeof e?(Object.keys(e).forEach(t=>{this.el.style[t]=e[t]}),this):void 0!==t?(this.el.style[e]=t,this):this.el.style[e]}computedStyle(){return window.getComputedStyle(this.el,null)}show(){return this.css(\"display\",\"block\"),this}hide(){return this.css(\"display\",\"none\"),this}}let s=(e,t=\"\")=>new Element(e,t)},1092:function(e,t,i){\"use strict\";function s(e,t,i){e.addEventListener(t,i)}function l(e,t,i){e.removeEventListener(t,i)}function r(e){e.xclickoutside&&(l(window.document.body,\"click\",e.xclickoutside),delete e.xclickoutside)}function n(e,t){e.xclickoutside=i=>{!(2===i.detail||e.contains(i.target))&&(t?t(e):(e.hide(),r(e)))},s(window.document.body,\"click\",e.xclickoutside)}function h(e,t,i){s(e,\"mousemove\",t);e.xEvtUp=s=>{l(e,\"mousemove\",t),l(e,\"mouseup\",e.xEvtUp),i(s)},s(e,\"mouseup\",e.xEvtUp)}function a(e,t,i,s){let l=\"\";Math.abs(e)>Math.abs(t)?s(l=e>0?\"right\":\"left\",e,i):s(l=t>0?\"down\":\"up\",t,i)}function o(e,{move:t,end:i}){let l=0,r=0;s(e,\"touchstart\",e=>{let{pageX:t,pageY:i}=e.touches[0];l=t,r=i}),s(e,\"touchmove\",e=>{if(!t)return;let{pageX:i,pageY:s}=e.changedTouches[0],n=i-l,h=s-r;(Math.abs(n)>10||Math.abs(h)>10)&&(a(n,h,e,t),l=i,r=s),e.preventDefault()}),s(e,\"touchend\",e=>{if(!i)return;let{pageX:t,pageY:s}=e.changedTouches[0],n=t-l,h=s-r;a(n,h,e,i)})}function c(){let e=new Map;function t(t,i){return e.has(t)&&(()=>{let s=e.get(t);return Array.isArray(s)&&s.push(i)||!1})()||e.set(t,[].concat(i))}function i(t,i){return e.has(t)&&(()=>{let s=e.get(t),l=s.indexOf(i);return l>=0&&s.splice(l,1)&&0===e.get(t).length&&e.delete(t)})()}return{get current(){return e},on:t,once:function(e,s){let l=(...t)=>{s.call(null,...t),i(e,l)};return t(e,l)},fire:function(t,i){return e.has(t)&&(()=>{let s=e.get(t);for(let e of s)e.call(null,...i)})()},removeListener:i,removeAllListeners:function(){e.clear()}}}i.r(t),i.d(t,{bind:function(){return s},unbind:function(){return l},unbindClickoutside:function(){return r},bindClickoutside:function(){return n},mouseMoveUp:function(){return h},bindTouch:function(){return o},createEventEmitter:function(){return c}})},3430:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"3129\"),r=i(\"91\"),n=i(\"2182\");let h={number:/(^\\d+$)|(^\\d+(\\.\\d{0,4})?$)/,date:/^\\d{4}-\\d{1,2}-\\d{1,2}$/};s=class{constructor(e,t,i,s){this.label=\"\",this.rule=t,i&&(this.label=(0,l.h)(\"label\",\"label\").css(\"width\",`${s}px`).html(i)),this.tip=(0,l.h)(\"div\",\"tip\").child(\"tip\").hide(),this.input=e,this.input.vchange=()=>this.validate(),this.el=(0,l.h)(\"div\",`${r.cssPrefix}-form-field`).children(this.label,e.el,this.tip)}isShow(){return\"none\"!==this.el.css(\"display\")}show(){this.el.show()}hide(){return this.el.hide(),this}val(e){return this.input.val(e)}hint(e){this.input.hint(e)}validate(){let{input:e,rule:t,tip:i,el:s}=this,l=e.val();if(t.required&&/^\\s*$/.test(l))return i.html((0,n.t)(\"validation.required\")),s.addClass(\"error\"),!1;if(t.type||t.pattern){let e=t.pattern||h[t.type];if(!e.test(l))return i.html((0,n.t)(\"validation.notMatch\")),s.addClass(\"error\"),!1}return s.removeClass(\"error\"),!0}}},6322:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"3129\"),r=i(\"91\");s=class{constructor(e,t){this.vchange=()=>{},this.el=(0,l.h)(\"div\",`${r.cssPrefix}-form-input`),this.input=(0,l.h)(\"input\",\"\").css(\"width\",e).on(\"input\",e=>this.vchange(e)).attr(\"placeholder\",t),this.el.child(this.input)}focus(){setTimeout(()=>{this.input.el.focus()},10)}hint(e){this.input.attr(\"placeholder\",e)}val(e){return this.input.val(e)}}},8286:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"3129\"),r=i(\"4242\"),n=i(\"91\");s=class{constructor(e,t,i,s=e=>e,h=()=>{}){this.key=e,this.getTitle=s,this.vchange=()=>{},this.el=(0,l.h)(\"div\",`${n.cssPrefix}-form-select`),this.suggest=new r.default(t.map(e=>({key:e,title:this.getTitle(e)})),e=>{this.itemClick(e.key),h(e.key),this.vchange(e.key)},i,this.el),this.el.children(this.itemEl=(0,l.h)(\"div\",\"input-text\").html(this.getTitle(e)),this.suggest.el).on(\"click\",()=>this.show())}show(){this.suggest.search(\"\")}itemClick(e){this.key=e,this.itemEl.html(this.getTitle(e))}val(e){return void 0!==e?(this.key=e,this.itemEl.html(this.getTitle(e)),this):this.key}}},9992:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"3129\"),r=i(\"91\");s=class extends l.Element{constructor(e){super(\"div\",`${r.cssPrefix}-icon`),this.iconNameEl=(0,l.h)(\"div\",`${r.cssPrefix}-icon-img ${e}`),this.child(this.iconNameEl)}setName(e){this.iconNameEl.className(`${r.cssPrefix}-icon-img ${e}`)}}},2402:function(e,t,i){\"use strict\";i.r(t),i.d(t,{xtoast:function(){return n}});var s=i(\"3129\"),l=i(\"9992\"),r=i(\"91\");function n(e,t){let i=(0,s.h)(\"div\",`${r.cssPrefix}-toast`),n=(0,s.h)(\"div\",`${r.cssPrefix}-dimmer active`),h=()=>{document.body.removeChild(i.el),document.body.removeChild(n.el)};i.children((0,s.h)(\"div\",`${r.cssPrefix}-toast-header`).children(new(0,l.default)(\"close\").on(\"click.stop\",()=>h()),e),(0,s.h)(\"div\",`${r.cssPrefix}-toast-content`).html(t)),document.body.appendChild(i.el),document.body.appendChild(n.el);let{width:a,height:o}=i.box(),{clientHeight:c,clientWidth:d}=document.documentElement;i.offset({left:(d-a)/2,top:(c-o)/3})}},9417:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"3129\"),r=i(\"9992\"),n=i(\"91\"),h=i(\"1092\");s=class{constructor(e,t,i=\"600px\"){this.title=e,this.el=(0,l.h)(\"div\",`${n.cssPrefix}-modal`).css(\"width\",i).children((0,l.h)(\"div\",`${n.cssPrefix}-modal-header`).children(new(0,r.default)(\"close\").on(\"click.stop\",()=>this.hide()),this.title),(0,l.h)(\"div\",`${n.cssPrefix}-modal-content`).children(...t)).hide()}show(){this.dimmer=(0,l.h)(\"div\",`${n.cssPrefix}-dimmer active`),document.body.appendChild(this.dimmer.el);let{width:e,height:t}=this.el.show().box(),{clientHeight:i,clientWidth:s}=document.documentElement;this.el.offset({left:(s-e)/2,top:(i-t)/3}),window.xkeydownEsc=e=>{27===e.keyCode&&this.hide()},(0,h.bind)(window,\"keydown\",window.xkeydownEsc)}hide(){this.el.hide(),document.body.removeChild(this.dimmer.el),(0,h.unbind)(window,\"keydown\",window.xkeydownEsc),delete window.xkeydownEsc}}},8532:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"9417\"),r=i(\"6322\"),n=i(\"8286\"),h=i(\"3430\"),a=i(\"5339\"),o=i(\"2182\"),c=i(\"3129\"),d=i(\"91\");s=class extends l.default{constructor(){let e=new h.default(new n.default(\"cell\",[\"cell\"],\"100%\",e=>(0,o.t)(`dataValidation.modeType.${e}`)),{required:!0},`${(0,o.t)(\"dataValidation.range\")}:`,100),t=new h.default(new r.default(\"120px\",\"E3 or E3:F12\"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\\d*)(:[A-Z]{1,2}[1-9]\\d*)?$/}),i=new h.default(new n.default(\"list\",[\"list\",\"number\",\"date\",\"phone\",\"email\"],\"100%\",e=>(0,o.t)(`dataValidation.type.${e}`),e=>this.criteriaSelected(e)),{required:!0},`${(0,o.t)(\"dataValidation.criteria\")}:`,100),s=new(0,h.default)(new(0,n.default)(\"be\",[\"be\",\"nbe\",\"eq\",\"neq\",\"lt\",\"lte\",\"gt\",\"gte\"],\"160px\",e=>(0,o.t)(`dataValidation.operator.${e}`),e=>this.criteriaOperatorSelected(e)),{required:!0}).hide(),l=new(0,h.default)(new(0,r.default)(\"70px\",\"10\"),{required:!0}).hide(),u=new(0,h.default)(new(0,r.default)(\"70px\",\"100\"),{required:!0,type:\"number\"}).hide(),f=new h.default(new r.default(\"120px\",\"a,b,c\"),{required:!0}),g=new(0,h.default)(new(0,r.default)(\"70px\",\"10\"),{required:!0,type:\"number\"}).hide();super((0,o.t)(\"contextmenu.validation\"),[(0,c.h)(\"div\",`${d.cssPrefix}-form-fields`).children(e.el,t.el),(0,c.h)(\"div\",`${d.cssPrefix}-form-fields`).children(i.el,s.el,l.el,u.el,g.el,f.el),(0,c.h)(\"div\",`${d.cssPrefix}-buttons`).children(new(0,a.default)(\"cancel\").on(\"click\",()=>this.btnClick(\"cancel\")),new(0,a.default)(\"remove\").on(\"click\",()=>this.btnClick(\"remove\")),new(0,a.default)(\"save\",\"primary\").on(\"click\",()=>this.btnClick(\"save\")))]),this.mf=e,this.rf=t,this.cf=i,this.of=s,this.minvf=l,this.maxvf=u,this.vf=g,this.svf=f,this.change=()=>{}}showVf(e){let{vf:t}=this;t.input.hint(\"date\"===e?\"2018-11-12\":\"10\"),t.show()}criteriaSelected(e){let{of:t,minvf:i,maxvf:s,vf:l,svf:r}=this;\"date\"===e||\"number\"===e?(t.show(),i.rule.type=e,s.rule.type=e,\"date\"===e?(i.hint(\"2018-11-12\"),s.hint(\"2019-11-12\")):(i.hint(\"10\"),s.hint(\"100\")),i.show(),s.show(),l.hide(),r.hide()):(\"list\"===e?r.show():r.hide(),l.hide(),t.hide(),i.hide(),s.hide())}criteriaOperatorSelected(e){if(!e)return;let{minvf:t,maxvf:i,vf:s}=this;if(\"be\"===e||\"nbe\"===e)t.show(),i.show(),s.hide();else{let e=this.cf.val();s.rule.type=e,\"date\"===e?s.hint(\"2018-11-12\"):s.hint(\"10\"),s.show(),t.hide(),i.hide()}}btnClick(e){if(\"cancel\"===e)this.hide();else if(\"remove\"===e)this.change(\"remove\"),this.hide();else if(\"save\"===e){let e=[\"mf\",\"rf\",\"cf\",\"of\",\"svf\",\"vf\",\"minvf\",\"maxvf\"];for(let t=0;t<e.length;t+=1){let i=this[e[t]];if(i.isShow()&&!i.validate())return}let t=this.mf.val(),i=this.rf.val(),s=this.cf.val(),l=this.of.val(),r=this.svf.val();(\"number\"===s||\"date\"===s)&&(r=\"be\"===l||\"nbe\"===l?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change(\"save\",t,i,{type:s,operator:l,required:!1,value:r}),this.hide()}}setValue(e){if(e){let{mf:t,rf:i,cf:s,of:l,svf:r,vf:n,minvf:h,maxvf:a}=this,{mode:o,ref:c,validator:d}=e,{type:u,operator:f,value:g}=d||{type:\"list\"};t.val(o||\"cell\"),i.val(c),s.val(u),l.val(f),Array.isArray(g)?(h.val(g[0]),a.val(g[1])):(r.val(g||\"\"),n.val(g||\"\")),this.criteriaSelected(u),this.criteriaOperatorSelected(f)}this.show()}}},6243:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"3129\"),r=i(\"91\"),n=i(\"5339\"),h=i(\"6293\"),a=i(\"9498\"),o=i(\"2182\");let c=[[\"A3\",11.69,16.54],[\"A4\",8.27,11.69],[\"A5\",5.83,8.27],[\"B4\",9.84,13.9],[\"B5\",6.93,9.84]],d=[\"landscape\",\"portrait\"];function u(e){return parseInt(96*e,10)}function f(e){\"cancel\"===e?this.el.hide():this.toPrint()}function g(e){let{paper:t}=this,{value:i}=e.target,s=c[i];t.w=u(s[1]),t.h=u(s[2]),this.preview()}function p(e){let{paper:t}=this,{value:i}=e.target,s=d[i];t.orientation=s,this.preview()}s=class{constructor(e){this.paper={w:u(c[0][1]),h:u(c[0][2]),padding:50,orientation:d[0],get width(){return\"landscape\"===this.orientation?this.h:this.w},get height(){return\"landscape\"===this.orientation?this.w:this.h}},this.data=e,this.el=(0,l.h)(\"div\",`${r.cssPrefix}-print`).children((0,l.h)(\"div\",`${r.cssPrefix}-print-bar`).children((0,l.h)(\"div\",\"-title\").child(\"Print settings\"),(0,l.h)(\"div\",\"-right\").children((0,l.h)(\"div\",`${r.cssPrefix}-buttons`).children(new(0,n.default)(\"cancel\").on(\"click\",f.bind(this,\"cancel\")),new(0,n.default)(\"next\",\"primary\").on(\"click\",f.bind(this,\"next\"))))),(0,l.h)(\"div\",`${r.cssPrefix}-print-content`).children(this.contentEl=(0,l.h)(\"div\",\"-content\"),(0,l.h)(\"div\",\"-sider\").child((0,l.h)(\"form\",\"\").children((0,l.h)(\"fieldset\",\"\").children((0,l.h)(\"label\",\"\").child(`${(0,o.t)(\"print.size\")}`),(0,l.h)(\"select\",\"\").children(...c.map((e,t)=>(0,l.h)(\"option\",\"\").attr(\"value\",t).child(`${e[0]} ( ${e[1]}''x${e[2]}'' )`))).on(\"change\",g.bind(this))),(0,l.h)(\"fieldset\",\"\").children((0,l.h)(\"label\",\"\").child(`${(0,o.t)(\"print.orientation\")}`),(0,l.h)(\"select\",\"\").children(...d.map((e,t)=>(0,l.h)(\"option\",\"\").attr(\"value\",t).child(`${(0,o.t)(\"print.orientations\")[t]}`))).on(\"change\",p.bind(this))))))).hide()}resetData(e){this.data=e}preview(){let{data:e,paper:t}=this,{width:i,height:s,padding:n}=t,o=i-2*n,c=s-2*n,d=e.contentRange(),u=parseInt(d.h/c,10)+1,f=o/d.w,g=n;f>1&&(g+=(o-d.w)/2);let p=0,m=0;this.contentEl.html(\"\"),this.canvases=[];let w={sri:0,sci:0,eri:0,eci:0};for(let t=0;t<u;t+=1){let t=0,o=0,u=(0,l.h)(\"div\",`${r.cssPrefix}-canvas-card`),v=(0,l.h)(\"canvas\",`${r.cssPrefix}-canvas`);this.canvases.push(v.el);let b=new h.Draw(v.el,i,s);for(b.save(),b.translate(g,n),f<1&&b.scale(f,f);p<=d.eri;p+=1){let i=e.rows.getHeight(p);if((t+=i)<c)for(let t=0;t<=d.eci;t+=1)(0,a.renderCell)(b,e,p,t,m),w.eci=t;else{o=-(t-i);break}}w.eri=p,b.restore(),b.save(),b.translate(g,n),f<1&&b.scale(f,f);let x=m;e.eachMergesInView(w,({sri:t,sci:i})=>{(0,a.renderCell)(b,e,t,i,x)}),b.restore(),w.sri=w.eri,w.sci=w.eci,m+=o,this.contentEl.child((0,l.h)(\"div\",`${r.cssPrefix}-canvas-card-wraper`).child(u.child(v)))}this.el.show()}toPrint(){this.el.hide();let{paper:e}=this,t=(0,l.h)(\"iframe\",\"\").hide(),{el:i}=t;window.document.body.appendChild(i);let{contentWindow:s}=i,r=s.document,n=document.createElement(\"style\");n.innerHTML=`\n      @page { size: ${e.width}px ${e.height}px; };\n      canvas {\n        page-break-before: auto;        \n        page-break-after: always;\n        image-rendering: pixelated;\n      };\n    `,r.head.appendChild(n),this.canvases.forEach(e=>{let t=e.cloneNode(!1),i=t.getContext(\"2d\");i.drawImage(e,0,0),r.body.appendChild(t)}),s.print()}}},4817:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"3129\"),r=i(\"1092\"),n=i(\"91\");s=class{constructor(e=!1,t){this.moving=!1,this.vertical=e,this.el=(0,l.h)(\"div\",`${n.cssPrefix}-resizer ${e?\"vertical\":\"horizontal\"}`).children(this.unhideHoverEl=(0,l.h)(\"div\",`${n.cssPrefix}-resizer-hover`).on(\"dblclick.stop\",e=>this.mousedblclickHandler(e)).css(\"position\",\"absolute\").hide(),this.hoverEl=(0,l.h)(\"div\",`${n.cssPrefix}-resizer-hover`).on(\"mousedown.stop\",e=>this.mousedownHandler(e)),this.lineEl=(0,l.h)(\"div\",`${n.cssPrefix}-resizer-line`).hide()).hide(),this.cRect=null,this.finishedFn=null,this.minDistance=t,this.unhideFn=()=>{}}showUnhide(e){this.unhideIndex=e,this.unhideHoverEl.show()}hideUnhide(){this.unhideHoverEl.hide()}show(e,t){let{moving:i,vertical:s,hoverEl:l,lineEl:r,el:n,unhideHoverEl:h}=this;if(i)return;this.cRect=e;let{left:a,top:o,width:c,height:d}=e;n.offset({left:s?a+c-5:a,top:s?o:o+d-5}).show(),l.offset({width:s?5:c,height:s?d:5}),r.offset({width:s?0:t.width,height:s?t.height:0}),h.offset({left:s?5-c:a,top:s?o:5-d,width:s?5:c,height:s?d:5})}hide(){this.el.offset({left:0,top:0}).hide(),this.hideUnhide()}mousedblclickHandler(){this.unhideIndex&&this.unhideFn(this.unhideIndex)}mousedownHandler(e){let t=e,{el:i,lineEl:s,cRect:l,vertical:n,minDistance:h}=this,a=n?l.width:l.height;s.show(),(0,r.mouseMoveUp)(window,e=>{this.moving=!0,null!==t&&1===e.buttons&&(n?(a+=e.movementX)>h&&i.css(\"left\",`${l.left+a}px`):(a+=e.movementY)>h&&i.css(\"top\",`${l.top+a}px`),t=e)},()=>{t=null,s.hide(),this.moving=!1,this.hide(),this.finishedFn&&(a<h&&(a=h),this.finishedFn(l,a))})}}},3498:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"3129\"),r=i(\"91\");s=class{constructor(e){this.vertical=e,this.moveFn=null,this.el=(0,l.h)(\"div\",`${r.cssPrefix}-scrollbar ${e?\"vertical\":\"horizontal\"}`).child(this.contentEl=(0,l.h)(\"div\",\"\")).on(\"mousemove.stop\",()=>{}).on(\"scroll.stop\",e=>{let{scrollTop:t,scrollLeft:i}=e.target;this.moveFn&&this.moveFn(this.vertical?t:i,e)})}move(e){return this.el.scroll(e),this}scroll(){return this.el.scroll()}set(e,t){let i=e-1;if(t>i){let e=this.vertical?\"height\":\"width\";this.el.css(e,`${i-15}px`).show(),this.contentEl.css(this.vertical?\"width\":\"height\",\"1px\").css(e,`${t}px`)}else this.el.hide();return this}}},3782:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"3129\"),r=i(\"91\"),n=i(\"791\");let h=10;class a{constructor(e=!1,t=!0){this.useHideInput=e,this.autoFocus=t,this.inputChange=()=>{},this.cornerEl=(0,l.h)(\"div\",`${r.cssPrefix}-selector-corner`),this.areaEl=(0,l.h)(\"div\",`${r.cssPrefix}-selector-area`).child(this.cornerEl).hide(),this.clipboardEl=(0,l.h)(\"div\",`${r.cssPrefix}-selector-clipboard`).hide(),this.autofillEl=(0,l.h)(\"div\",`${r.cssPrefix}-selector-autofill`).hide(),this.el=(0,l.h)(\"div\",`${r.cssPrefix}-selector`).css(\"z-index\",`${h}`).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),e&&(this.hideInput=(0,l.h)(\"input\",\"\").on(\"compositionend\",e=>{this.inputChange(e.target.value)}),this.el.child(this.hideInputDiv=(0,l.h)(\"div\",\"hide-input\").child(this.hideInput)),this.el.child(this.hideInputDiv=(0,l.h)(\"div\",\"hide-input\").child(this.hideInput))),h+=1}setOffset(e){return this.el.offset(e).show(),this}hide(){return this.el.hide(),this}setAreaOffset(e){let{left:t,top:i,width:s,height:l}=e,r={width:s-3+.8,height:l-3+.8,left:t-.8,top:i-.8};this.areaEl.offset(r).show(),this.useHideInput&&(this.hideInputDiv.offset(r),this.autoFocus?this.hideInput.val(\"\").focus():this.hideInput.val(\"\"))}setClipboardOffset(e){let{left:t,top:i,width:s,height:l}=e;this.clipboardEl.offset({left:t,top:i,width:s-5,height:l-5})}showAutofill(e){let{left:t,top:i,width:s,height:l}=e;this.autofillEl.offset({width:s-3,height:l-3,left:t,top:i}).show()}hideAutofill(){this.autofillEl.hide()}showClipboard(){this.clipboardEl.show()}hideClipboard(){this.clipboardEl.hide()}}function o(e){let{data:t}=this,{left:i,top:s,width:l,height:r,scroll:n,l:h,t:a}=e,o=t.freezeTotalWidth(),c=t.freezeTotalHeight(),d=i-o;o>h&&(d-=n.x);let u=s-c;return c>a&&(u-=n.y),{left:d,top:u,width:l,height:r}}function c(e){let{data:t}=this,{left:i,width:s,height:l,l:r,t:n,scroll:h}=e,a=t.freezeTotalWidth(),o=i-a;return a>r&&(o-=h.x),{left:o,top:n,width:s,height:l}}function d(e){let{data:t}=this,{top:i,width:s,height:l,l:r,t:n,scroll:h}=e,a=t.freezeTotalHeight(),o=i-a;return a>n&&(o-=h.y),{left:r,top:o,width:s,height:l}}function u(e){let{br:t}=this;t.setAreaOffset(o.call(this,e))}function f(e){let{tl:t}=this;t.setAreaOffset(e)}function g(e){let{t}=this;t.setAreaOffset(c.call(this,e))}function p(e){let{l:t}=this;t.setAreaOffset(d.call(this,e))}function m(e){let{l:t}=this;t.setClipboardOffset(d.call(this,e))}function w(e){let{br:t}=this;t.setClipboardOffset(o.call(this,e))}function v(e){let{tl:t}=this;t.setClipboardOffset(e)}function b(e){let{t}=this;t.setClipboardOffset(c.call(this,e))}function x(e){u.call(this,e),f.call(this,e),g.call(this,e),p.call(this,e)}function y(e){w.call(this,e),v.call(this,e),b.call(this,e),m.call(this,e)}s=class{constructor(e){let{autoFocus:t}=e.settings;this.inputChange=()=>{},this.data=e,this.br=new a(!0,t),this.t=new a,this.l=new a,this.tl=new a,this.br.inputChange=e=>{this.inputChange(e)},this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=(0,l.h)(\"div\",`${r.cssPrefix}-selectors`).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,h+=1}resetData(e){this.data=e,this.range=e.selector.range,this.resetAreaOffset()}hide(){this.el.hide()}resetOffset(){let{data:e,tl:t,t:i,l:s,br:l}=this,r=e.freezeTotalHeight(),n=e.freezeTotalWidth();r>0||n>0?(t.setOffset({width:n,height:r}),i.setOffset({left:n,height:r}),s.setOffset({top:r,width:n}),l.setOffset({left:n,top:r})):(t.hide(),i.hide(),s.hide(),l.setOffset({left:0,top:0}))}resetAreaOffset(){let e=this.data.getSelectedRect(),t=this.data.getClipboardRect();x.call(this,e),y.call(this,t),this.resetOffset()}resetBRTAreaOffset(){let e=this.data.getSelectedRect(),t=this.data.getClipboardRect();u.call(this,e),g.call(this,e),w.call(this,t),b.call(this,t),this.resetOffset()}resetBRLAreaOffset(){let e=this.data.getSelectedRect(),t=this.data.getClipboardRect();u.call(this,e),p.call(this,e),w.call(this,t),m.call(this,t),this.resetOffset()}set(e,t,i=!0){let{data:s}=this,l=s.calSelectedRangeByStart(e,t),{sri:r,sci:n}=l;if(i){let[i,l]=[e,t];e<0&&(i=0),t<0&&(l=0),s.selector.setIndexes(i,l),this.indexes=[i,l]}this.moveIndexes=[r,n],this.range=l,this.resetAreaOffset(),this.el.show()}setEnd(e,t,i=!0){let{data:s,lastri:l,lastci:r}=this;if(i){if(e===l&&t===r)return;this.lastri=e,this.lastci=t}this.range=s.calSelectedRangeByEnd(e,t),x.call(this,this.data.getSelectedRect())}reset(){let{eri:e,eci:t}=this.data.selector.range;this.setEnd(e,t)}showAutofill(e,t){if(-1===e&&-1===t)return;let{sri:i,sci:s,eri:l,eci:r}=this.range,[h,a]=[e,t],u=i-e,f=s-t,g=l-e,p=r-t;if(f>0)this.arange=new n.CellRange(i,a,l,s-1);else if(u>0)this.arange=new n.CellRange(h,s,i-1,r);else if(p<0)this.arange=new n.CellRange(i,r+1,l,a);else if(g<0)this.arange=new n.CellRange(l+1,s,h,r);else{this.arange=null;return}if(null!==this.arange){let e=this.data.getRect(this.arange);e.width+=2,e.height+=2;let{br:t,l:i,t:s,tl:l}=this;t.showAutofill(o.call(this,e)),i.showAutofill(d.call(this,e)),s.showAutofill(c.call(this,e)),l.showAutofill(e)}}hideAutofill(){[\"br\",\"l\",\"t\",\"tl\"].forEach(e=>{this[e].hideAutofill()})}showClipboard(){let e=this.data.getClipboardRect();y.call(this,e),[\"br\",\"l\",\"t\",\"tl\"].forEach(e=>{this[e].showClipboard()})}hideClipboard(){[\"br\",\"l\",\"t\",\"tl\"].forEach(e=>{this[e].hideClipboard()})}}},2367:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"3129\"),r=i(\"1092\"),n=i(\"4817\"),h=i(\"3498\"),a=i(\"3782\"),o=i(\"8942\"),c=i(\"6243\"),d=i(\"3015\"),u=i(\"9498\"),f=i(\"8846\"),g=i(\"8532\"),p=i(\"8288\"),m=i(\"2402\"),w=i(\"91\"),v=i(\"4913\");function b(e,t){let i;return(...s)=>{let l=this;!i&&(i=setTimeout(()=>{i=null,e.apply(l,s)},t))}}function x(){let{data:e,verticalScrollbar:t,horizontalScrollbar:i}=this,{l:s,t:l,left:r,top:n,width:h,height:a}=e.getSelectedRect(),o=this.getTableOffset();if(Math.abs(r)+h>o.width)i.move({left:s+h-o.width});else{let t=e.freezeTotalWidth();r<t&&i.move({left:s-1-t})}if(Math.abs(n)+a>o.height)t.move({top:l+a-o.height-1});else{let i=e.freezeTotalHeight();n<i&&t.move({top:l-1-i})}}function y(e,t,i,s=!0,l=!1){if(-1===t&&-1===i)return;let{table:r,selector:n,toolbar:h,data:a,contextMenu:o}=this,c=a.getCell(t,i);e?(n.setEnd(t,i,l),this.trigger(\"cells-selected\",c,n.range)):(n.set(t,i,s),this.trigger(\"cell-selected\",c,t,i)),o.setMode(-1===t||-1===i?\"row-col\":\"range\"),h.reset(),r.render()}function k(e,t){let{selector:i,data:s}=this,{rows:l,cols:r}=s,[n,h]=i.indexes,{eri:a,eci:o}=i.range;e&&([n,h]=i.moveIndexes),\"left\"===t?h>0&&(h-=1):\"right\"===t?(o!==h&&(h=o),h<r.len-1&&(h+=1)):\"up\"===t?n>0&&(n-=1):\"down\"===t?(a!==n&&(n=a),n<l.len-1&&(n+=1)):\"row-first\"===t?h=0:\"row-last\"===t?h=r.len-1:\"col-first\"===t?n=0:\"col-last\"===t&&(n=l.len-1),e&&(i.moveIndexes=[n,h]),y.call(this,e,n,h),x.call(this)}function C(e){if(0!==e.buttons||e.target.className===`${w.cssPrefix}-resizer-hover`)return;let{offsetX:t,offsetY:i}=e,{rowResizer:s,colResizer:l,tableEl:r,data:n}=this,{rows:h,cols:a}=n;if(t>a.indexWidth&&i>h.height){s.hide(),l.hide();return}let o=r.box(),c=n.getCellRectByXY(e.offsetX,e.offsetY);c.ri>=0&&-1===c.ci?(c.width=a.indexWidth,s.show(c,{width:o.width}),h.isHide(c.ri-1)?s.showUnhide(c.ri):s.hideUnhide()):s.hide(),-1===c.ri&&c.ci>=0?(c.height=h.height,l.show(c,{height:o.height}),a.isHide(c.ci-1)?l.showUnhide(c.ci):l.hideUnhide()):l.hide()}function E(e){let{verticalScrollbar:t,horizontalScrollbar:i,data:s}=this,{top:l}=t.scroll(),{left:r}=i.scroll(),{rows:n,cols:h}=s,{deltaY:a,deltaX:o}=e,c=(e,t)=>{let i=e,s=0;do s=t(i),i+=1;while(s<=0);return s},d=e=>{if(e>0){let e=s.scroll.ri+1;if(e<n.len){let i=c(e,e=>n.getHeight(e));t.move({top:l+i-1})}}else{let e=s.scroll.ri-1;if(e>=0){let i=c(e,e=>n.getHeight(e));t.move({top:0===e?0:l-i})}}},u=Math.abs(a),f=Math.abs(o),g=Math.max(u,f);/Firefox/i.test(window.navigator.userAgent)&&b(d(e.detail),50),g===f&&b((e=>{if(e>0){let e=s.scroll.ci+1;if(e<h.len){let t=c(e,e=>h.getWidth(e));i.move({left:r+t-1})}}else{let e=s.scroll.ci-1;if(e>=0){let t=c(e,e=>h.getWidth(e));i.move({left:0===e?0:r-t})}}})(o),50),g===u&&b(d(a),50)}function $(e,t){let{verticalScrollbar:i,horizontalScrollbar:s}=this,{top:l}=i.scroll(),{left:r}=s.scroll();\"left\"===e||\"right\"===e?s.move({left:r-t}):(\"up\"===e||\"down\"===e)&&i.move({top:l-t})}function S(){let{data:e,verticalScrollbar:t}=this,{height:i}=this.getTableOffset(),s=e.exceptRowTotalHeight(0,-1);t.set(i,e.rows.totalHeight()-s)}function _(){let{data:e,horizontalScrollbar:t}=this,{width:i}=this.getTableOffset();e&&t.set(i,e.cols.totalWidth())}function D(){let{selector:e,data:t,editor:i}=this,[s,l]=t.freeze;if(s>0||l>0){console.log(\"sheet:sheetFreeze()\"+JSON.stringify({ri:s,ci:l}));let e=t.freezeTotalWidth(),r=t.freezeTotalHeight();i.setFreezeLengths(e,r)}e.resetAreaOffset()}function P(){let{tableEl:e,overlayerEl:t,overlayerCEl:i,table:s,toolbar:l,selector:r,el:n}=this,h=this.getTableOffset(),a=this.getRect();e.attr(a),t.offset(a),i.offset(h),n.css(\"width\",`${a.width}px`),S.call(this),_.call(this),D.call(this),s.render(),l.reset(),r.reset()}function T(){let{data:e,selector:t}=this;e.clearClipboard(),t.hideClipboard()}function O(e){let{data:t,selector:i}=this;\"read\"!==t.settings.mode&&(t.copy(),t.copyToSystemClipboard(e),i.showClipboard())}function R(){let{data:e,selector:t}=this;\"read\"!==e.settings.mode&&(e.cut(),t.showClipboard())}function A(e,t){let{data:i}=this;if(\"read\"!==i.settings.mode){if(i.clipboard.isClear())i.pasteFromSystemClipboard(()=>P.call(this),e=>{this.trigger(\"pasted-clipboard\",e)});else if(i.paste(e,e=>(0,m.xtoast)(\"Tip\",e)))P.call(this);else if(t){let e=t.clipboardData.getData(\"text/plain\");this.data.pasteFromText(e),P.call(this)}}}function z(){this.data.hideRowsOrCols(),P.call(this)}function I(e,t){this.data.unhideRowsOrCols(e,t),P.call(this)}function F(){let{data:e}=this;e.autofilter(),P.call(this)}function H(){let{toolbar:e}=this;e.paintformatActive()&&(A.call(this,\"format\"),T.call(this),e.paintformatToggle())}function N(e){let{selector:t,data:i,table:s,sortFilter:l}=this,{offsetX:n,offsetY:h}=e,a=e.target.className===`${w.cssPrefix}-selector-corner`,o=i.getCellRectByXY(n,h),{left:c,top:d,width:u,height:f}=o,{ri:g,ci:p}=o,{autoFilter:v}=i;if(v.includes(g,p)&&c+u-20<n&&d+f-20<h){let e=v.items(p,(e,t)=>i.rows.getCell(e,t));l.hide(),l.set(p,e,v.getFilter(p),v.getSort(p)),l.setOffset({left:c,top:d+f+2});return}!e.shiftKey&&(a?t.showAutofill(g,p):y.call(this,!1,g,p),(0,r.mouseMoveUp)(window,e=>{({ri:g,ci:p}=i.getCellRectByXY(e.offsetX,e.offsetY)),a?t.showAutofill(g,p):1===e.buttons&&!e.shiftKey&&y.call(this,!0,g,p,!0,!0)},()=>{a&&t.arange&&\"read\"!==i.settings.mode&&i.autofill(t.arange,\"all\",e=>(0,m.xtoast)(\"Tip\",e))&&s.render(),t.hideAutofill(),H.call(this)})),!a&&1===e.buttons&&e.shiftKey&&y.call(this,!0,g,p)}function M(){let{editor:e,data:t}=this,i=t.getSelectedRect(),s=this.getTableOffset(),l=\"top\";i.top>s.height/2&&(l=\"bottom\"),e.setOffset(i,l)}function W(){let{editor:e,data:t}=this;\"read\"!==t.settings.mode&&(M.call(this),e.setCell(t.getSelectedCell(),t.getSelectedValidator()),T.call(this))}function V(e){let{data:t,table:i,selector:s}=this;t.scrolly(e,()=>{s.resetBRLAreaOffset(),M.call(this),i.render()})}function q(e){let{data:t,table:i,selector:s}=this;t.scrollx(e,()=>{s.resetBRTAreaOffset(),M.call(this),i.render()})}function B(e,t){let{ri:i}=e,{table:s,selector:l,data:r}=this,{sri:n,eri:h}=l.range;if(i>=n&&i<=h)for(let e=n;e<=h;e+=1)r.rows.setHeight(e,t);else r.rows.setHeight(i,t);s.render(),l.resetAreaOffset(),S.call(this),M.call(this)}function j(e,t){let{ci:i}=e,{table:s,selector:l,data:r}=this,{sci:n,eci:h}=l.range;if(i>=n&&i<=h)for(let e=n;e<=h;e+=1)r.cols.setWidth(e,t);else r.cols.setWidth(i,t);s.render(),l.resetAreaOffset(),_.call(this),M.call(this)}function L(e,t=\"finished\"){let{data:i,table:s}=this;if(\"read\"===i.settings.mode)return;i.setSelectedCellText(e,t);let{ri:l,ci:r}=i.selector;\"finished\"===t?s.render():this.trigger(\"cell-edited\",e,l,r)}function U(e){let{data:t}=this;\"read\"!==t.settings.mode&&(\"insert-row\"===e?t.insert(\"row\"):\"delete-row\"===e?t.delete(\"row\"):\"insert-column\"===e?t.insert(\"column\"):\"delete-column\"===e?t.delete(\"column\"):\"delete-cell\"===e?t.deleteCell():\"delete-cell-format\"===e?t.deleteCell(\"format\"):\"delete-cell-text\"===e?t.deleteCell(\"text\"):\"cell-printable\"===e?t.setSelectedCellAttr(\"printable\",!0):\"cell-non-printable\"===e?t.setSelectedCellAttr(\"printable\",!1):\"cell-editable\"===e?t.setSelectedCellAttr(\"editable\",!0):\"cell-non-editable\"===e&&t.setSelectedCellAttr(\"editable\",!1),T.call(this),P.call(this))}function J(e,t){let{data:i}=this;if(\"undo\"===e)this.undo();else if(\"redo\"===e)this.redo();else if(\"print\"===e)this.print.preview();else if(\"paintformat\"===e)!0===t?O.call(this):T.call(this);else if(\"clearformat\"===e)U.call(this,\"delete-cell-format\");else if(\"link\"===e);else if(\"chart\"===e);else if(\"autofilter\"===e)F.call(this);else if(\"freeze\"===e){if(t){let{ri:e,ci:t}=i.selector;this.freeze(e,t)}else this.freeze(0,0)}else i.setSelectedCellAttr(e,t),\"formula\"===e&&!i.selector.multiple()&&W.call(this),P.call(this)}function Y(e,t,i,s){this.data.setAutoFilter(e,t,i,s),P.call(this)}function Z(){let{selector:e,overlayerEl:t,rowResizer:i,colResizer:s,verticalScrollbar:l,horizontalScrollbar:n,editor:h,contextMenu:a,toolbar:o,modalValidation:c,sortFilter:d}=this;t.on(\"mousemove\",e=>{C.call(this,e)}).on(\"mousedown\",e=>{h.clear(),a.hide(),2===e.buttons?(this.data.xyInSelectedRect(e.offsetX,e.offsetY)||N.call(this,e),a.setPosition(e.offsetX,e.offsetY),e.stopPropagation()):2===e.detail?W.call(this):N.call(this,e)}).on(\"mousewheel.stop\",e=>{E.call(this,e)}).on(\"mouseout\",e=>{let{offsetX:t,offsetY:l}=e;l<=0&&s.hide(),t<=0&&i.hide()}),e.inputChange=e=>{L.call(this,e,\"input\"),W.call(this)},(0,r.bindTouch)(t.el,{move:(e,t)=>{$.call(this,e,t)}}),o.change=(e,t)=>J.call(this,e,t),d.ok=(e,t,i,s)=>Y.call(this,e,t,i,s),i.finishedFn=(e,t)=>{B.call(this,e,t)},s.finishedFn=(e,t)=>{j.call(this,e,t)},i.unhideFn=e=>{I.call(this,\"row\",e)},s.unhideFn=e=>{I.call(this,\"col\",e)},l.moveFn=(e,t)=>{V.call(this,e,t)},n.moveFn=(e,t)=>{q.call(this,e,t)},h.change=(e,t)=>{L.call(this,t,e)},c.change=(e,...t)=>{\"save\"===e?this.data.addValidation(...t):this.data.removeValidation()},a.itemClick=e=>{\"validation\"===e?c.setValue(this.data.getSelectedValidation()):\"copy\"===e?O.call(this):\"cut\"===e?R.call(this):\"paste\"===e?A.call(this,\"all\"):\"paste-value\"===e?A.call(this,\"text\"):\"paste-format\"===e?A.call(this,\"format\"):\"hide\"===e?z.call(this):U.call(this,e)},(0,r.bind)(window,\"resize\",()=>{this.reload()}),(0,r.bind)(window,\"click\",e=>{this.focusing=t.contains(e.target)}),(0,r.bind)(window,\"paste\",e=>{this.focusing&&(A.call(this,\"all\",e),e.preventDefault())}),(0,r.bind)(window,\"copy\",e=>{this.focusing&&(O.call(this,e),e.preventDefault())}),(0,r.bind)(window,\"keydown\",e=>{if(!this.focusing)return;let t=e.keyCode||e.which,{key:i,ctrlKey:s,shiftKey:l,metaKey:r}=e;if(s||r)switch(t){case 90:this.undo(),e.preventDefault();break;case 89:this.redo(),e.preventDefault();break;case 67:case 86:break;case 88:R.call(this),e.preventDefault();break;case 85:o.trigger(\"underline\"),e.preventDefault();break;case 37:k.call(this,l,\"row-first\"),e.preventDefault();break;case 38:k.call(this,l,\"col-first\"),e.preventDefault();break;case 39:k.call(this,l,\"row-last\"),e.preventDefault();break;case 40:k.call(this,l,\"col-last\"),e.preventDefault();break;case 32:y.call(this,!1,-1,this.data.selector.ci,!1),e.preventDefault();break;case 66:o.trigger(\"bold\");break;case 73:o.trigger(\"italic\")}else{switch(t){case 32:l&&y.call(this,!1,this.data.selector.ri,-1,!1);break;case 27:a.hide(),T.call(this);break;case 37:k.call(this,l,\"left\"),e.preventDefault();break;case 38:k.call(this,l,\"up\"),e.preventDefault();break;case 39:k.call(this,l,\"right\"),e.preventDefault();break;case 40:k.call(this,l,\"down\"),e.preventDefault();break;case 9:h.clear(),k.call(this,!1,l?\"left\":\"right\"),e.preventDefault();break;case 13:h.clear(),k.call(this,!1,l?\"up\":\"down\"),e.preventDefault();break;case 8:U.call(this,\"delete-cell-text\"),e.preventDefault()}\"Delete\"===i?(U.call(this,\"delete-cell-text\"),e.preventDefault()):t>=65&&t<=90||t>=48&&t<=57||t>=96&&t<=105||\"=\"===e.key?(L.call(this,e.key,\"input\"),W.call(this)):113===t&&W.call(this)}})}s=class{constructor(e,t){this.eventMap=(0,r.createEventEmitter)();let{view:i,showToolbar:s,showContextmenu:m}=t.settings;this.el=(0,l.h)(\"div\",`${w.cssPrefix}-sheet`),this.toolbar=new f.default(t,i.width,!s),this.print=new c.default(t),e.children(this.toolbar.el,this.el,this.print.el),this.data=t,this.tableEl=(0,l.h)(\"canvas\",`${w.cssPrefix}-table`),this.rowResizer=new n.default(!1,t.rows.height),this.colResizer=new n.default(!0,t.cols.minWidth),this.verticalScrollbar=new h.default(!0),this.horizontalScrollbar=new h.default(!1),this.editor=new o.default(v.formulas,()=>this.getTableOffset(),t.rows.height),this.modalValidation=new g.default,this.contextMenu=new d.default(()=>this.getRect(),!m),this.selector=new a.default(t),this.overlayerCEl=(0,l.h)(\"div\",`${w.cssPrefix}-overlayer-content`).children(this.editor.el,this.selector.el),this.overlayerEl=(0,l.h)(\"div\",`${w.cssPrefix}-overlayer`).child(this.overlayerCEl),this.sortFilter=new p.default,this.el.children(this.tableEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.modalValidation.el,this.sortFilter.el),this.table=new u.default(this.tableEl.el,t),Z.call(this),P.call(this),y.call(this,!1,0,0)}on(e,t){return this.eventMap.on(e,t),this}trigger(e,...t){let{eventMap:i}=this;i.fire(e,t)}resetData(e){this.editor.clear(),this.data=e,S.call(this),_.call(this),this.toolbar.resetData(e),this.print.resetData(e),this.selector.resetData(e),this.table.resetData(e)}loadData(e){return this.data.setData(e),P.call(this),this}freeze(e,t){let{data:i}=this;return i.setFreeze(e,t),P.call(this),this}undo(){this.data.undo(),P.call(this)}redo(){this.data.redo(),P.call(this)}reload(){return P.call(this),this}getRect(){let{data:e}=this;return{width:e.viewWidth(),height:e.viewHeight()}}getTableOffset(){let{rows:e,cols:t}=this.data,{width:i,height:s}=this.getRect();return{width:i-t.indexWidth,height:s-e.height,left:t.indexWidth,top:e.height}}}},8288:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"3129\"),r=i(\"5339\"),n=i(\"1092\"),h=i(\"91\"),a=i(\"2182\");function o(e){return(0,l.h)(\"div\",`${h.cssPrefix}-item ${e}`)}function c(e){return o(\"state\").child((0,a.t)(`sort.${e}`)).on(\"click.stop\",()=>this.itemClick(e))}function d(e){let{filterbEl:t,filterValues:i}=this;t.html(\"\");let s=Object.keys(e);s.forEach((s,r)=>{let n=e[s],o=i.includes(s)?\"checked\":\"\";t.child((0,l.h)(\"div\",`${h.cssPrefix}-item state ${o}`).on(\"click.stop\",()=>this.filterClick(r,s)).children(\"\"===s?(0,a.t)(\"filter.empty\"):s,(0,l.h)(\"div\",\"label\").html(`(${n})`)))})}function u(){let{filterhEl:e,filterValues:t,values:i}=this;e.html(`${t.length} / ${i.length}`),e.checked(t.length===i.length)}s=class{constructor(){this.filterbEl=(0,l.h)(\"div\",`${h.cssPrefix}-body`),this.filterhEl=(0,l.h)(\"div\",`${h.cssPrefix}-header state`).on(\"click.stop\",()=>this.filterClick(0,\"all\")),this.el=(0,l.h)(\"div\",`${h.cssPrefix}-sort-filter`).children(this.sortAscEl=c.call(this,\"asc\"),this.sortDescEl=c.call(this,\"desc\"),o(\"divider\"),(0,l.h)(\"div\",`${h.cssPrefix}-filter`).children(this.filterhEl,this.filterbEl),(0,l.h)(\"div\",`${h.cssPrefix}-buttons`).children(new(0,r.default)(\"cancel\").on(\"click\",()=>this.btnClick(\"cancel\")),new(0,r.default)(\"ok\",\"primary\").on(\"click\",()=>this.btnClick(\"ok\")))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]}btnClick(e){if(\"ok\"===e){let{ci:e,sort:t,filterValues:i}=this;this.ok&&this.ok(e,t,\"in\",i)}this.hide()}itemClick(e){this.sort=e;let{sortAscEl:t,sortDescEl:i}=this;t.checked(\"asc\"===e),i.checked(\"desc\"===e)}filterClick(e,t){let{filterbEl:i,filterValues:s,values:r}=this,n=i.children();if(\"all\"===t)n.length===s.length?(this.filterValues=[],n.forEach(e=>(0,l.h)(e).checked(!1))):(this.filterValues=Array.from(r),n.forEach(e=>(0,l.h)(e).checked(!0)));else{let i=(0,l.h)(n[e]).toggle(\"checked\");i?s.push(t):s.splice(s.findIndex(e=>e===t),1)}u.call(this)}set(e,t,i,s){this.ci=e;let{sortAscEl:l,sortDescEl:r}=this;null!==s?(this.sort=s.order,l.checked(s.asc()),r.checked(s.desc())):(this.sortDesc=null,l.checked(!1),r.checked(!1)),this.values=Object.keys(t),this.filterValues=i?Array.from(i.value):Object.keys(t),d.call(this,t,i),u.call(this)}setOffset(e){this.el.offset(e).show();let t=1;(0,n.bindClickoutside)(this.el,()=>{t<=0&&this.hide(),t-=1})}show(){this.el.show()}hide(){this.el.hide(),(0,n.unbindClickoutside)(this.el)}}},4242:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"3129\"),r=i(\"1092\"),n=i(\"91\");function h(e){e.preventDefault(),e.stopPropagation();let{filterItems:t}=this;!(t.length<=0)&&(this.itemIndex>=0&&t[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=t.length-1),t[this.itemIndex].toggle())}function a(e){e.stopPropagation();let{filterItems:t}=this;!(t.length<=0)&&(this.itemIndex>=0&&t[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>t.length-1&&(this.itemIndex=0),t[this.itemIndex].toggle())}function o(e){e.preventDefault();let{filterItems:t}=this;!(t.length<=0)&&(e.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),t[this.itemIndex].el.click(),this.hide())}function c(e){let{keyCode:t}=e;switch(e.ctrlKey&&e.stopPropagation(),t){case 37:case 39:e.stopPropagation();break;case 38:h.call(this,e);break;case 40:a.call(this,e);break;case 13:case 9:o.call(this,e);break;default:e.stopPropagation()}}s=class{constructor(e,t,i=\"200px\"){this.filterItems=[],this.items=e,this.el=(0,l.h)(\"div\",`${n.cssPrefix}-suggest`).css(\"width\",i).hide(),this.itemClick=t,this.itemIndex=-1}setOffset(e){this.el.cssRemoveKeys(\"top\",\"bottom\").offset(e)}hide(){let{el:e}=this;this.filterItems=[],this.itemIndex=-1,e.hide(),(0,r.unbindClickoutside)(this.el.parent())}setItems(e){this.items=e}search(e){let{items:t}=this;if(!/^\\s*$/.test(e)&&(t=t.filter(t=>(t.key||t).startsWith(e.toUpperCase()))),t=t.map(e=>{let{title:t}=e;t?\"function\"==typeof t&&(t=t()):t=e;let i=(0,l.h)(\"div\",`${n.cssPrefix}-item`).child(t).on(\"click.stop\",()=>{this.itemClick(e),this.hide()});return e.label&&i.child((0,l.h)(\"div\",\"label\").html(e.label)),i}),this.filterItems=t,t.length<=0)return;let{el:i}=this;i.html(\"\").children(...t).show(),(0,r.bindClickoutside)(i.parent(),()=>{this.hide()})}bindInputEvents(e){e.on(\"keydown\",e=>c.call(this,e))}}},9498:function(e,t,i){\"use strict\";i.r(t),i.d(t,{renderCell:function(){return u},default:function(){return x}});var s=i(\"2014\"),l=i(\"1933\"),r=i(\"8259\"),n=i(\"4913\"),h=i(\"5854\"),a=i(\"6293\");let o={fillStyle:\"#f4f5f8\"},c={fillStyle:\"#fff\",lineWidth:a.thinLineWidth,strokeStyle:\"#e6e6e6\"};function d(e,t,i,s=0){let{left:l,top:r,width:n,height:h}=e.cellRect(t,i);return new a.DrawBox(l,r+s,n,h,5)}function u(e,t,i,s,a=0){let{sortedRowMap:o,rows:c,cols:u}=t;if(c.isHide(i)||u.isHide(s))return;let f=i;o.has(i)&&(f=o.get(i));let g=t.getCell(f,s);if(null===g)return;let p=!1;\"editable\"in g&&!1===g.editable&&(p=!0);let m=t.getCellStyleOrDefault(f,s),w=d(t,i,s,a);w.bgcolor=m.bgcolor,void 0!==m.border&&(w.setBorders(m.border),e.strokeBorders(w)),e.rect(w,()=>{let a=\"\";a=t.settings.evalPaused?g.text||\"\":r.default.render(g.text||\"\",n.formulam,(e,i)=>t.getCellTextOrDefault(i,e)),m.format&&(a=(0,h.formatm)[m.format].render(a));let o=Object.assign({},m.font);o.size=(0,l.getFontSizePxByPt)(o.size),e.text(a,w,{align:m.align,valign:m.valign,font:o,color:m.color,strike:m.strike,underline:m.underline},m.textwrap);let c=t.validations.getError(i,s);c&&e.error(w),p&&e.frozen(w)})}function f(e){let{data:t,draw:i}=this;if(e){let{autoFilter:s}=t;if(!s.active())return;let l=s.hrange();e.intersects(l)&&l.each((e,s)=>{let l=d(t,e,s);i.dropdown(l)})}}function g(e,t,i,s,l){let{draw:r,data:n}=this;r.save(),r.translate(t,i).translate(s,l);let{exceptRowSet:h}=n,a=e=>{let t=h.has(e);if(t){let t=n.rows.getHeight(e);r.translate(0,-t)}return!t},o=n.exceptRowTotalHeight(e.sri,e.eri);r.save(),r.translate(0,-o),e.each((e,t)=>{u(r,n,e,t)},e=>a(e)),r.restore();let c=new Set;r.save(),r.translate(0,-o),n.eachMergesInView(e,({sri:e,sci:t,eri:i})=>{if(h.has(e)){if(!c.has(e)){c.add(e);let t=n.rows.sumHeight(e,i+1);r.translate(0,-t)}}else u(r,n,e,t)}),r.restore(),f.call(this,e),r.restore()}function p(e,t,i,s){let{draw:l}=this;l.save(),l.attr({fillStyle:\"rgba(75, 137, 255, 0.08)\"}).fillRect(e,t,i,s),l.restore()}function m(e,t,i,l,r,n){let{draw:h,data:c}=this,d=t.h,u=t.w,f=n+l,g=r+i;h.save(),h.attr(o),(\"all\"===e||\"left\"===e)&&h.fillRect(0,f,i,d),(\"all\"===e||\"top\"===e)&&h.fillRect(g,0,u,l);let{sri:m,sci:w,eri:v,eci:b}=c.selector.range;h.attr({textAlign:\"center\",textBaseline:\"middle\",font:`500 ${(0,a.npx)(12)}px Source Sans Pro`,fillStyle:\"#585757\",lineWidth:(0,a.thinLineWidth)(),strokeStyle:\"#e6e6e6\"}),(\"all\"===e||\"left\"===e)&&(c.rowEach(t.sri,t.eri,(e,t,s)=>{let l=f+t;h.line([0,l],[i,l]),m<=e&&e<v+1&&p.call(this,0,l,i,s),h.fillText(e+1,i/2,l+s/2),e>0&&c.rows.isHide(e-1)&&(h.save(),h.attr({strokeStyle:\"#c6c6c6\"}),h.line([5,l+5],[i-5,l+5]),h.restore())}),h.line([0,d+f],[i,d+f]),h.line([i,f],[i,d+f])),(\"all\"===e||\"top\"===e)&&(c.colEach(t.sci,t.eci,(e,t,i)=>{let r=g+t;h.line([r,0],[r,l]),w<=e&&e<b+1&&p.call(this,r,0,i,l),h.fillText((0,s.stringAt)(e),r+i/2,l/2),e>0&&c.cols.isHide(e-1)&&(h.save(),h.attr({strokeStyle:\"#c6c6c6\"}),h.line([r+5,5],[r+5,l-5]),h.restore())}),h.line([u+g,0],[u+g,l]),h.line([0,l],[u+g,l])),h.restore()}function w(e,t){let{draw:i}=this;i.save(),i.attr({fillStyle:\"#f4f5f8\"}).fillRect(0,0,e,t),i.restore()}function v({sri:e,sci:t,eri:i,eci:s,w:l,h:r},n,h,a,o){let{draw:d,data:u}=this,{settings:f}=u;if(d.save(),d.attr(c).translate(n+a,h+o),!f.showGrid){d.restore();return}u.rowEach(e,i,(t,s,r)=>{t!==e&&d.line([0,s],[l,s]),t===i&&d.line([0,s+r],[l,s+r])}),u.colEach(t,s,(e,i,l)=>{e!==t&&d.line([i,0],[i,r]),e===s&&d.line([i+l,0],[i+l,r])}),d.restore()}function b(e,t,i,s){let{draw:l,data:r}=this,n=r.viewWidth()-e,h=r.viewHeight()-t;l.save().translate(e,t).attr({strokeStyle:\"rgba(75, 137, 255, .6)\"}),l.line([0,s],[n,s]),l.line([i,0],[i,h]),l.restore()}var x=class e{constructor(e,t){this.el=e,this.draw=new a.Draw(e,t.viewWidth(),t.viewHeight()),this.data=t}resetData(e){this.data=e,this.render()}render(){let{data:e}=this,{rows:t,cols:i}=e,s=i.indexWidth,l=t.height;this.draw.resize(e.viewWidth(),e.viewHeight()),this.clear();let r=e.viewRange(),n=e.freezeTotalWidth(),h=e.freezeTotalHeight(),{x:a,y:o}=e.scroll;v.call(this,r,s,l,n,h),g.call(this,r,s,l,-a,-o),m.call(this,\"all\",r,s,l,n,h),w.call(this,s,l);let[c,d]=e.freeze;if(c>0||d>0){if(c>0){let e=r.clone();e.sri=0,e.eri=c-1,e.h=h,v.call(this,e,s,l,n,0),g.call(this,e,s,l,-a,0),m.call(this,\"top\",e,s,l,n,0)}if(d>0){let e=r.clone();e.sci=0,e.eci=d-1,e.w=n,v.call(this,e,s,l,0,h),m.call(this,\"left\",e,s,l,0,h),g.call(this,e,s,l,0,-o)}let t=e.freezeViewRange();v.call(this,t,s,l,0,0),m.call(this,\"all\",t,s,l,0,0),g.call(this,t,s,l,0,0),b.call(this,s,l,n,h)}}clear(){this.draw.clear()}}},5617:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"8927\"),r=i(\"5775\");s=class extends l.default{constructor(e){super(\"align\",\"\",e)}dropdown(){let{value:e}=this;return new r.default([\"left\",\"center\",\"right\"],e)}}},9893:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"1006\");s=class extends l.default{constructor(){super(\"autofilter\")}setState(){}}},2700:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"1006\");s=class extends l.default{constructor(){super(\"font-bold\",\"Ctrl+B\")}}},4713:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"8927\"),r=i(\"8554\");s=class extends l.default{constructor(){super(\"border\")}dropdown(){return new r.default}}},716:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"8209\");s=class extends l.default{constructor(){super(\"clearformat\")}}},8927:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"4965\");s=class extends l.default{dropdown(){}getValue(e){return e}element(){let{tag:e}=this;return this.dd=this.dropdown(),this.dd.change=t=>this.change(e,this.getValue(t)),super.element().child(this.dd)}setState(e){e&&(this.value=e,this.dd.setTitle(e))}}},7738:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"8927\"),r=i(\"9074\");s=class extends l.default{constructor(e){super(\"bgcolor\",void 0,e)}dropdown(){let{tag:e,value:t}=this;return new r.default(e,t)}}},8234:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"8927\"),r=i(\"1589\");s=class extends l.default{constructor(){super(\"font-name\")}getValue(e){return e.key}dropdown(){return new r.default}}},8397:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"8927\"),r=i(\"8667\");s=class extends l.default{constructor(){super(\"font-size\")}getValue(e){return e.pt}dropdown(){return new r.default}}},4362:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"8927\"),r=i(\"653\");s=class extends l.default{constructor(){super(\"format\")}getValue(e){return e.key}dropdown(){return new r.default}}},9859:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"8927\"),r=i(\"2196\");s=class extends l.default{constructor(){super(\"formula\")}getValue(e){return e.key}dropdown(){return new r.default}}},3538:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"1006\");s=class extends l.default{constructor(){super(\"freeze\")}}},8209:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"4965\"),r=i(\"9992\");s=class extends l.default{element(){return super.element().child(new r.default(this.tag)).on(\"click\",()=>this.change(this.tag))}setState(e){this.el.disabled(e)}}},8846:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"5617\"),r=i(\"3585\"),n=i(\"9893\"),h=i(\"2700\"),a=i(\"4617\"),o=i(\"6633\"),c=i(\"416\"),d=i(\"4713\"),u=i(\"716\"),f=i(\"6979\"),g=i(\"7569\"),p=i(\"7738\"),m=i(\"8397\"),w=i(\"8234\"),v=i(\"4362\"),b=i(\"9859\"),x=i(\"3538\"),y=i(\"2413\"),k=i(\"544\"),C=i(\"2498\"),E=i(\"786\"),$=i(\"1251\"),S=i(\"2505\"),_=i(\"4965\"),D=i(\"3129\"),P=i(\"91\"),T=i(\"1092\");function O(){return(0,D.h)(\"div\",`${P.cssPrefix}-toolbar-divider`)}function R(){this.btns2=[],this.items.forEach(e=>{if(Array.isArray(e))e.forEach(({el:e})=>{let t=e.box(),{marginLeft:i,marginRight:s}=e.computedStyle();this.btns2.push([e,t.width+parseInt(i,10)+parseInt(s,10)])});else{let t=e.box(),{marginLeft:i,marginRight:s}=e.computedStyle();this.btns2.push([e,t.width+parseInt(i,10)+parseInt(s,10)])}})}function A(){let{el:e,btns:t,moreEl:i,btns2:s}=this,{moreBtns:l,contentEl:r}=i.dd;e.css(\"width\",`${this.widthFn()}px`);let n=e.box(),h=160,a=12,o=[],c=[];s.forEach(([e,t],i)=>{h+=t,i===s.length-1||h<n.width?o.push(e):(a+=t,c.push(e))}),t.html(\"\").children(...o),l.html(\"\").children(...c),r.css(\"width\",`${a}px`),c.length>0?i.show():i.hide()}function z(e){let t=new _.default;t.el.on(\"click\",()=>{e.onClick&&e.onClick(this.data.getData(),this.data)}),t.tip=e.tip||\"\";let{el:i}=e;if(e.icon&&(i=(0,D.h)(\"img\").attr(\"src\",e.icon)),i){let e=(0,D.h)(\"div\",`${P.cssPrefix}-icon`);e.child(i),t.el.child(e)}return t}s=class{constructor(e,t,i=!1){this.data=e,this.change=()=>{},this.widthFn=t,this.isHide=i;let s=e.defaultStyle();this.items=[[this.undoEl=new C.default,this.redoEl=new k.default,new E.default,this.paintformatEl=new f.default,this.clearformatEl=new u.default],O(),[this.formatEl=new v.default],O(),[this.fontEl=new w.default,this.fontSizeEl=new m.default],O(),[this.boldEl=new h.default,this.italicEl=new a.default,this.underlineEl=new c.default,this.strikeEl=new o.default,this.textColorEl=new g.default(s.color)],O(),[this.fillColorEl=new p.default(s.bgcolor),this.borderEl=new d.default,this.mergeEl=new y.default],O(),[this.alignEl=new l.default(s.align),this.valignEl=new r.default(s.valign),this.textwrapEl=new $.default],O(),[this.freezeEl=new x.default,this.autofilterEl=new n.default,this.formulaEl=new b.default]];let{extendToolbar:_={}}=e.settings;if(_.left&&_.left.length>0){this.items.unshift(O());let e=_.left.map(z.bind(this));this.items.unshift(e)}if(_.right&&_.right.length>0){this.items.push(O());let e=_.right.map(z.bind(this));this.items.push(e)}this.items.push([this.moreEl=new S.default]),this.el=(0,D.h)(\"div\",`${P.cssPrefix}-toolbar`),this.btns=(0,D.h)(\"div\",`${P.cssPrefix}-toolbar-btns`),this.items.forEach(e=>{Array.isArray(e)?e.forEach(e=>{this.btns.child(e.el),e.change=(...e)=>{this.change(...e)}}):this.btns.child(e.el)}),this.el.child(this.btns),i?this.el.hide():(this.reset(),setTimeout(()=>{R.call(this),A.call(this)},0),(0,T.bind)(window,\"resize\",()=>{A.call(this)}))}paintformatActive(){return this.paintformatEl.active()}paintformatToggle(){this.paintformatEl.toggle()}trigger(e){this[`${e}El`].click()}resetData(e){this.data=e,this.reset()}reset(){if(this.isHide)return;let{data:e}=this,t=e.getSelectedCellStyle();this.undoEl.setState(!e.canUndo()),this.redoEl.setState(!e.canRedo()),this.mergeEl.setState(e.canUnmerge(),!e.selector.multiple()),this.autofilterEl.setState(!e.canAutofilter());let{font:i,format:s}=t;this.formatEl.setState(s),this.fontEl.setState(i.name),this.fontSizeEl.setState(i.size),this.boldEl.setState(i.bold),this.italicEl.setState(i.italic),this.underlineEl.setState(t.underline),this.strikeEl.setState(t.strike),this.textColorEl.setState(t.color),this.fillColorEl.setState(t.bgcolor),this.alignEl.setState(t.align),this.valignEl.setState(t.valign),this.textwrapEl.setState(t.textwrap),this.freezeEl.setState(e.freezeIsActive())}}},4617:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"1006\");s=class extends l.default{constructor(){super(\"font-italic\",\"Ctrl+I\")}}},4965:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"91\"),r=i(\"5417\"),n=i(\"3129\"),h=i(\"2182\");s=class{constructor(e,t,i){this.tip=\"\",e&&(this.tip=(0,h.t)(`toolbar.${e.replace(/-[a-z]/g,e=>e[1].toUpperCase())}`)),t&&(this.tip+=` (${t})`),this.tag=e,this.shortcut=t,this.value=i,this.el=this.element(),this.change=()=>{}}element(){let{tip:e}=this;return(0,n.h)(\"div\",`${l.cssPrefix}-toolbar-btn`).on(\"mouseenter\",e=>{this.tip&&(0,r.default)(this.tip,e.target)}).attr(\"data-tooltip\",e)}setState(){}}},2413:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"1006\");s=class extends l.default{constructor(){super(\"merge\")}setState(e,t){this.el.active(e).disabled(t)}}},2505:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"450\"),r=i(\"8927\"),n=i(\"91\"),h=i(\"3129\"),a=i(\"9992\");class o extends l.default{constructor(){let e=new a.default(\"ellipsis\"),t=(0,h.h)(\"div\",`${n.cssPrefix}-toolbar-more`);super(e,\"auto\",!1,\"bottom-right\",t),this.moreBtns=t,this.contentEl.css(\"max-width\",\"420px\")}}s=class extends r.default{constructor(){super(\"more\"),this.el.hide()}dropdown(){return new o}show(){this.el.show()}hide(){this.el.hide()}}},6979:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"1006\");s=class extends l.default{constructor(){super(\"paintformat\")}setState(){}}},786:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"8209\");s=class extends l.default{constructor(){super(\"print\",\"Ctrl+P\")}}},544:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"8209\");s=class extends l.default{constructor(){super(\"redo\",\"Ctrl+Y\")}}},6633:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"1006\");s=class extends l.default{constructor(){super(\"strike\",\"Ctrl+U\")}}},7569:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"8927\"),r=i(\"9074\");s=class extends l.default{constructor(e){super(\"color\",void 0,e)}dropdown(){let{tag:e,value:t}=this;return new r.default(e,t)}}},1251:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"1006\");s=class extends l.default{constructor(){super(\"textwrap\")}}},1006:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"4965\"),r=i(\"9992\");s=class extends l.default{element(){let{tag:e}=this;return super.element().child(new r.default(e)).on(\"click\",()=>this.click())}click(){this.change(this.tag,this.toggle())}setState(e){this.el.active(e)}toggle(){return this.el.toggle()}active(){return this.el.hasClass(\"active\")}}},416:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"1006\");s=class extends l.default{constructor(){super(\"underline\",\"Ctrl+U\")}}},2498:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"8209\");s=class extends l.default{constructor(){super(\"undo\",\"Ctrl+Z\")}}},3585:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"8927\"),r=i(\"5775\");s=class extends l.default{constructor(e){super(\"valign\",\"\",e)}dropdown(){let{value:e}=this;return new r.default([\"top\",\"middle\",\"bottom\"],e)}}},5417:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return n}});var s=i(\"3129\"),l=i(\"1092\"),r=i(\"91\");function n(e,t){if(t.classList.contains(\"active\"))return;let{left:i,top:n,width:h,height:a}=t.getBoundingClientRect(),o=(0,s.h)(\"div\",`${r.cssPrefix}-tooltip`).html(e).show();document.body.appendChild(o.el);let c=o.box();o.css(\"left\",`${i+h/2-c.width/2}px`).css(\"top\",`${n+a+2}px`),(0,l.bind)(t,\"mouseleave\",()=>{document.body.contains(o.el)&&document.body.removeChild(o.el)}),(0,l.bind)(t,\"click\",()=>{document.body.contains(o.el)&&document.body.removeChild(o.el)})}},91:function(e,t,i){\"use strict\";i.r(t),i.d(t,{cssPrefix:function(){return s}});let s=\"x-spreadsheet\";window.devicePixelRatio},2014:function(e,t,i){\"use strict\";i.r(t),i.d(t,{stringAt:function(){return l},expr2xy:function(){return r},xy2expr:function(){return n},expr2expr:function(){return h}});let s=[\"A\",\"B\",\"C\",\"D\",\"E\",\"F\",\"G\",\"H\",\"I\",\"J\",\"K\",\"L\",\"M\",\"N\",\"O\",\"P\",\"Q\",\"R\",\"S\",\"T\",\"U\",\"V\",\"W\",\"X\",\"Y\",\"Z\"];function l(e){let t=\"\",i=e;for(;i>=s.length;)i/=s.length,i-=1,t+=s[parseInt(i,10)%s.length];let l=e%s.length;return t+=s[l]}function r(e){let t=\"\",i=\"\";for(let s=0;s<e.length;s+=1)e.charAt(s)>=\"0\"&&\"9\">=e.charAt(s)?i+=e.charAt(s):t+=e.charAt(s);return[function(e){let t=0;for(let i=0;i!==e.length;++i)t=26*t+e.charCodeAt(i)-64;return t-1}(t),parseInt(i,10)-1]}function n(e,t){return`${l(e)}${t+1}`}function h(e,t,i,s=()=>!0){if(0===t&&0===i)return e;let[l,h]=r(e);return s(l,h)?n(l+t,h+i):e}},1914:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"791\");class r{constructor(e,t,i){this.ci=e,this.operator=t,this.value=i}set(e,t){this.operator=e,this.value=t}includes(e){let{operator:t,value:i}=this;return\"all\"===t||\"in\"===t&&i.includes(e)}vlength(){let{operator:e,value:t}=this;return\"in\"===e?t.length:0}getData(){let{ci:e,operator:t,value:i}=this;return{ci:e,operator:t,value:i}}}class n{constructor(e,t){this.ci=e,this.order=t}asc(){return\"asc\"===this.order}desc(){return\"desc\"===this.order}}s=class{constructor(){this.ref=null,this.filters=[],this.sort=null}setData({ref:e,filters:t,sort:i}){null!=e&&(this.ref=e,this.filters=t.map(e=>new r(e.ci,e.operator,e.value)),i&&(this.sort=new n(i.ci,i.order)))}getData(){if(this.active()){let{ref:e,filters:t,sort:i}=this;return{ref:e,filters:t.map(e=>e.getData()),sort:i}}return{}}addFilter(e,t,i){let s=this.getFilter(e);null==s?this.filters.push(new r(e,t,i)):s.set(t,i)}setSort(e,t){this.sort=t?new n(e,t):null}includes(e,t){return!!this.active()&&this.hrange().includes(e,t)}getSort(e){let{sort:t}=this;return t&&t.ci===e?t:null}getFilter(e){let{filters:t}=this;for(let i=0;i<t.length;i+=1)if(t[i].ci===e)return t[i];return null}filteredRows(e){let t=new Set,i=new Set;if(this.active()){let{sri:s,eri:l}=this.range(),{filters:r}=this;for(let n=s+1;n<=l;n+=1)for(let s=0;s<r.length;s+=1){let l=r[s],h=e(n,l.ci),a=h?h.text:\"\";if(l.includes(a))i.add(n);else{t.add(n);break}}}return{rset:t,fset:i}}items(e,t){let i={};if(this.active()){let{sri:s,eri:l}=this.range();for(let r=s+1;r<=l;r+=1){let s=t(r,e);if(null===s||/^\\s*$/.test(s.text))i[\"\"]=(i[\"\"]||0)+1;else{let e=s.text,t=(i[e]||0)+1;i[e]=t}}}return i}range(){return l.CellRange.valueOf(this.ref)}hrange(){let e=this.range();return e.eri=e.sri,e}clear(){this.ref=null,this.filters=[],this.sort=null}active(){return null!==this.ref}}},8259:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return o}});var s=i(\"2014\"),l=i(\"8666\");let r=e=>{let t=[],i=[],l=[],r=0,n=\"\",h=1,a=\"\";for(let o=0;o<e.length;o+=1){let c=e.charAt(o);if(\" \"!==c){if(c>=\"a\"&&c<=\"z\")l.push(c.toUpperCase());else if(c>=\"0\"&&c<=\"9\"||c>=\"A\"&&c<=\"Z\"||\".\"===c)l.push(c);else if('\"'===c){for(o+=1;'\"'!==e.charAt(o);)l.push(e.charAt(o)),o+=1;i.push(`\"${l.join(\"\")}`),l=[]}else if(\"-\"===c&&/[+\\-*/,(]/.test(a))l.push(c);else{if(\"(\"!==c&&l.length>0&&i.push(l.join(\"\")),\")\"===c){let e=t.pop();if(2===r)try{let[t,l]=(0,s.expr2xy)(i.pop()),[r,n]=(0,s.expr2xy)(i.pop()),h=0;for(let e=r;e<=t;e+=1)for(let t=n;t<=l;t+=1)i.push((0,s.xy2expr)(e,t)),h+=1;i.push([e,h])}catch(e){}else if(1===r||3===r)3===r&&i.push(n),i.push([e,h]),h=1;else for(;\"(\"!==e&&(i.push(e),!(t.length<=0));){;e=t.pop()}r=0}else if(\"=\"===c||\">\"===c||\"<\"===c){let t=e.charAt(o+1);n=c,(\"=\"===t||\"-\"===t)&&(n+=t,o+=1),r=3}else if(\":\"===c)r=2;else if(\",\"===c)3===r&&i.push(n),r=1,h+=1;else if(\"(\"===c&&l.length>0)t.push(l.join(\"\"));else{if(t.length>0&&(\"+\"===c||\"-\"===c)){let e=t[t.length-1];if(\"(\"!==e&&i.push(t.pop()),\"*\"===e||\"/\"===e)for(;t.length>0;)if(\"(\"!==(e=t[t.length-1]))i.push(t.pop());else break}else if(t.length>0){let e=t[t.length-1];(\"*\"===e||\"/\"===e)&&i.push(t.pop())}t.push(c)}l=[]}a=c}}for(l.length>0&&i.push(l.join(\"\"));t.length>0;)i.push(t.pop());return i},n=(e,t)=>{let[i]=e,l=e;if('\"'===i)return e.substring(1);let r=1;if(\"-\"===i&&(l=e.substring(1),r=-1),l[0]>=\"0\"&&l[0]<=\"9\")return r*Number(l);let[n,h]=(0,s.expr2xy)(l);return r*t(n,h)},h=(e,t,i,s)=>{let r=[];for(let h=0;h<e.length;h+=1){let a=e[h],o=a[0];if(\"+\"===a){let e=r.pop();r.push((0,l.numberCalc)(\"+\",r.pop(),e))}else if(\"-\"===a){if(1===r.length){let e=r.pop();r.push((0,l.numberCalc)(\"*\",e,-1))}else{let e=r.pop();r.push((0,l.numberCalc)(\"-\",r.pop(),e))}}else if(\"*\"===a)r.push((0,l.numberCalc)(\"*\",r.pop(),r.pop()));else if(\"/\"===a){let e=r.pop();r.push((0,l.numberCalc)(\"/\",r.pop(),e))}else if(\"=\"===o||\">\"===o||\"<\"===o){let e=r.pop();!Number.isNaN(e)&&(e=Number(e));let t=r.pop();!Number.isNaN(t)&&(t=Number(t));let i=!1;\"=\"===o?i=t===e:\">\"===a?i=t>e:\">=\"===a?i=t>=e:\"<\"===a?i=t<e:\"<=\"===a&&(i=t<=e),r.push(i)}else if(Array.isArray(a)){let[e,i]=a,s=[];for(let e=0;e<i;e+=1)s.push(r.pop());r.push(t[e].render(s.reverse()))}else{if(s.includes(a))return 0;(o>=\"a\"&&o<=\"z\"||o>=\"A\"&&o<=\"Z\")&&s.push(a),r.push(n(a,i)),s.pop()}}return r[0]},a=(e,t,i,s=[])=>{if(\"=\"===e[0]){let l=r(e.substring(1));return l.length<=0?e:h(l,t,(e,l)=>a(i(e,l),t,i,s),s)}return e};var o={render:a}},791:function(e,t,i){\"use strict\";i.r(t),i.d(t,{CellRange:function(){return l}});var s=i(\"2014\");class l{constructor(e,t,i,s,l=0,r=0){this.sri=e,this.sci=t,this.eri=i,this.eci=s,this.w=l,this.h=r}set(e,t,i,s){this.sri=e,this.sci=t,this.eri=i,this.eci=s}multiple(){return this.eri-this.sri>0||this.eci-this.sci>0}includes(...e){let[t,i]=[0,0];1===e.length?[i,t]=(0,s.expr2xy)(e[0]):2===e.length&&([t,i]=e);let{sri:l,sci:r,eri:n,eci:h}=this;return l<=t&&t<=n&&r<=i&&i<=h}each(e,t=()=>!0){let{sri:i,sci:s,eri:l,eci:r}=this;for(let n=i;n<=l;n+=1)if(t(n))for(let t=s;t<=r;t+=1)e(n,t)}contains(e){return this.sri<=e.sri&&this.sci<=e.sci&&this.eri>=e.eri&&this.eci>=e.eci}within(e){return this.sri>=e.sri&&this.sci>=e.sci&&this.eri<=e.eri&&this.eci<=e.eci}disjoint(e){return this.sri>e.eri||this.sci>e.eci||e.sri>this.eri||e.sci>this.eci}intersects(e){return this.sri<=e.eri&&this.sci<=e.eci&&e.sri<=this.eri&&e.sci<=this.eci}union(e){let{sri:t,sci:i,eri:s,eci:r}=this;return new l(e.sri<t?e.sri:t,e.sci<i?e.sci:i,e.eri>s?e.eri:s,e.eci>r?e.eci:r)}difference(e){let t=[],i=(e,i,s,r)=>{t.push(new l(e,i,s,r))},{sri:s,sci:r,eri:n,eci:h}=this,a=e.sri-s,o=e.sci-r,c=n-e.eri,d=h-e.eci;return a>0?(i(s,r,e.sri-1,h),c>0?(i(e.eri+1,r,n,h),o>0&&i(e.sri,r,e.eri,e.sci-1),d>0&&i(e.sri,e.eci+1,e.eri,h)):(o>0&&i(e.sri,r,n,e.sci-1),d>0&&i(e.sri,e.eci+1,n,h))):c>0&&(i(e.eri+1,r,n,h),o>0&&i(s,r,e.eri,e.sci-1),d>0&&i(s,e.eci+1,e.eri,h)),o>0?(i(s,r,n,e.sci-1),d>0?(i(s,e.eri+1,n,h),a>0&&i(s,e.sci,e.sri-1,e.eci),c>0&&i(e.sri+1,e.sci,n,e.eci)):(a>0&&i(s,e.sci,e.sri-1,h),c>0&&i(e.sri+1,e.sci,n,h))):d>0&&(i(n,e.eci+1,n,h),a>0&&i(s,r,e.sri-1,e.eci),c>0&&i(e.eri+1,r,n,e.eci)),t}size(){return[this.eri-this.sri+1,this.eci-this.sci+1]}toString(){let{sri:e,sci:t,eri:i,eci:l}=this,r=(0,s.xy2expr)(t,e);return this.multiple()&&(r=`${r}:${(0,s.xy2expr)(l,i)}`),r}clone(){let{sri:e,sci:t,eri:i,eci:s,w:r,h:n}=this;return new l(e,t,i,s,r,n)}equals(e){return this.eri===e.eri&&this.eci===e.eci&&this.sri===e.sri&&this.sci===e.sci}static valueOf(e){let t=e.split(\":\"),[i,r]=(0,s.expr2xy)(t[0]),[n,h]=[r,i];return t.length>1&&([h,n]=(0,s.expr2xy)(t[1])),new l(r,i,n,h)}}},9861:function(e,t,i){\"use strict\";var s;i.r(t),i.d(t,{default:function(){return s}}),s=class{constructor(){this.range=null,this.state=\"clear\"}copy(e){return this.range=e,this.state=\"copy\",this}cut(e){return this.range=e,this.state=\"cut\",this}isCopy(){return\"copy\"===this.state}isCut(){return\"cut\"===this.state}isClear(){return\"clear\"===this.state}clear(){this.range=null,this.state=\"clear\"}}},5832:function(e,t,i){\"use strict\";i.r(t),i.d(t,{Cols:function(){return l}});var s=i(\"8666\");class l{constructor({len:e,width:t,indexWidth:i,minWidth:s}){this._={},this.len=e,this.width=t,this.indexWidth=i,this.minWidth=s}setData(e){e.len&&(this.len=e.len,delete e.len),this._=e}getData(){let{len:e}=this;return Object.assign({len:e},this._)}getWidth(e){if(this.isHide(e))return 0;let t=this._[e];return t&&t.width?t.width:this.width}getOrNew(e){return this._[e]=this._[e]||{},this._[e]}setWidth(e,t){let i=this.getOrNew(e);i.width=t}unhide(e){let t=e;for(;t>0;)if(t-=1,this.isHide(t))this.setHide(t,!1);else break}isHide(e){let t=this._[e];return t&&t.hide}setHide(e,t){let i=this.getOrNew(e);!0===t?i.hide=!0:delete i.hide}setStyle(e,t){let i=this.getOrNew(e);i.style=t}sumWidth(e,t){return s.default.rangeSum(e,t,e=>this.getWidth(e))}totalWidth(){return this.sumWidth(0,this.len)}}},7488:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"1813\"),r=i(\"4453\"),n=i(\"8303\"),h=i(\"9861\"),a=i(\"1914\"),o=i(\"7026\"),c=i(\"8666\"),d=i(\"8934\"),u=i(\"5832\"),f=i(\"2006\"),g=i(\"791\"),p=i(\"2014\"),m=i(\"2182\");let w={mode:\"edit\",view:{height:()=>document.documentElement.clientHeight,width:()=>document.documentElement.clientWidth},showGrid:!0,showToolbar:!0,showContextmenu:!0,showBottomBar:!0,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:60},style:{bgcolor:\"#ffffff\",align:\"left\",valign:\"middle\",textwrap:!1,strike:!1,underline:!1,color:\"#0a0a0a\",font:{name:\"Arial\",size:10,bold:!1,italic:!1},format:\"normal\"}};function v(e,t,i=()=>{}){let{merges:s}=this,l=t.clone(),[r,n]=e.size(),[h,a]=t.size();return r>h&&(l.eri=t.sri+r-1),n>a&&(l.eci=t.sci+n-1),!s.intersects(l)||(i((0,m.t)(\"error.pasteForMergedCell\")),!1)}function b(e,t,i,s=!1){let{rows:l,merges:r}=this;(\"all\"===i||\"format\"===i)&&(l.deleteCells(t,i),r.deleteWithin(t)),l.copyPaste(e,t,i,s,(e,t,i)=>{if(i&&i.merge){let[s,l]=i.merge;(!(s<=0)||!(l<=0))&&r.add(new g.CellRange(e,t,e+s,t+l))}})}function x(e,t){let{clipboard:i,rows:s,merges:l}=this;s.cutPaste(e,t),l.move(e,t.sri-e.sri,t.sci-e.sci),i.clear()}function y(e,t,i){let{styles:s,rows:l}=this,r=l.getCellOrNew(e,t),n={};void 0!==r.style&&(n=c.default.cloneDeep(s[r.style])),n=c.default.merge(n,{border:i}),r.style=this.addStyle(n)}function k({mode:e,style:t,color:i}){let{styles:s,selector:l,rows:r}=this,{sri:n,sci:h,eri:a,eci:o}=l.range,d=!this.isSingleSelected();if(!!d||\"inside\"!==e&&\"horizontal\"!==e&&\"vertical\"!==e)if(\"outside\"!==e||d){if(\"none\"===e)l.range.each((e,t)=>{let i=r.getCell(e,t);if(i&&void 0!==i.style){let e=c.default.cloneDeep(s[i.style]);delete e.border,i.style=this.addStyle(e)}});else if(\"all\"===e||\"inside\"===e||\"outside\"===e||\"horizontal\"===e||\"vertical\"===e){let s=[];for(let l=n;l<=a;l+=1)for(let c=h;c<=o;c+=1){let u=[];for(let e=0;e<s.length;e+=1){let[t,i,r,n]=s[e];if(l===t+r+1&&u.push(e),t<=l&&l<=t+r&&c===i){c+=n+1;break}}if(u.forEach(e=>s.splice(e,1)),c>o)break;let f=r.getCell(l,c),[g,p]=[0,0];f&&f.merge&&([g,p]=f.merge,s.push([l,c,g,p]));let m=g>0&&l+g===a,w=p>0&&c+p===o,v={};\"all\"===e?v={bottom:[t,i],top:[t,i],left:[t,i],right:[t,i]}:\"inside\"===e?(!w&&c<o&&(v.right=[t,i]),!m&&l<a&&(v.bottom=[t,i])):\"horizontal\"===e?!m&&l<a&&(v.bottom=[t,i]):\"vertical\"===e?!w&&c<o&&(v.right=[t,i]):\"outside\"===e&&d&&(n===l&&(v.top=[t,i]),(m||a===l)&&(v.bottom=[t,i]),h===c&&(v.left=[t,i]),(w||o===c)&&(v.right=[t,i])),Object.keys(v).length>0&&y.call(this,l,c,v),c+=p}}else if(\"top\"===e||\"bottom\"===e)for(let s=h;s<=o;s+=1)\"top\"===e&&(y.call(this,n,s,{top:[t,i]}),s+=r.getCellMerge(n,s)[1]),\"bottom\"===e&&(y.call(this,a,s,{bottom:[t,i]}),s+=r.getCellMerge(a,s)[1]);else if(\"left\"===e||\"right\"===e)for(let s=n;s<=a;s+=1)\"left\"===e&&(y.call(this,s,h,{left:[t,i]}),s+=r.getCellMerge(s,h)[0]),\"right\"===e&&(y.call(this,s,o,{right:[t,i]}),s+=r.getCellMerge(s,o)[0])}else y.call(this,n,h,{top:[t,i],bottom:[t,i],left:[t,i],right:[t,i]})}function C(e,t){let{rows:i}=this,s=this.freezeTotalHeight(),l=i.height;s+i.height<e&&(l-=t);let r=this.exceptRowSet,n=0,h=l,{height:a}=i;for(;n<i.len&&!(h>e);n+=1)!r.has(n)&&(h+=a=i.getHeight(n));return(h-=a)<=0?{ri:-1,top:0,height:a}:{ri:n-1,top:h,height:a}}function E(e,t){let{cols:i}=this,s=this.freezeTotalWidth(),l=i.indexWidth;s+i.indexWidth<e&&(l-=t);let[r,n,h]=c.default.rangeReduceIf(0,i.len,l,i.indexWidth,e,e=>i.getWidth(e));return n<=0?{ci:-1,left:0,width:i.indexWidth}:{ci:r-1,left:n,width:h}}s=class{constructor(e,t){this.settings=c.default.merge(w,t||{}),this.name=e||\"sheet\",this.freeze=[0,0],this.styles=[],this.merges=new o.Merges,this.rows=new d.Rows(this.settings.row),this.cols=new u.Cols(this.settings.col),this.validations=new f.Validations,this.hyperlinks={},this.comments={},this.selector=new l.default,this.scroll=new r.default,this.history=new n.default,this.clipboard=new h.default,this.autoFilter=new a.default,this.change=()=>{},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map}addValidation(e,t,i){this.changeData(()=>{this.validations.add(e,t,i)})}removeValidation(){let{range:e}=this.selector;this.changeData(()=>{this.validations.remove(e)})}getSelectedValidator(){let{ri:e,ci:t}=this.selector,i=this.validations.get(e,t);return i?i.validator:null}getSelectedValidation(){let{ri:e,ci:t,range:i}=this.selector,s=this.validations.get(e,t),l={ref:i.toString()};return null!==s&&(l.mode=s.mode,l.validator=s.validator),l}canUndo(){return this.history.canUndo()}canRedo(){return this.history.canRedo()}undo(){this.history.undo(this.getData(),e=>{this.setData(e)})}redo(){this.history.redo(this.getData(),e=>{this.setData(e)})}copy(){this.clipboard.copy(this.selector.range)}copyToSystemClipboard(e){let t=[],{sri:i,eri:s,sci:l,eci:r}=this.selector.range;for(let e=i;e<=s;e+=1){let i=[];for(let t=l;t<=r;t+=1){let s=this.getCell(e,t);i.push(s&&s.text||\"\")}t.push(i)}t=t.map(e=>e.join(\"\t\")).join(\"\\n\"),e&&(e.clipboardData.clearData(),e.clipboardData.setData(\"text/plain\",t),e.preventDefault()),navigator.clipboard&&navigator.clipboard.writeText(t).then(()=>{},e=>{console.log(\"text copy to the system clipboard error  \",t,e)})}cut(){this.clipboard.cut(this.selector.range)}paste(e=\"all\",t=()=>{}){let{clipboard:i,selector:s}=this;return!i.isClear()&&!!v.call(this,i.range,s.range,t)&&(this.changeData(()=>{i.isCopy()?b.call(this,i.range,s.range,e):i.isCut()&&x.call(this,i.range,s.range)}),!0)}pasteFromSystemClipboard(e,t){let{selector:i}=this;navigator.clipboard.readText().then(s=>{let l=this.parseClipboardContent(s),r=i.ri;l.forEach(e=>{let t=i.ci;e.forEach(e=>{this.setCellText(r,t,e,\"input\"),t+=1}),r+=1}),e(),t(this.rows.getData())})}parseClipboardContent(e){let t=[],i=e.split(\"\\n\"),s=0;return i.forEach(e=>{t[s]=e.split(\"\t\"),s+=1}),t}pasteFromText(e){let t=[];if((t=/\\r\\n/.test(e)?e.split(\"\\r\\n\").map(e=>e.replace(/\"/g,\"\").split(\"\t\")):e.split(\"\\n\").map(e=>e.replace(/\"/g,\"\").split(\"\t\"))).length){let{rows:e,selector:i}=this;this.changeData(()=>{e.paste(t,i.range)})}}autofill(e,t,i=()=>{}){let s=this.selector.range;return!!v.call(this,s,e,i)&&(this.changeData(()=>{b.call(this,s,e,t,!0)}),!0)}clearClipboard(){this.clipboard.clear()}calSelectedRangeByEnd(e,t){let{selector:i,rows:s,cols:l,merges:r}=this,{sri:n,sci:h,eri:a,eci:o}=i.range,c=i.ri,d=i.ci,[u,f]=[e,t];return e<0&&(u=s.len-1),t<0&&(f=l.len-1),u>c?[n,a]=[c,u]:[n,a]=[u,c],f>d?[h,o]=[d,f]:[h,o]=[f,d],i.range=r.union(new g.CellRange(n,h,a,o)),i.range=r.union(i.range),i.range}calSelectedRangeByStart(e,t){let{selector:i,rows:s,cols:l,merges:r}=this,n=r.getFirstIncludes(e,t);return null===n&&(n=new g.CellRange(e,t,e,t),-1===e&&(n.sri=0,n.eri=s.len-1),-1===t&&(n.sci=0,n.eci=l.len-1)),i.range=n,n}setSelectedCellAttr(e,t){this.changeData(()=>{let{selector:i,styles:s,rows:l}=this;if(\"merge\"===e)t?this.merge():this.unmerge();else if(\"border\"===e)k.call(this,t);else if(\"formula\"===e){let{ri:e,ci:s,range:r}=i;if(i.multiple()){let[s,n]=i.size(),{sri:h,sci:a,eri:o,eci:c}=r;if(s>1)for(let e=a;e<=c;e+=1){let i=l.getCellOrNew(o+1,e);i.text=`=${t}(${(0,p.xy2expr)(e,h)}:${(0,p.xy2expr)(e,o)})`}else if(n>1){let i=l.getCellOrNew(e,c+1);i.text=`=${t}(${(0,p.xy2expr)(a,e)}:${(0,p.xy2expr)(c,e)})`}}else{let i=l.getCellOrNew(e,s);i.text=`=${t}()`}}else i.range.each((i,r)=>{let n=l.getCellOrNew(i,r),h={};if(void 0!==n.style&&(h=c.default.cloneDeep(s[n.style])),\"format\"===e)h.format=t,n.style=this.addStyle(h);else if(\"font-bold\"===e||\"font-italic\"===e||\"font-name\"===e||\"font-size\"===e){let i={};i[e.split(\"-\")[1]]=t,h.font=Object.assign(h.font||{},i),n.style=this.addStyle(h)}else\"strike\"===e||\"textwrap\"===e||\"underline\"===e||\"align\"===e||\"valign\"===e||\"color\"===e||\"bgcolor\"===e?(h[e]=t,n.style=this.addStyle(h)):n[e]=t})})}setSelectedCellText(e,t=\"input\"){let{autoFilter:i,selector:s,rows:l}=this,{ri:r,ci:n}=s,h=r;this.unsortedRowMap.has(r)&&(h=this.unsortedRowMap.get(r));let a=l.getCell(h,n),o=a?a.text:\"\";if(this.setCellText(h,n,e,t),i.active()){let t=i.getFilter(n);if(t){let i=t.value.findIndex(e=>e===o);i>=0&&t.value.splice(i,1,e)}}}getSelectedCell(){let{ri:e,ci:t}=this.selector,i=e;return this.unsortedRowMap.has(e)&&(i=this.unsortedRowMap.get(e)),this.rows.getCell(i,t)}xyInSelectedRect(e,t){let{left:i,top:s,width:l,height:r}=this.getSelectedRect(),n=e-this.cols.indexWidth,h=t-this.rows.height;return n>i&&n<i+l&&h>s&&h<s+r}getSelectedRect(){return this.getRect(this.selector.range)}getClipboardRect(){let{clipboard:e}=this;return e.isClear()?{left:-100,top:-100}:this.getRect(e.range)}getRect(e){let{scroll:t,rows:i,cols:s,exceptRowSet:l}=this,{sri:r,sci:n,eri:h,eci:a}=e;if(r<0&&n<0)return{left:0,l:0,top:0,t:0,scroll:t};let o=s.sumWidth(0,n),c=i.sumHeight(0,r,l),d=i.sumHeight(r,h+1,l),u=s.sumWidth(n,a+1),f=o-t.x,g=c-t.y,p=this.freezeTotalHeight(),m=this.freezeTotalWidth();return m>0&&m>o&&(f=o),p>0&&p>c&&(g=c),{l:o,t:c,left:f,top:g,height:d,width:u,scroll:t}}getCellRectByXY(e,t){let{scroll:i,merges:s,rows:l,cols:r}=this,{ri:n,top:h,height:a}=C.call(this,t,i.y),{ci:o,left:c,width:d}=E.call(this,e,i.x);if(-1===o&&(d=r.totalWidth()),-1===n&&(a=l.totalHeight()),n>=0||o>=0){let e=s.getFirstIncludes(n,o);e&&(n=e.sri,o=e.sci,{left:c,top:h,width:d,height:a}=this.cellRect(n,o))}return{ri:n,ci:o,left:c,top:h,width:d,height:a}}isSingleSelected(){let{sri:e,sci:t,eri:i,eci:s}=this.selector.range,l=this.getCell(e,t);if(l&&l.merge){let[r,n]=l.merge;if(e+r===i&&t+n===s)return!0}return!this.selector.multiple()}canUnmerge(){let{sri:e,sci:t,eri:i,eci:s}=this.selector.range,l=this.getCell(e,t);if(l&&l.merge){let[r,n]=l.merge;if(e+r===i&&t+n===s)return!0}return!1}merge(){let{selector:e,rows:t}=this;if(this.isSingleSelected())return;let[i,s]=e.size();if(i>1||s>1){let{sri:l,sci:r}=e.range;this.changeData(()=>{let n=t.getCellOrNew(l,r);n.merge=[i-1,s-1],this.merges.add(e.range),this.rows.deleteCells(e.range),this.rows.setCell(l,r,n)})}}unmerge(){let{selector:e}=this;if(!this.isSingleSelected())return;let{sri:t,sci:i}=e.range;this.changeData(()=>{this.rows.deleteCell(t,i,\"merge\"),this.merges.deleteWithin(e.range)})}canAutofilter(){return!this.autoFilter.active()}autofilter(){let{autoFilter:e,selector:t}=this;this.changeData(()=>{e.active()?(e.clear(),this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map):e.ref=t.range.toString()})}setAutoFilter(e,t,i,s){let{autoFilter:l}=this;l.addFilter(e,i,s),l.setSort(e,t),this.resetAutoFilter()}resetAutoFilter(){let{autoFilter:e,rows:t}=this;if(!e.active())return;let{sort:i}=e,{rset:s,fset:l}=e.filteredRows((e,i)=>t.getCell(e,i)),r=Array.from(l),n=Array.from(l);i&&r.sort((e,t)=>\"asc\"===i.order?e-t:\"desc\"===i.order?t-e:0),this.exceptRowSet=s,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,r.forEach((e,t)=>{this.sortedRowMap.set(n[t],e),this.unsortedRowMap.set(e,n[t])})}deleteCell(e=\"all\"){let{selector:t}=this;this.changeData(()=>{this.rows.deleteCells(t.range,e),(\"all\"===e||\"format\"===e)&&this.merges.deleteWithin(t.range)})}insert(e,t=1){this.changeData(()=>{let{sri:i,sci:s}=this.selector.range,{rows:l,merges:r,cols:n}=this,h=i;\"row\"===e?l.insert(i,t):\"column\"===e&&(l.insertColumn(s,t),h=s,n.len+=t,Object.keys(n._).reverse().forEach(e=>{let i=parseInt(e,10);i>=s&&(n._[i+t]=n._[i],delete n._[i])})),r.shift(e,h,t,(e,t,i,s)=>{let r=l.getCell(e,t);r.merge[0]+=i,r.merge[1]+=s})})}delete(e){this.changeData(()=>{let{rows:t,merges:i,selector:s,cols:l}=this,{range:r}=s,{sri:n,sci:h,eri:a,eci:o}=s.range,[c,d]=s.range.size(),u=n,f=c;\"row\"===e?t.delete(n,a):\"column\"===e&&(t.deleteColumn(h,o),u=r.sci,f=d,l.len-=o-h+1,Object.keys(l._).forEach(e=>{let t=parseInt(e,10);t>=h&&(t>o&&(l._[t-(o-h+1)]=l._[t]),delete l._[t])})),i.shift(e,u,-f,(e,i,s,l)=>{let r=t.getCell(e,i);r.merge[0]+=s,r.merge[1]+=l,0===r.merge[0]&&0===r.merge[1]&&delete r.merge})})}scrollx(e,t){let{scroll:i,freeze:s,cols:l}=this,[,r]=s,[n,h,a]=c.default.rangeReduceIf(r,l.len,0,0,e,e=>l.getWidth(e)),o=h;e>0&&(o+=a),i.x!==o&&(i.ci=e>0?n:0,i.x=o,t())}scrolly(e,t){let{scroll:i,freeze:s,rows:l}=this,[r]=s,[n,h,a]=c.default.rangeReduceIf(r,l.len,0,0,e,e=>l.getHeight(e)),o=h;e>0&&(o+=a),i.y!==o&&(i.ri=e>0?n:0,i.y=o,t())}cellRect(e,t){let{rows:i,cols:s}=this,l=s.sumWidth(0,t),r=i.sumHeight(0,e),n=i.getCell(e,t),h=s.getWidth(t),a=i.getHeight(e);if(null!==n&&n.merge){let[l,r]=n.merge;if(l>0)for(let t=1;t<=l;t+=1)a+=i.getHeight(e+t);if(r>0)for(let e=1;e<=r;e+=1)h+=s.getWidth(t+e)}return{left:l,top:r,width:h,height:a,cell:n}}getCell(e,t){return this.rows.getCell(e,t)}getCellTextOrDefault(e,t){let i=this.getCell(e,t);return i&&i.text?i.text:\"\"}getCellStyle(e,t){let i=this.getCell(e,t);return i&&void 0!==i.style?this.styles[i.style]:null}getCellStyleOrDefault(e,t){let{styles:i,rows:s}=this,l=s.getCell(e,t),r=l&&void 0!==l.style?i[l.style]:{};return c.default.merge(this.defaultStyle(),r)}getSelectedCellStyle(){let{ri:e,ci:t}=this.selector;return this.getCellStyleOrDefault(e,t)}setCellText(e,t,i,s){console.log(JSON.stringify({ri:e,ci:t,text:i,state:s}));let{rows:l,history:r,validations:n}=this;\"finished\"===s?(l.setCellText(e,t,\"\"),r.add(this.getData()),l.setCellText(e,t,i)):(l.setCellText(e,t,i),this.change(this.getData())),n.validate(e,t,i)}freezeIsActive(){let[e,t]=this.freeze;return e>0||t>0}setFreeze(e,t){this.changeData(()=>{this.freeze=[e,t]})}freezeTotalWidth(){return this.cols.sumWidth(0,this.freeze[1])}freezeTotalHeight(){return this.rows.sumHeight(0,this.freeze[0])}setRowHeight(e,t){this.changeData(()=>{this.rows.setHeight(e,t)})}setColWidth(e,t){this.changeData(()=>{this.cols.setWidth(e,t)})}viewHeight(){let{view:e,showToolbar:t,showBottomBar:i}=this.settings,s=e.height();return i&&(s-=41),t&&(s-=41),s}viewWidth(){return this.settings.view.width()}freezeViewRange(){let[e,t]=this.freeze;return new g.CellRange(0,0,e-1,t-1,this.freezeTotalWidth(),this.freezeTotalHeight())}contentRange(){let{rows:e,cols:t}=this,[i,s]=e.maxCell(),l=e.sumHeight(0,i+1),r=t.sumWidth(0,s+1);return new g.CellRange(0,0,i,s,r,l)}exceptRowTotalHeight(e,t){let{exceptRowSet:i,rows:s}=this,l=Array.from(i),r=0;return l.forEach(i=>{if(i<e||i>t){let e=s.getHeight(i);r+=e}}),r}viewRange(){let{scroll:e,rows:t,cols:i,freeze:s,exceptRowSet:l}=this,{ri:r,ci:n}=e;r<=0&&([r]=s),n<=0&&([,n]=s);let[h,a]=[0,0],[o,c]=[t.len,i.len];for(let e=r;e<t.len&&(!l.has(e)&&(a+=t.getHeight(e),o=e),!(a>this.viewHeight()));e+=1);for(let e=n;e<i.len&&(h+=i.getWidth(e),c=e,!(h>this.viewWidth()));e+=1);return new g.CellRange(r,n,o,c,h,a)}eachMergesInView(e,t){this.merges.filterIntersects(e).forEach(e=>t(e))}hideRowsOrCols(){let{rows:e,cols:t,selector:i}=this,[s,l]=i.size(),{sri:r,sci:n,eri:h,eci:a}=i.range;if(s===e.len)for(let e=n;e<=a;e+=1)t.setHide(e,!0);else if(l===t.len)for(let t=r;t<=h;t+=1)e.setHide(t,!0)}unhideRowsOrCols(e,t){this[`${e}s`].unhide(t)}rowEach(e,t,i){let s=0,{rows:l}=this,r=this.exceptRowSet,n=[...r],h=0;for(let t=0;t<n.length;t+=1)n[t]<e&&(h+=1);for(let n=e+h;n<=t+h;n+=1)if(r.has(n))h+=1;else{let e=l.getHeight(n);if(e>0&&(i(n,s,e),(s+=e)>this.viewHeight()))break}}colEach(e,t,i){let s=0,{cols:l}=this;for(let r=e;r<=t;r+=1){let e=l.getWidth(r);if(e>0&&(i(r,s,e),(s+=e)>this.viewWidth()))break}}defaultStyle(){return this.settings.style}addStyle(e){let{styles:t}=this;for(let i=0;i<t.length;i+=1){let s=t[i];if(c.default.equals(s,e))return i}return t.push(e),t.length-1}changeData(e){this.history.add(this.getData()),e(),this.change(this.getData())}setData(e){return Object.keys(e).forEach(t=>{if(\"merges\"===t||\"rows\"===t||\"cols\"===t||\"validations\"===t)this[t].setData(e[t]);else if(\"freeze\"===t){let[i,s]=(0,p.expr2xy)(e[t]);this.freeze=[s,i]}else\"autofilter\"===t?this.autoFilter.setData(e[t]):void 0!==e[t]&&(this[t]=e[t])}),this}getData(){let{name:e,freeze:t,styles:i,merges:s,rows:l,cols:r,validations:n,autoFilter:h}=this;return{name:e,freeze:(0,p.xy2expr)(t[1],t[0]),styles:i,merges:s.getData(),rows:l.getData(),cols:r.getData(),validations:n.getData(),autofilter:h.getData()}}}},1933:function(e,t,i){\"use strict\";i.r(t),i.d(t,{fontSizes:function(){return l},baseFonts:function(){return s},getFontSizePxByPt:function(){return r}});let s=[{key:\"Arial\",title:\"Arial\"},{key:\"Helvetica\",title:\"Helvetica\"},{key:\"Source Sans Pro\",title:\"Source Sans Pro\"},{key:\"Comic Sans MS\",title:\"Comic Sans MS\"},{key:\"Courier New\",title:\"Courier New\"},{key:\"Verdana\",title:\"Verdana\"},{key:\"Lato\",title:\"Lato\"}],l=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];function r(e){for(let t=0;t<l.length;t+=1){let i=l[t];if(i.pt===e)return i.px}return e}},5854:function(e,t,i){\"use strict\";i.r(t),i.d(t,{formatm:function(){return h},baseFormats:function(){return n}});var s=i(\"2182\");let l=e=>e,r=e=>{if(/^(-?\\d*.?\\d*)$/.test(e)){let t=Number(e).toFixed(2).toString(),[i,...s]=t.split(\"\\\\.\");return[i.replace(/(\\d)(?=(\\d{3})+(?!\\d))/g,\"$1,\"),...s]}return e},n=[{key:\"normal\",title:(0,s.tf)(\"format.normal\"),type:\"string\",render:l},{key:\"text\",title:(0,s.tf)(\"format.text\"),type:\"string\",render:l},{key:\"number\",title:(0,s.tf)(\"format.number\"),type:\"number\",label:\"1,000.12\",render:r},{key:\"percent\",title:(0,s.tf)(\"format.percent\"),type:\"number\",label:\"10.12%\",render:e=>`${e}%`},{key:\"rmb\",title:(0,s.tf)(\"format.rmb\"),type:\"number\",label:\"￥10.00\",render:e=>`￥${r(e)}`},{key:\"usd\",title:(0,s.tf)(\"format.usd\"),type:\"number\",label:\"$10.00\",render:e=>`$${r(e)}`},{key:\"eur\",title:(0,s.tf)(\"format.eur\"),type:\"number\",label:\"€10.00\",render:e=>`€${r(e)}`},{key:\"date\",title:(0,s.tf)(\"format.date\"),type:\"date\",label:\"26/09/2008\",render:l},{key:\"time\",title:(0,s.tf)(\"format.time\"),type:\"date\",label:\"15:59:00\",render:l},{key:\"datetime\",title:(0,s.tf)(\"format.datetime\"),type:\"date\",label:\"26/09/2008 15:59:00\",render:l},{key:\"duration\",title:(0,s.tf)(\"format.duration\"),type:\"date\",label:\"24:01:00\",render:l}],h={};n.forEach(e=>{h[e.key]=e})},4913:function(e,t,i){\"use strict\";i.r(t),i.d(t,{formulam:function(){return h},formulas:function(){return n},baseFormulas:function(){return r}});var s=i(\"2182\"),l=i(\"8666\");let r=[{key:\"SUM\",title:(0,s.tf)(\"formula.sum\"),render:e=>e.reduce((e,t)=>(0,l.numberCalc)(\"+\",e,t),0)},{key:\"AVERAGE\",title:(0,s.tf)(\"formula.average\"),render:e=>e.reduce((e,t)=>Number(e)+Number(t),0)/e.length},{key:\"MAX\",title:(0,s.tf)(\"formula.max\"),render:e=>Math.max(...e.map(e=>Number(e)))},{key:\"MIN\",title:(0,s.tf)(\"formula.min\"),render:e=>Math.min(...e.map(e=>Number(e)))},{key:\"IF\",title:(0,s.tf)(\"formula._if\"),render:([e,t,i])=>e?t:i},{key:\"AND\",title:(0,s.tf)(\"formula.and\"),render:e=>e.every(e=>e)},{key:\"OR\",title:(0,s.tf)(\"formula.or\"),render:e=>e.some(e=>e)},{key:\"CONCAT\",title:(0,s.tf)(\"formula.concat\"),render:e=>e.join(\"\")}],n=r,h={};r.forEach(e=>{h[e.key]=e})},8666:function(e,t,i){\"use strict\";i.r(t),i.d(t,{numberCalc:function(){return r},default:function(){return n}});let s=(e={},...t)=>(t.forEach(t=>{Object.keys(t).forEach(i=>{let l=t[i];\"string\"==typeof l||\"number\"==typeof l||\"boolean\"==typeof l?e[i]=l:\"function\"!=typeof l&&!Array.isArray(l)&&l instanceof Object?(e[i]=e[i]||{},s(e[i],l)):e[i]=l})}),e);function l(e){let t=`${e}`,i=0,s=!1;for(let e=0;e<t.length;e+=1)!0===s&&(i+=1),\".\"===t.charAt(e)&&(s=!0);return i}function r(e,t,i){if(Number.isNaN(t)||Number.isNaN(i))return t+e+i;let s=l(t),r=l(i),n=Number(t),h=Number(i),a=0;if(\"-\"===e)a=n-h;else if(\"+\"===e)a=n+h;else if(\"*\"===e)a=n*h;else if(\"/\"===e)return l(a=n/h)>5?a.toFixed(2):a;return a.toFixed(Math.max(s,r))}var n={cloneDeep:function(e){return JSON.parse(JSON.stringify(e))},merge:(...e)=>s({},...e),equals:function e(t,i){let s=Object.keys(t);if(s.length!==Object.keys(i).length)return!1;for(let l=0;l<s.length;l+=1){let r=s[l],n=t[r],h=i[r];if(void 0===h)return!1;if(\"string\"==typeof n||\"number\"==typeof n||\"boolean\"==typeof n){if(n!==h)return!1}else if(Array.isArray(n)){if(n.length!==h.length)return!1;for(let t=0;t<n.length;t+=1)if(!e(n[t],h[t]))return!1}else if(\"function\"!=typeof n&&!Array.isArray(n)&&n instanceof Object&&!e(n,h))return!1}return!0},arrayEquals:function(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i+=1)if(e[i]!==t[i])return!1;return!0},sum:(e,t=e=>e)=>{let i=0,s=0;return Object.keys(e).forEach(l=>{i+=t(e[l],l),s+=1}),[i,s]},rangeEach:function(e,t,i){for(let s=e;s<t;s+=1)i(s)},rangeSum:function(e,t,i){let s=0;for(let l=e;l<t;l+=1)s+=i(l);return s},rangeReduceIf:function(e,t,i,s,l,r){let n=i,h=s,a=e;for(;a<t&&!(n>l);a+=1)n+=h=r(a);return[a,n-h,h]},deleteProperty:function(e,t){let i=e[`${t}`];return delete e[`${t}`],i},numberCalc:r}},8303:function(e,t,i){\"use strict\";var History;i.r(t),i.d(t,{default:function(){return History}}),History=class{constructor(){this.undoItems=[],this.redoItems=[]}add(e){this.undoItems.push(JSON.stringify(e)),this.redoItems=[]}canUndo(){return this.undoItems.length>0}canRedo(){return this.redoItems.length>0}undo(e,t){let{undoItems:i,redoItems:s}=this;this.canUndo()&&(s.push(JSON.stringify(e)),t(JSON.parse(i.pop())))}redo(e,t){let{undoItems:i,redoItems:s}=this;this.canRedo()&&(i.push(JSON.stringify(e)),t(JSON.parse(s.pop())))}}},7026:function(e,t,i){\"use strict\";i.r(t),i.d(t,{Merges:function(){return l}});var s=i(\"791\");class l{constructor(e=[]){this._=e}forEach(e){this._.forEach(e)}deleteWithin(e){this._=this._.filter(t=>!t.within(e))}getFirstIncludes(e,t){for(let i=0;i<this._.length;i+=1){let s=this._[i];if(s.includes(e,t))return s}return null}filterIntersects(e){return new l(this._.filter(t=>t.intersects(e)))}intersects(e){for(let t=0;t<this._.length;t+=1){let i=this._[t];if(i.intersects(e))return!0}return!1}union(e){let t=e;return this._.forEach(e=>{e.intersects(t)&&(t=e.union(t))}),t}add(e){this.deleteWithin(e),this._.push(e)}shift(e,t,i,s){this._.forEach(l=>{let{sri:r,sci:n,eri:h,eci:a}=l;\"row\"===e?r>=t?(l.sri+=i,l.eri+=i):r<t&&t<=h&&(l.eri+=i,s(r,n,i,0)):\"column\"===e&&(n>=t?(l.sci+=i,l.eci+=i):n<t&&t<=a&&(l.eci+=i,s(r,n,0,i)))})}move(e,t,i){this._.forEach(s=>{s.within(e)&&(s.eri+=t,s.sri+=t,s.sci+=i,s.eci+=i)})}setData(e){return this._=e.map(e=>s.CellRange.valueOf(e)),this}getData(){return this._.map(e=>e.toString())}}},8934:function(e,t,i){\"use strict\";i.r(t),i.d(t,{Rows:function(){return r}});var s=i(\"8666\"),l=i(\"2014\");class r{constructor({len:e,height:t}){this._={},this.len=e,this.height=t}getHeight(e){if(this.isHide(e))return 0;let t=this.get(e);return t&&t.height?t.height:this.height}setHeight(e,t){let i=this.getOrNew(e);i.height=t}unhide(e){let t=e;for(;t>0;)if(t-=1,this.isHide(t))this.setHide(t,!1);else break}isHide(e){let t=this.get(e);return t&&t.hide}setHide(e,t){let i=this.getOrNew(e);!0===t?i.hide=!0:delete i.hide}setStyle(e,t){let i=this.getOrNew(e);i.style=t}sumHeight(e,t,i){return s.default.rangeSum(e,t,e=>i&&i.has(e)?0:this.getHeight(e))}totalHeight(){return this.sumHeight(0,this.len)}get(e){return this._[e]}getOrNew(e){return this._[e]=this._[e]||{cells:{}},this._[e]}getCell(e,t){let i=this.get(e);return void 0!==i&&void 0!==i.cells&&void 0!==i.cells[t]?i.cells[t]:null}getCellMerge(e,t){let i=this.getCell(e,t);return i&&i.merge?i.merge:[0,0]}getCellOrNew(e,t){let i=this.getOrNew(e);return i.cells[t]=i.cells[t]||{},i.cells[t]}setCell(e,t,i,s=\"all\"){let l=this.getOrNew(e);\"all\"===s?l.cells[t]=i:\"text\"===s?(l.cells[t]=l.cells[t]||{},l.cells[t].text=i.text):\"format\"===s&&(l.cells[t]=l.cells[t]||{},l.cells[t].style=i.style,i.merge&&(l.cells[t].merge=i.merge))}setCellText(e,t,i){let s=this.getCellOrNew(e,t);!1!==s.editable&&(s.text=i)}copyPaste(e,t,i,r=!1,n=()=>{}){let{sri:h,sci:a,eri:o,eci:c}=e,d=t.sri,u=t.sci,f=t.eri,g=t.eci,[p,m]=e.size(),[w,v]=t.size(),b=!0,x=0;(f<h||g<a)&&(b=!1,x=f<h?w:v);for(let e=h;e<=o;e+=1)if(this._[e]){for(let t=a;t<=c;t+=1)if(this._[e].cells&&this._[e].cells[t])for(let w=d;w<=f;w+=p)for(let v=u;v<=g;v+=m){let y=w+(e-h),k=v+(t-a),C=s.default.cloneDeep(this._[e].cells[t]);if(r&&C&&C.text&&C.text.length>0){let{text:e}=C,t=v-u+(w-d)+2;if(!b&&(t-=x+1),\"=\"===e[0])C.text=e.replace(/[a-zA-Z]{1,3}\\d+/g,e=>{let[i,s]=[0,0];return(h===d?i=t-1:s=t-1,/^\\d+$/.test(e))?e:(0,l.expr2expr)(e,i,s)});else if(p<=1&&m>1&&(d>o||f<h)||m<=1&&p>1&&(u>c||g<a)||p<=1&&m<=1){let i=/[\\\\.\\d]+$/.exec(e);if(null!==i){let s=Number(i[0])+t-1;C.text=e.substring(0,i.index)+s}}}this.setCell(y,k,C,i),n(y,k,C)}}}cutPaste(e,t){let i={};this.each(s=>{this.eachCells(s,l=>{let r=parseInt(s,10),n=parseInt(l,10);e.includes(s,l)&&(r=t.sri+(r-e.sri),n=t.sci+(n-e.sci)),i[r]=i[r]||{cells:{}},i[r].cells[n]=this._[s].cells[l]})}),this._=i}paste(e,t){if(e.length<=0)return;let{sri:i,sci:s}=t;e.forEach((e,t)=>{let l=i+t;e.forEach((e,t)=>{this.setCellText(l,s+t,e)})})}insert(e,t=1){let i={};this.each((s,r)=>{let n=parseInt(s,10);n>=e&&(n+=t,this.eachCells(s,(i,s)=>{s.text&&\"=\"===s.text[0]&&(s.text=s.text.replace(/[a-zA-Z]{1,3}\\d+/g,i=>(0,l.expr2expr)(i,0,t,(t,i)=>i>=e)))})),i[n]=r}),this._=i,this.len+=t}delete(e,t){let i=t-e+1,s={};this.each((r,n)=>{let h=parseInt(r,10);h<e?s[h]=n:r>t&&(s[h-i]=n,this.eachCells(r,(e,s)=>{s.text&&\"=\"===s.text[0]&&(s.text=s.text.replace(/[a-zA-Z]{1,3}\\d+/g,e=>(0,l.expr2expr)(e,0,-i,(e,i)=>i>t)))}))}),this._=s,this.len-=i}insertColumn(e,t=1){this.each((i,s)=>{let r={};this.eachCells(i,(i,s)=>{let n=parseInt(i,10);n>=e&&(n+=t,s.text&&\"=\"===s.text[0]&&(s.text=s.text.replace(/[a-zA-Z]{1,3}\\d+/g,i=>(0,l.expr2expr)(i,t,0,t=>t>=e)))),r[n]=s}),s.cells=r})}deleteColumn(e,t){let i=t-e+1;this.each((s,r)=>{let n={};this.eachCells(s,(s,r)=>{let h=parseInt(s,10);h<e?n[h]=r:h>t&&(n[h-i]=r,r.text&&\"=\"===r.text[0]&&(r.text=r.text.replace(/[a-zA-Z]{1,3}\\d+/g,e=>(0,l.expr2expr)(e,-i,0,e=>e>t))))}),r.cells=n})}deleteCells(e,t=\"all\"){e.each((e,i)=>{this.deleteCell(e,i,t)})}deleteCell(e,t,i=\"all\"){let s=this.get(e);if(null!==s){let l=this.getCell(e,t);null!==l&&!1!==l.editable&&(\"all\"===i?delete s.cells[t]:\"text\"===i?(l.text&&delete l.text,l.value&&delete l.value):\"format\"===i?(void 0!==l.style&&delete l.style,l.merge&&delete l.merge):\"merge\"===i&&l.merge&&delete l.merge)}}maxCell(){let e=Object.keys(this._),t=e[e.length-1],i=this._[t];if(i){let{cells:e}=i,s=Object.keys(e),l=s[s.length-1];return[parseInt(t,10),parseInt(l,10)]}return[0,0]}each(e){Object.entries(this._).forEach(([t,i])=>{e(t,i)})}eachCells(e,t){this._[e]&&this._[e].cells&&Object.entries(this._[e].cells).forEach(([e,i])=>{t(e,i)})}setData(e){e.len&&(this.len=e.len,delete e.len),this._=e}getData(){let{len:e}=this;return Object.assign({len:e},this._)}}},4453:function(e,t,i){\"use strict\";var s;i.r(t),i.d(t,{default:function(){return s}}),s=class{constructor(){this.x=0,this.y=0,this.ri=0,this.ci=0}}},1813:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"791\");s=class{constructor(){this.range=new l.CellRange(0,0,0,0),this.ri=0,this.ci=0}multiple(){return this.range.multiple()}setIndexes(e,t){this.ri=e,this.ci=t}size(){return this.range.size()}}},2006:function(e,t,i){\"use strict\";i.r(t),i.d(t,{Validations:function(){return n}});var s=i(\"5718\"),l=i(\"791\");class r{constructor(e,t,i){this.refs=t,this.mode=e,this.validator=i}includes(e,t){let{refs:i}=this;for(let s=0;s<i.length;s+=1){let r=l.CellRange.valueOf(i[s]);if(r.includes(e,t))return!0}return!1}addRef(e){this.remove(l.CellRange.valueOf(e)),this.refs.push(e)}remove(e){let t=[];this.refs.forEach(i=>{let s=l.CellRange.valueOf(i);if(s.intersects(e)){let i=s.difference(e);i.forEach(e=>t.push(e.toString()))}else t.push(i)}),this.refs=t}getData(){let{refs:e,mode:t,validator:i}=this,{type:s,required:l,operator:r,value:n}=i;return{refs:e,mode:t,type:s,required:l,operator:r,value:n}}static valueOf({refs:e,mode:t,type:i,required:l,operator:n,value:h}){return new r(t,e,new s.default(i,l,h,n))}}class n{constructor(){this._=[],this.errors=new Map}getError(e,t){return this.errors.get(`${e}_${t}`)}validate(e,t,i){let s=this.get(e,t),l=`${e}_${t}`,{errors:r}=this;if(null!==s){let[e,t]=s.validator.validate(i);e?r.delete(l):r.set(l,t)}else r.delete(l);return!0}add(e,t,{type:i,required:l,value:n,operator:h}){let a=new s.default(i,l,n,h),o=this.getByValidator(a);null!==o?o.addRef(t):this._.push(new r(e,[t],a))}getByValidator(e){for(let t=0;t<this._.length;t+=1){let i=this._[t];if(i.validator.equals(e))return i}return null}get(e,t){for(let i=0;i<this._.length;i+=1){let s=this._[i];if(s.includes(e,t))return s}return null}remove(e){this.each(t=>{t.remove(e)})}each(e){this._.forEach(t=>e(t))}getData(){return this._.filter(e=>e.refs.length>0).map(e=>e.getData())}setData(e){this._=e.map(e=>r.valueOf(e))}}},5718:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s,l=i(\"2182\"),r=i(\"8666\");let n={phone:/^[1-9]\\d{10}$/,email:/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/};function h(e,t,...i){let s=\"\";return!e&&(s=(0,l.t)(`validation.${t}`,...i)),[e,s]}s=class{constructor(e,t,i,s){this.required=t,this.value=i,this.type=e,this.operator=s,this.message=\"\"}parseValue(e){let{type:t}=this;return\"date\"===t?new Date(e):\"number\"===t?Number(e):e}equals(e){let t=this.type===e.type&&this.required===e.required&&this.operator===e.operator;return t&&(t=Array.isArray(this.value)?r.default.arrayEquals(this.value,e.value):this.value===e.value),t}values(){return this.value.split(\",\")}validate(e){let{required:t,operator:i,value:s,type:l}=this;if(t&&/^\\s*$/.test(e))return h(!1,\"required\");if(/^\\s*$/.test(e))return[!0];if(n[l]&&!n[l].test(e))return h(!1,\"notMatch\");if(\"list\"===l)return h(this.values().includes(e),\"notIn\");if(i){let t=this.parseValue(e);if(\"be\"===i){let[e,i]=s;return h(t>=this.parseValue(e)&&t<=this.parseValue(i),\"between\",e,i)}if(\"nbe\"===i){let[e,i]=s;return h(t<this.parseValue(e)||t>this.parseValue(i),\"notBetween\",e,i)}if(\"eq\"===i)return h(t===this.parseValue(s),\"equal\",s);if(\"neq\"===i)return h(t!==this.parseValue(s),\"notEqual\",s);if(\"lt\"===i)return h(t<this.parseValue(s),\"lessThan\",s);if(\"lte\"===i)return h(t<=this.parseValue(s),\"lessThanEqual\",s);if(\"gt\"===i)return h(t>this.parseValue(s),\"greaterThan\",s);if(\"gte\"===i)return h(t>=this.parseValue(s),\"greaterThanEqual\",s)}return[!0]}}},5151:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return d},spreadsheet:function(){return c}});var s=i(\"3129\"),l=i(\"7488\"),r=i(\"2367\"),n=i(\"8467\"),h=i(\"91\"),a=i(\"2182\");i(\"9500\");class o{constructor(e,t={}){let i=e;this.options={showBottomBar:!0,...t},this.sheetIndex=1,this.datas=[],\"string\"==typeof e&&(i=document.querySelector(e)),this.bottombar=this.options.showBottomBar?new n.default(()=>{if(\"read\"===this.options.mode)return;let e=this.addSheet();this.sheet.resetData(e)},e=>{let t=this.datas[e];this.sheet.resetData(t)},()=>{this.deleteSheet()},(e,t)=>{this.datas[e].name=t,this.sheet.trigger(\"change\")}):null,this.data=this.addSheet();let l=(0,s.h)(\"div\",`${h.cssPrefix}`).on(\"contextmenu\",e=>e.preventDefault());i.appendChild(l.el),this.sheet=new r.default(l,this.data),null!==this.bottombar&&l.child(this.bottombar.el)}addSheet(e,t=!0){let i=e||`sheet${this.sheetIndex}`,s=new l.default(i,this.options);return s.change=(...e)=>{this.sheet.trigger(\"change\",...e)},this.datas.push(s),null!==this.bottombar&&this.bottombar.addItem(i,t,this.options),this.sheetIndex+=1,s}deleteSheet(){if(null===this.bottombar)return;let[e,t]=this.bottombar.deleteItem();e>=0&&(this.datas.splice(e,1),t>=0&&this.sheet.resetData(this.datas[t]),this.sheet.trigger(\"change\"))}loadData(e){let t=Array.isArray(e)?e:[e];if(null!==this.bottombar&&this.bottombar.clear(),this.datas=[],t.length>0)for(let e=0;e<t.length;e+=1){let i=t[e],s=this.addSheet(i.name,0===e);s.setData(i),0===e&&this.sheet.resetData(s)}return this}getData(){return this.datas.map(e=>e.getData())}cellText(e,t,i,s=0){return this.datas[s].setCellText(e,t,i,\"finished\"),this}cell(e,t,i=0){return this.datas[i].getCell(e,t)}cellStyle(e,t,i=0){return this.datas[i].getCellStyle(e,t)}reRender(){return this.sheet.table.render(),this}on(e,t){return this.sheet.on(e,t),this}validate(){let{validations:e}=this.data;return e.errors.size<=0}change(e){return this.sheet.on(\"change\",e),this}freeze(e,t,i){return this.datas[e].setFreeze(t,i),this}static locale(e,t){(0,a.locale)(e,t)}}let c=(e,t={})=>new o(e,t);window&&(window.x_spreadsheet=c,window.x_spreadsheet.locale=(e,t)=>(0,a.locale)(e,t));var d=o},156:function(e,t,i){\"use strict\";i.r(t),i.d(t,{default:function(){return s}});var s={toolbar:{undo:\"Undo\",redo:\"Redo\",print:\"Print\",paintformat:\"Paint format\",clearformat:\"Clear format\",format:\"Format\",fontName:\"Font\",fontSize:\"Font size\",fontBold:\"Font bold\",fontItalic:\"Font italic\",underline:\"Underline\",strike:\"Strike\",color:\"Text color\",bgcolor:\"Fill color\",border:\"Borders\",merge:\"Merge cells\",align:\"Horizontal align\",valign:\"Vertical align\",textwrap:\"Text wrapping\",freeze:\"Freeze cell\",autofilter:\"Filter\",formula:\"Functions\",more:\"More\"},contextmenu:{copy:\"Copy\",cut:\"Cut\",paste:\"Paste\",pasteValue:\"Paste values only\",pasteFormat:\"Paste format only\",hide:\"Hide\",insertRow:\"Insert row\",insertColumn:\"Insert column\",deleteSheet:\"Delete\",deleteRow:\"Delete row\",deleteColumn:\"Delete column\",deleteCell:\"Delete cell\",deleteCellText:\"Delete cell text\",validation:\"Data validations\",cellprintable:\"Enable export\",cellnonprintable:\"Disable export\",celleditable:\"Enable editing\",cellnoneditable:\"Disable editing\"},print:{size:\"Paper size\",orientation:\"Page orientation\",orientations:[\"Landscape\",\"Portrait\"]},format:{normal:\"Normal\",text:\"Plain Text\",number:\"Number\",percent:\"Percent\",rmb:\"RMB\",usd:\"USD\",eur:\"EUR\",date:\"Date\",time:\"Time\",datetime:\"Date time\",duration:\"Duration\"},formula:{sum:\"Sum\",average:\"Average\",max:\"Max\",min:\"Min\",_if:\"IF\",and:\"AND\",or:\"OR\",concat:\"Concat\"},validation:{required:\"it must be required\",notMatch:\"it not match its validation rule\",between:\"it is between {} and {}\",notBetween:\"it is not between {} and {}\",notIn:\"it is not in list\",equal:\"it equal to {}\",notEqual:\"it not equal to {}\",lessThan:\"it less than {}\",lessThanEqual:\"it less than or equal to {}\",greaterThan:\"it greater than {}\",greaterThanEqual:\"it greater than or equal to {}\"},error:{pasteForMergedCell:\"Unable to do this for merged cells\"},calendar:{weeks:[\"Sun\",\"Mon\",\"Tue\",\"Wed\",\"Thu\",\"Fri\",\"Sat\"],months:[\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"]},button:{next:\"Next\",cancel:\"Cancel\",remove:\"Remove\",save:\"Save\",ok:\"OK\"},sort:{desc:\"Sort Z -> A\",asc:\"Sort A -> Z\"},filter:{empty:\"empty\"},dataValidation:{mode:\"Mode\",range:\"Cell Range\",criteria:\"Criteria\",modeType:{cell:\"Cell\",column:\"Colun\",row:\"Row\"},type:{list:\"List\",number:\"Number\",date:\"Date\",phone:\"Phone\",email:\"Email\"},operator:{be:\"between\",nbe:\"not betwwen\",lt:\"less than\",lte:\"less than or equal to\",gt:\"greater than\",gte:\"greater than or equal to\",eq:\"equal to\",neq:\"not equal to\"}}}},2182:function(e,t,i){\"use strict\";i.r(t),i.d(t,{locale:function(){return o},t:function(){return h},tf:function(){return a}});var s=i(\"156\");let l=[\"en\"],r={en:s.default};function n(e,t){if(t)for(let i of l){if(!t[i])break;let s=t[i],l=e.match(/(?:\\\\.|[^.])+/g);for(let e=0;e<l.length;e+=1){let t=l[e],i=s[t];if(!i)break;if(e===l.length-1)return i;s=i}}}function h(e){let t=n(e,r);return!t&&window&&window.x_spreadsheet&&window.x_spreadsheet.$messages&&(t=n(e,window.x_spreadsheet.$messages)),t||\"\"}function a(e){return()=>h(e)}function o(e,t,i=!1){i?l=[e]:l.unshift(e),t&&(r[e]=t)}},227:function(e,t,i){\"use strict\";e.exports=i.p+\"0a130caac2e225758721.svg\"},9500:function(e,t,i){}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var i=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](i,i.exports,__webpack_require__),i.exports}__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.g=function(){if(\"object\"==typeof globalThis)return globalThis;try{return this||Function(\"return this\")()}catch(e){if(\"object\"==typeof window)return window}}(),__webpack_require__.d=function(e,t){for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},!function(){__webpack_require__.g.importScripts&&(e=__webpack_require__.g.location+\"\");var e,t=__webpack_require__.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName(\"script\");if(i.length){for(var s=i.length-1;s>-1&&!e;)e=i[s--].src}}if(!e)throw Error(\"Automatic publicPath is not supported in this browser\");e=e.replace(/#.*$/,\"\").replace(/\\?.*$/,\"\").replace(/\\/[^\\/]+$/,\"/\"),__webpack_require__.p=e}();var __webpack_exports__=__webpack_require__(\"5151\");module.exports=__webpack_exports__;\n//# sourceMappingURL=xspreadsheet.js.map","import { PlusCircleIcon, SyncIcon, XCircleIcon } from \"@primer/octicons-react\";\nimport classNames from \"classnames\";\nimport React, {\n  Suspense,\n  lazy,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from \"react\";\nimport { useDispatch } from \"react-redux\";\n\nimport { buildAction } from \"../../helper/eventHandlerHelper\";\nimport {\n  getDeviceMotionEventPermission,\n  labelOptions,\n  motionThresholdCondition,\n} from \"../../helper/gameHelper\";\nimport { useConnectSetting } from \"../../hooks/useConnectSettings\";\nimport type { AppDispatch } from \"../../slices\";\nimport {\n  debugToggled,\n  getMemoryStorageStatus,\n  logger,\n  setMotionThreshold,\n  setPersistentStorage,\n  setSwipeThreshold,\n  toggleDarkMode,\n} from \"../../slices/globalSlice\";\nimport { togglePhraseActiveGrp } from \"../../slices/phraseSlice\";\nimport { DebugLevel } from \"../../slices/settingHelper\";\nimport { toggleVocabularyActiveGrp } from \"../../slices/vocabularySlice\";\nimport { NotReady } from \"../Form/NotReady\";\nimport SettingsSwitch from \"../Form/SettingsSwitch\";\nimport \"../../css/Settings.css\";\nimport \"../../css/spin.css\";\nconst SettingsKanji = lazy(() => import(\"../Form/SettingsKanji\"));\nconst SettingsPhrase = lazy(() => import(\"../Form/SettingsPhrase\"));\nconst SettingsVocab = lazy(() => import(\"../Form/SettingsVocab\"));\nconst SettingsOppositeGame = lazy(() => import(\"../Form/SettingsGOpposite\"));\nconst SettingsKanaGame = lazy(() => import(\"../Form/SettingsGKana\"));\nconst SettingsKanjiGame = lazy(() => import(\"../Form/SettingsGKanji\"));\nconst SettingsParticleGame = lazy(() => import(\"../Form/SettingsGParticle\"));\nconst SettingsStats = lazy(() => import(\"../Form/SettingsStats\"));\n\nconst SettingsMeta = {\n  location: \"/settings/\",\n  label: \"Settings\",\n};\n\n// FIXME: getDerivedStateFromError\n/*\nfunction /*static getDerivedStateFromError(error: Error) {\n  const causeMsg =\n    (error.cause !== undefined && [\n      { msg: JSON.stringify(error.cause).replaceAll(\",\", \", \"), css: \"px-4\" },\n    ]) ||\n    [];\n\n  const errorMsgs = [\n    { msg: error.name + \": \" + error.message, css: \"px-2\" },\n    ...causeMsg,\n  ].map((e) => ({ ...e, lvl: DebugLevel.ERROR }));\n\n  // state\n  return {\n    errorMsgs,\n  };\n}\n*/\nfunction componentDidCatch(dispatch: AppDispatch, error: Error) {\n  const cause = error.cause as { code: string; value: unknown };\n\n  dispatch(debugToggled(DebugLevel.DEBUG));\n\n  switch (cause?.code) {\n    case \"StaleVocabActiveGrp\":\n      {\n        const stale = cause.value as string;\n        dispatch(logger(\"Error: \" + error.message, DebugLevel.ERROR));\n        dispatch(\n          logger(\n            \"Group \" + JSON.stringify(stale) + \" Removed\",\n            DebugLevel.ERROR\n          )\n        );\n        dispatch(toggleVocabularyActiveGrp(stale));\n        // FIXME: componentDidCatch setState\n        // this.setState({ errorMsgs: [] });\n      }\n\n      break;\n    case \"StalePhraseActiveGrp\":\n      {\n        const stale = cause.value as string;\n        dispatch(logger(\"Error: \" + error.message, DebugLevel.ERROR));\n        dispatch(\n          logger(\n            \"Group \" + JSON.stringify(stale) + \" Removed\",\n            DebugLevel.ERROR\n          )\n        );\n        dispatch(togglePhraseActiveGrp(stale));\n        // FIXME: componentDidCatch setState\n        // this.setState({ errorMsgs: [] });\n      }\n\n      break;\n    case \"DeviceMotionEvent\":\n      {\n        dispatch(logger(\"Error: \" + error.message, DebugLevel.ERROR));\n        dispatch(setMotionThreshold(0));\n      }\n      break;\n  }\n}\n\nfunction buildMotionListener(\n  dispatch: AppDispatch,\n  motionThreshold: number,\n  setShakeIntensity: React.Dispatch<React.SetStateAction<number | undefined>>\n) {\n  /**\n   * Handler for when device is shaken\n   */\n  return function listener(event: DeviceMotionEvent) {\n    try {\n      motionThresholdCondition(event, motionThreshold, (value) => {\n        setShakeIntensity(Number(value.toFixed(2)));\n        setTimeout(() => {\n          setShakeIntensity(undefined);\n        }, 300);\n      });\n    } catch (error) {\n      if (error instanceof Error) {\n        componentDidCatch(dispatch, error);\n      }\n    }\n  };\n}\n\nexport function collapseExpandToggler(\n  name: boolean,\n  toggleSection: (arg0: (arg1: boolean) => boolean) => void\n) {\n  const icon = name ? (\n    <XCircleIcon className=\"clickable\" size=\"medium\" aria-label=\"collapse\" />\n  ) : (\n    <PlusCircleIcon className=\"clickable\" size=\"medium\" aria-label=\"expand\" />\n  );\n\n  return <h2 onClick={() => toggleSection((t) => !t)}>{icon}</h2>;\n}\n\n/**\n * Classnames for page sections\n */\nconst pageClassName = classNames({ \"mb-5\": true });\n\nexport default function Settings() {\n  const dispatch = useDispatch<AppDispatch>();\n  const motionListener = useRef<\n    ReturnType<typeof buildMotionListener> | undefined\n  >(undefined);\n\n  const { darkMode, swipeThreshold, motionThreshold, memory, debug } =\n    useConnectSetting();\n\n  const [spin, setSpin] = useState(false);\n\n  const [sectionKanji, setSectionKanji] = useState(false);\n  const [sectionVocabulary, setSectionVocabulary] = useState(false);\n  const [sectionPhrase, setSectionPhrase] = useState(false);\n  const [sectionOpposites, setSectionOpposites] = useState(false);\n  const [sectionKana, setSectionKana] = useState(false);\n  const [sectionKanjiGame, setSectionKanjiGame] = useState(false);\n  const [sectionParticle, setSectionParticle] = useState(false);\n  const [sectionStats, setSectionStats] = useState(false);\n  const [swVersion, setSwVersion] = useState(\"\");\n  const [jsVersion, setJsVersion] = useState(\"\");\n  const [bundleVersion, setBundleVersion] = useState(\"\");\n  const [hardRefreshUnavailable, setHardRefreshUnavailable] = useState(false);\n  // const [errorMsgs, setErrorMsgs] = useState<ConsoleMessage[]>([]);\n  const [shakeIntensity, setShakeIntensity] = useState<number | undefined>(0);\n\n  useEffect(\n    () => {\n      void dispatch(getMemoryStorageStatus());\n\n      if (navigator.serviceWorker) {\n        navigator.serviceWorker.addEventListener(\n          \"message\",\n          swMessageEventListener\n        );\n\n        navigator.serviceWorker.controller?.postMessage({\n          type: \"SW_VERSION\",\n        });\n      }\n\n      return () => {\n        if (navigator.serviceWorker) {\n          navigator.serviceWorker.removeEventListener(\n            \"message\",\n            swMessageEventListener\n          );\n        }\n\n        if (motionListener.current) {\n          window.removeEventListener(\"devicemotion\", motionListener.current);\n        }\n      };\n    },\n    [\n      /** On mount and dismount */\n    ]\n  );\n\n  useEffect(() => {\n    if (motionThreshold > 0 && motionListener.current === undefined) {\n      motionListener.current = buildMotionListener(\n        dispatch,\n        motionThreshold,\n        setShakeIntensity\n      );\n\n      getDeviceMotionEventPermission(\n        () => {\n          if (motionListener.current)\n            window.addEventListener(\"devicemotion\", motionListener.current);\n        },\n        (error: Error) => componentDidCatch(dispatch, error)\n      );\n    } else if (motionThreshold === 0 && motionListener.current !== undefined) {\n      window.removeEventListener(\"devicemotion\", motionListener.current);\n      motionListener.current = undefined;\n    } else {\n      if (motionListener.current)\n        window.removeEventListener(\"devicemotion\", motionListener.current);\n\n      motionListener.current = buildMotionListener(\n        dispatch,\n        motionThreshold,\n        setShakeIntensity\n      );\n\n      getDeviceMotionEventPermission(\n        () => {\n          if (motionListener.current)\n            window.addEventListener(\"devicemotion\", motionListener.current);\n        },\n        (error: Error) => componentDidCatch(dispatch, error)\n      );\n    }\n  }, [dispatch, motionThreshold]);\n\n  const swMessageEventListener = useCallback(\n    (event: MessageEvent) => {\n      const { type, error } = event.data as { type: string; error: string };\n      if (type === \"DO_HARD_REFRESH\") {\n        if (error) {\n          dispatch(logger(error, DebugLevel.ERROR));\n        }\n\n        setTimeout(() => {\n          setSpin(false);\n          setHardRefreshUnavailable(true);\n        }, 2000);\n      } else if (type === \"SW_VERSION\") {\n        interface VersionInfo {\n          swVersion: string;\n          jsVersion: string;\n          bundleVersion: string;\n        }\n        const { swVersion, jsVersion, bundleVersion } =\n          event.data as VersionInfo;\n\n        setSwVersion(swVersion);\n        setJsVersion(jsVersion);\n        setBundleVersion(bundleVersion);\n      }\n    },\n    [dispatch]\n  );\n\n  // FIXME: errorMsgs component\n  // if (errorMsgs.length > 0) {\n  //   const minState = logify(this.state);\n  //   const minProps = logify(this.props);\n\n  //   const messages = [\n  //     ...errorMsgs,\n  //     { msg: \"props:\", lvl: DebugLevel.WARN, css: \"px-2\" },\n  //     { msg: minProps, lvl: DebugLevel.WARN, css: \"px-4\" },\n  //     { msg: \"state:\", lvl: DebugLevel.WARN, css: \"px-2\" },\n  //     { msg: minState, lvl: DebugLevel.WARN, css: \"px-4\" },\n  //   ];\n\n  //   return (\n  //     <div>\n  //       <div className=\"d-flex flex-column justify-content-around\">\n  //         <Console messages={messages} />\n  //       </div>\n  //     </div>\n  //   );\n  // }\n\n  return (\n    <div className=\"settings\">\n      <div className=\"d-flex flex-column justify-content-between px-3\">\n        <div className={pageClassName}>\n          <div className=\"d-flex justify-content-between\">\n            <h2>Global</h2>\n            <h2></h2>\n          </div>\n          <div>\n            <div className=\"d-flex flex-row justify-content-between\">\n              <div className=\"column-1 d-flex flex-column justify-content-end\">\n                <div\n                  className={classNames({\n                    \"w-25 d-flex flex-row justify-content-between\": true,\n                    invisible: swipeThreshold === 0,\n                  })}\n                >\n                  <div\n                    className=\"clickable px-2 pb-2\"\n                    onClick={() => {\n                      if (swipeThreshold - 1 <= 0) {\n                        dispatch(setSwipeThreshold(0));\n                      } else {\n                        dispatch(setSwipeThreshold(swipeThreshold - 1));\n                      }\n                    }}\n                  >\n                    -\n                  </div>\n                  <div className=\"px-2\">{swipeThreshold}</div>\n                  <div\n                    className=\"clickable px-2\"\n                    onClick={() =>\n                      dispatch(setSwipeThreshold(swipeThreshold + 1))\n                    }\n                  >\n                    +\n                  </div>\n                </div>\n\n                <div\n                  className={classNames({\n                    \"w-25 d-flex flex-row justify-content-between\": true,\n                    invisible: motionThreshold === 0,\n                  })}\n                >\n                  <div\n                    className=\"clickable px-2 pb-2\"\n                    onClick={() => {\n                      if (motionThreshold - 0.5 <= 0) {\n                        dispatch(setMotionThreshold(0));\n                      } else {\n                        dispatch(setMotionThreshold(motionThreshold - 0.5));\n                      }\n                    }}\n                  >\n                    -\n                  </div>\n                  <div\n                    className={classNames({\n                      \"px-2\": true,\n                      \"correct-color\":\n                        shakeIntensity &&\n                        shakeIntensity > motionThreshold &&\n                        shakeIntensity <= motionThreshold + 1,\n                      \"question-color\":\n                        shakeIntensity &&\n                        shakeIntensity > motionThreshold + 1 &&\n                        shakeIntensity <= motionThreshold + 2,\n                      \"incorrect-color\":\n                        shakeIntensity && shakeIntensity > motionThreshold + 2,\n                    })}\n                  >\n                    {shakeIntensity ?? motionThreshold}\n                  </div>\n                  <div\n                    className=\"clickable px-2\"\n                    onClick={() => {\n                      dispatch(setMotionThreshold(motionThreshold + 0.5));\n                    }}\n                  >\n                    +\n                  </div>\n                </div>\n              </div>\n              <div className=\"column-2\">\n                <div className=\"setting-block\">\n                  <SettingsSwitch\n                    active={darkMode}\n                    action={buildAction(dispatch, toggleDarkMode)}\n                    statusText={(darkMode ? \"Dark\" : \"Light\") + \" Mode\"}\n                  />\n                </div>\n                <div className=\"setting-block\">\n                  <SettingsSwitch\n                    active={swipeThreshold > 0}\n                    action={() => {\n                      swipeThreshold > 0\n                        ? dispatch(setSwipeThreshold(0))\n                        : dispatch(setSwipeThreshold(1));\n                    }}\n                    statusText={\"Touch Swipes\"}\n                  />\n                </div>\n                <div className=\"setting-block\">\n                  <SettingsSwitch\n                    active={motionThreshold > 0}\n                    action={() => {\n                      if (motionThreshold === 0) {\n                        dispatch(setMotionThreshold(6));\n                      } else {\n                        dispatch(setMotionThreshold(0));\n                      }\n                    }}\n                    statusText={\"Accelerometer\"}\n                  />\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div className={pageClassName}>\n          <div className=\"d-flex justify-content-between\">\n            <h2>Phrases</h2>\n            {collapseExpandToggler(sectionPhrase, setSectionPhrase)}\n          </div>\n          {sectionPhrase && (\n            <Suspense\n              fallback={\n                <NotReady addlStyle=\"phrases-settings\" text=\"Loading...\" />\n              }\n            >\n              <SettingsPhrase />\n            </Suspense>\n          )}\n        </div>\n        <div className={pageClassName}>\n          <div className=\"d-flex justify-content-between\">\n            <h2>Vocabulary</h2>\n            {collapseExpandToggler(sectionVocabulary, setSectionVocabulary)}\n          </div>\n          {sectionVocabulary && (\n            <Suspense\n              fallback={\n                <NotReady addlStyle=\"vocabulary-settings\" text=\"Loading...\" />\n              }\n            >\n              <SettingsVocab />\n            </Suspense>\n          )}\n        </div>\n        <div className={pageClassName}>\n          <div className=\"d-flex justify-content-between\">\n            <h2>Kanji</h2>\n            {collapseExpandToggler(sectionKanji, setSectionKanji)}\n          </div>\n          {sectionKanji && (\n            <Suspense\n              fallback={\n                <NotReady addlStyle=\"kanji-settings\" text=\"Loading...\" />\n              }\n            >\n              <SettingsKanji />\n            </Suspense>\n          )}\n        </div>\n        <div className={pageClassName}>\n          <div className=\"d-flex justify-content-between\">\n            <h2>Opposites Game</h2>\n            {collapseExpandToggler(sectionOpposites, setSectionOpposites)}\n          </div>\n          {sectionOpposites && (\n            <Suspense\n              fallback={\n                <NotReady addlStyle=\"opposites-settings\" text=\"Loading...\" />\n              }\n            >\n              <SettingsOppositeGame />\n            </Suspense>\n          )}\n        </div>\n        <div className={pageClassName}>\n          <div className=\"d-flex justify-content-between\">\n            <h2>Kana Game</h2>\n            {collapseExpandToggler(sectionKana, setSectionKana)}\n          </div>\n          {sectionKana && (\n            <Suspense\n              fallback={\n                <NotReady addlStyle=\"kana-settings\" text=\"Loading...\" />\n              }\n            >\n              <SettingsKanaGame />\n            </Suspense>\n          )}\n        </div>\n\n        <div className={pageClassName}>\n          <div className=\"d-flex justify-content-between\">\n            <h2>Kanji Game</h2>\n            {collapseExpandToggler(sectionKanjiGame, setSectionKanjiGame)}\n          </div>\n          {sectionKanjiGame && (\n            <Suspense\n              fallback={\n                <NotReady addlStyle=\"kanji-game-settings\" text=\"Loading...\" />\n              }\n            >\n              <SettingsKanjiGame />\n            </Suspense>\n          )}\n        </div>\n\n        <div className={pageClassName}>\n          <div className=\"d-flex justify-content-between\">\n            <h2>Particles Game</h2>\n            {collapseExpandToggler(sectionParticle, setSectionParticle)}\n          </div>\n          {sectionParticle && (\n            <Suspense\n              fallback={\n                <NotReady addlStyle=\"particle-settings\" text=\"Loading...\" />\n              }\n            >\n              <SettingsParticleGame />\n            </Suspense>\n          )}\n        </div>\n\n        <div className={pageClassName}>\n          <div className=\"d-flex justify-content-between\">\n            <h2>Study Stats</h2>\n            {collapseExpandToggler(sectionStats, setSectionStats)}\n          </div>\n          {sectionStats && (\n            <Suspense\n              fallback={\n                <NotReady addlStyle=\"stats-settings\" text=\"Loading...\" />\n              }\n            >\n              <SettingsStats />\n            </Suspense>\n          )}\n        </div>\n\n        <div className={pageClassName}>\n          <div className=\"d-flex justify-content-between\">\n            <h2>Application</h2>\n          </div>\n          <div className=\"d-flex flex-column flex-sm-row justify-content-between\">\n            <div className=\"column-1\">\n              <div className=\"setting-block mb-2 mt-2\">\n                <div\n                  className=\"d-flex flex-row w-50 w-sm-100 justify-content-between clickable\"\n                  onClick={() => {\n                    setSwVersion(\"\");\n                    setJsVersion(\"\");\n                    setBundleVersion(\"\");\n                    setTimeout(() => {\n                      navigator.serviceWorker.controller?.postMessage({\n                        type: \"SW_VERSION\",\n                      });\n                    }, 1000);\n                  }}\n                >\n                  <div className=\"pe-2\">\n                    <div>{\"swVersion:\"}</div>\n                    <div>{\"jsVersion:\"}</div>\n                    <div>{\"bundleVersion:\"}</div>\n                  </div>\n                  <div>\n                    <div>{swVersion}</div>\n                    <div>{jsVersion}</div>\n                    <div>{bundleVersion}</div>\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div className=\"column-2\">\n              <div className=\"setting-block mb-2\">\n                <SettingsSwitch\n                  active={debug > DebugLevel.OFF}\n                  action={buildAction(dispatch, debugToggled)}\n                  color=\"default\"\n                  statusText={labelOptions(debug, [\n                    \"Debug\",\n                    \"Debug Error\",\n                    \"Debug Warn\",\n                    \"Debug\",\n                  ])}\n                />\n              </div>\n              <div\n                className={classNames({\n                  \"d-flex justify-content-end mb-2\": true,\n                  \"disabled-color\": hardRefreshUnavailable,\n                })}\n              >\n                <p id=\"hard-refresh\" className=\"text-right\">\n                  Hard Refresh\n                </p>\n                <div\n                  className={classNames({\n                    \"spin-a-bit\": spin,\n                  })}\n                  style={{ height: \"24px\" }}\n                  aria-labelledby=\"hard-refresh\"\n                  onClick={() => {\n                    setSpin(true);\n                    setHardRefreshUnavailable(false);\n\n                    setTimeout(() => {\n                      if (spin) {\n                        setSpin(false);\n                        setHardRefreshUnavailable(true);\n                      }\n                    }, 3000);\n\n                    navigator.serviceWorker.controller?.postMessage({\n                      type: \"DO_HARD_REFRESH\",\n                    });\n                  }}\n                >\n                  <SyncIcon\n                    className=\"clickable\"\n                    size={24}\n                    aria-label=\"Hard Refresh\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"setting-block mb-2\">\n                <SettingsSwitch\n                  active={memory.persistent}\n                  action={buildAction(dispatch, setPersistentStorage)}\n                  disabled={memory.persistent}\n                  color=\"default\"\n                  statusText={\n                    memory.persistent\n                      ? `Persistent ${~~(memory.usage / 1024 / 1024)}\n                        /\n                        ${~~(memory.quota / 1024 / 1024)}\n                        MB`\n                      : \"Persistent off\"\n                  }\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport { SettingsMeta };\n","import { PayloadAction, createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport merge from \"lodash/fp/merge\";\n\nimport { logger } from \"./globalSlice\";\nimport {\n  DebugLevel,\n  TermFilterBy,\n  TermSortBy,\n  deleteMetadata,\n  grpParse,\n  toggleAFilter,\n  updateSpaceRepTerm,\n} from \"./settingHelper\";\nimport { dataServiceEndpoint } from \"../../environment.production\";\nimport { localStoreAttrUpdate } from \"../helper/localStorageHelper\";\nimport {\n  SR_MIN_REV_ITEMS,\n  removeAction,\n  updateAction,\n} from \"../helper/recallHelper\";\nimport { buildGroupObject, getPropsFromTags } from \"../helper/reducerHelper\";\nimport { MEMORIZED_THRLD } from \"../helper/sortHelper\";\nimport type {\n  GroupListMap,\n  MetaDataObj,\n  RawPhrase,\n  SourcePhrase,\n  ValuesOf,\n} from \"../typings/raw\";\n\nimport type { RootState } from \".\";\n\nexport interface PhraseInitSlice {\n  value: RawPhrase[];\n  version: string;\n  grpObj: GroupListMap;\n\n  setting: {\n    ordered: ValuesOf<typeof TermSortBy>;\n    englishSideUp: boolean;\n    romaji: boolean;\n    reinforce: boolean;\n    repTID: number;\n    repetition: Record<string, MetaDataObj | undefined>;\n    spaRepMaxReviewItem: number;\n    frequency: { uid?: string; count: number };\n    activeGroup: string[];\n    filter: ValuesOf<typeof TermFilterBy>;\n    difficultyThreshold: number;\n    includeNew: boolean;\n    includeReviewed: boolean;\n  };\n}\n\nexport const phraseInitState: PhraseInitSlice = {\n  value: [],\n  version: \"\",\n  grpObj: {},\n\n  setting: {\n    ordered: 0,\n    englishSideUp: false,\n    romaji: false,\n    reinforce: false,\n    repTID: -1,\n    repetition: {},\n    spaRepMaxReviewItem: SR_MIN_REV_ITEMS,\n    frequency: { uid: undefined, count: 0 },\n    activeGroup: [],\n    filter: 0,\n    difficultyThreshold: MEMORIZED_THRLD,\n    includeNew: true,\n    includeReviewed: true,\n  },\n};\n\n/**\n * For inverse tagged phrases\n * Checks that an initial uid has atleast one pair\n */\nfunction inversePairCheck<T extends SourcePhrase>(\n  initial: string,\n  object: Record<string, T>\n) {\n  let errors;\n\n  let { inverse } = getPropsFromTags(object[initial].tag);\n  let inversePair = inverse;\n\n  while (inversePair && inversePair !== initial) {\n    const { inverse } = getPropsFromTags(object[inversePair]?.tag);\n\n    if (inverse) {\n      inversePair = inverse;\n    } else {\n      // match failed\n      inversePair = undefined;\n      errors = [\n        ...(errors ?? []),\n        `Missing inverse pair for ${object[initial].japanese}`,\n      ];\n    }\n  }\n\n  return errors;\n}\n\n/**\n * Determine if a phrase is polite.\n *\n * **When** they contain multiple periods or commas; polite phrases are left **unedited**.\n *\n * *Otherwise* the period is *removed*.\n *\n * @param o\n * @returns\n */\nexport function isPolitePhrase<T extends { japanese: string }>(o: T) {\n  let polite: { japanese?: string; polite: boolean } = { polite: false };\n  if (o.japanese.endsWith(\"。\")) {\n    const [furigana, phrase] = o.japanese.split(\"\\n\");\n\n    let withoutDot;\n    if (\n      furigana.indexOf(\"。\") !== furigana.lastIndexOf(\"。\") ||\n      furigana.includes(\"、\")\n    ) {\n      // multiple 。or 、\n      // japanese is not defined. withoutDot is not used.\n      polite = { polite: true };\n    } else {\n      if (phrase?.endsWith(\"。\") && furigana.endsWith(\"。\")) {\n        withoutDot = `${furigana.slice(0, -1)}\\n${phrase.slice(0, -1)}`;\n      } else {\n        withoutDot = o.japanese.slice(0, -1);\n      }\n\n      polite = { japanese: withoutDot, polite: true };\n    }\n  }\n\n  return polite;\n}\n\nexport function buildPhraseArray<T extends SourcePhrase>(\n  object: Record<string, T>\n): { values: RawPhrase[]; errors?: string[] } {\n  let errors: undefined | string[];\n  const values = Object.keys(object).map((k) => {\n    let { tags, particles, inverse } = getPropsFromTags(object[k].tag);\n\n    errors = inversePairCheck(k, object);\n\n    const o = object[k];\n    const polite = isPolitePhrase(o);\n\n    return {\n      ...object[k],\n      uid: k,\n\n      // Not used after parsing\n      tag: undefined,\n\n      // Derived from tag\n      tags,\n      particles,\n      inverse,\n      ...polite,\n    };\n  });\n\n  return { values, errors };\n}\n\n/**\n * Fetch phrases\n */\nexport const getPhrase = createAsyncThunk(\n  \"phrase/getPhrase\",\n  async (arg, thunkAPI) => {\n    const state = thunkAPI.getState() as RootState;\n    // TODO: rename state.phrases -> state.phrase\n    const version = state.version.phrases ?? \"0\";\n\n    // if (version === \"0\") {\n    //   console.error(\"fetching phrase: 0\");\n    // }\n    const jsonValue = (await fetch(\n      dataServiceEndpoint + \"/phrases.json\",\n      {\n        headers: { \"Data-Version\": version },\n      }\n    ).then((res) => res.json())) as Record<string, SourcePhrase>;\n\n    const groups = buildGroupObject(jsonValue);\n    const { values, errors } = buildPhraseArray(jsonValue);\n    if (errors) {\n      errors.forEach((e) => {\n        thunkAPI.dispatch(logger(e, DebugLevel.WARN));\n      });\n    }\n\n    return { version, values, groups };\n  }\n);\n\nexport const phraseFromLocalStorage = createAsyncThunk(\n  \"phrase/phraseFromLocalStorage\",\n  (arg: typeof phraseInitState.setting) => {\n    const initValues = arg;\n\n    return initValues;\n  }\n);\n\nexport const deleteMetaPhrase = createAsyncThunk(\n  \"phrase/deleteMetaPhrase\",\n  (uidList: string[], thunkAPI) => {\n    const state = (thunkAPI.getState() as RootState).phrases;\n    const spaceRep = state.setting.repetition;\n\n    return deleteMetadata(uidList, spaceRep);\n  }\n);\n\nexport const updateSpaceRepPhrase = createAsyncThunk(\n  \"phrase/updateSpaceRepPhrase\",\n  (arg: { uid: string; shouldIncrement: boolean }, thunkAPI) => {\n    const { uid, shouldIncrement } = arg;\n    const state = (thunkAPI.getState() as RootState).phrases;\n\n    const spaceRep = state.setting.repetition;\n\n    return updateSpaceRepTerm(uid, spaceRep, {\n      count: shouldIncrement,\n      date: true,\n    });\n  }\n);\n\nexport const removeFromSpaceRepetition = createAsyncThunk(\n  \"phrase/removeFromSpaceRepetition\",\n  (arg: { uid: string }, thunkAPI) => {\n    const { uid } = arg;\n    const state = (thunkAPI.getState() as RootState).phrases;\n\n    const spaceRep = state.setting.repetition;\n    return removeAction(uid, spaceRep);\n  }\n);\n\nexport const setSpaceRepetitionMetadata = createAsyncThunk(\n  \"phrase/setSpaceRepetitionMetadata\",\n  (arg: { uid: string }, thunkAPI) => {\n    const { uid } = arg;\n    const state = (thunkAPI.getState() as RootState).phrases;\n\n    const spaceRep = state.setting.repetition;\n    return updateAction(uid, spaceRep);\n  }\n);\n\nconst phraseSlice = createSlice({\n  name: \"phrase\",\n  initialState: phraseInitState,\n  reducers: {\n    /**\n     * Toggle between group, frequency, and tags filtering\n     */\n    togglePhrasesFilter(\n      state,\n      action: { payload?: ValuesOf<typeof TermFilterBy> }\n    ) {\n      const override = action.payload;\n\n      const allowed = [TermFilterBy.FREQUENCY, TermFilterBy.GROUP];\n\n      const { filter, reinforce } = state.setting;\n\n      const newFilter = toggleAFilter(\n        filter + 1,\n        allowed,\n        override\n      ) as ValuesOf<typeof TermFilterBy>;\n\n      state.setting.filter = localStoreAttrUpdate(\n        new Date(),\n        { phrases: state.setting },\n        \"/phrases/\",\n        \"filter\",\n        newFilter\n      );\n\n      if (newFilter !== TermFilterBy.GROUP && reinforce) {\n        state.setting.reinforce = false;\n      }\n    },\n\n    togglePhraseActiveGrp(state, action: { payload: string }) {\n      const grpName = action.payload;\n\n      const { activeGroup } = state.setting;\n\n      const groups = Array.isArray(grpName) ? grpName : [grpName];\n      const newValue: string[] = grpParse(groups, activeGroup);\n\n      state.setting.activeGroup = localStoreAttrUpdate(\n        new Date(),\n        { phrases: state.setting },\n        \"/phrases/\",\n        \"activeGroup\",\n        newValue\n      );\n    },\n    togglePhrasesReinforcement(\n      state,\n      action: { payload: boolean | undefined }\n    ) {\n      const newValue = action.payload;\n\n      state.setting.reinforce = localStoreAttrUpdate(\n        new Date(),\n        { phrases: state.setting },\n        \"/phrases/\",\n        \"reinforce\",\n        newValue\n      );\n    },\n\n    setMemorizedThreshold(state, action: { payload: number }) {\n      const threshold = action.payload;\n\n      state.setting.difficultyThreshold = localStoreAttrUpdate(\n        new Date(),\n        { phrases: state.setting },\n        \"/phrases/\",\n        \"difficultyThreshold\",\n        threshold\n      );\n    },\n\n    setPhraseDifficulty: {\n      reducer: (\n        state: PhraseInitSlice,\n        action: { payload: { uid: string; value: number | null } }\n      ) => {\n        const { uid, value } = action.payload;\n\n        const { record: newValue } = updateSpaceRepTerm(\n          uid,\n          state.setting.repetition,\n          { count: false, date: false },\n          {\n            set: { difficultyP: value },\n          }\n        );\n\n        state.setting.repTID = Date.now();\n        state.setting.repetition = localStoreAttrUpdate(\n          new Date(),\n          { phrases: state.setting },\n          \"/phrases/\",\n          \"repetition\",\n          newValue\n        );\n      },\n      prepare: (uid: string, value: number | null) => ({\n        payload: { uid, value },\n      }),\n    },\n    /**\n     * Space Repetition maximum item review\n     * per session\n     */\n    setSpaRepMaxItemReview(state, action: PayloadAction<number>) {\n      const value = Math.max(SR_MIN_REV_ITEMS, action.payload);\n\n      state.setting.spaRepMaxReviewItem = localStoreAttrUpdate(\n        new Date(),\n        { phrases: state.setting },\n        \"/phrases/\",\n        \"spaRepMaxReviewItem\",\n        value\n      );\n    },\n    setPhraseAccuracy: {\n      reducer: (\n        state: PhraseInitSlice,\n        action: { payload: { uid: string; value: number | null } }\n      ) => {\n        const { uid, value } = action.payload;\n\n        const { record: newValue } = updateSpaceRepTerm(\n          uid,\n          state.setting.repetition,\n          { count: false, date: false },\n          {\n            set: { accuracyP: value },\n          }\n        );\n\n        state.setting.repTID = Date.now();\n        state.setting.repetition = localStoreAttrUpdate(\n          new Date(),\n          { phrases: state.setting },\n          \"/phrases/\",\n          \"repetition\",\n          newValue\n        );\n      },\n      prepare: (uid: string, value: number | null) => ({\n        payload: { uid, value },\n      }),\n    },\n\n    addFrequencyPhrase(state, action: PayloadAction<string>) {\n      const uid = action.payload;\n      const { record: newValue } = updateSpaceRepTerm(\n        uid,\n        state.setting.repetition,\n        { count: false, date: false },\n        {\n          set: { rein: true },\n        }\n      );\n\n      state.setting.repTID = Date.now();\n      state.setting.repetition = localStoreAttrUpdate(\n        new Date(),\n        { phrases: state.setting },\n        \"/phrases/\",\n        \"repetition\",\n        newValue\n      );\n\n      let frequency = { uid, count: state.setting.frequency.count + 1 };\n      state.setting.frequency = localStoreAttrUpdate(\n        new Date(),\n        { phrases: state.setting },\n        \"/phrases/\",\n        \"frequency\",\n        frequency\n      );\n    },\n\n    removeFrequencyPhrase(state, action: { payload: string }) {\n      const uid = action.payload;\n\n      const spaceRep = state.setting.repetition;\n      if (spaceRep[uid]?.rein === true) {\n        // null to delete\n        const { record: newValue } = updateSpaceRepTerm(\n          uid,\n          spaceRep,\n          { count: false, date: false },\n          {\n            set: { rein: null },\n          }\n        );\n\n        state.setting.repTID = Date.now();\n        state.setting.repetition = localStoreAttrUpdate(\n          new Date(),\n          { phrases: state.setting },\n          \"/phrases/\",\n          \"repetition\",\n          newValue\n        );\n\n        let frequency = { uid, count: state.setting.frequency.count - 1 };\n        state.setting.frequency = localStoreAttrUpdate(\n          new Date(),\n          { phrases: state.setting },\n          \"/phrases/\",\n          \"frequency\",\n          frequency\n        );\n      }\n    },\n\n    flipPhrasesPracticeSide(state) {\n      state.setting.englishSideUp = localStoreAttrUpdate(\n        new Date(),\n        { phrases: state.setting },\n        \"/phrases/\",\n        \"englishSideUp\"\n      );\n    },\n\n    togglePhrasesRomaji(state) {\n      state.setting.romaji = localStoreAttrUpdate(\n        new Date(),\n        { phrases: state.setting },\n        \"/phrases/\",\n        \"romaji\"\n      );\n    },\n\n    togglePhrasesOrdering(\n      state,\n      action: PayloadAction<ValuesOf<typeof TermSortBy>>\n    ) {\n      const allowed = [\n        TermSortBy.RANDOM,\n        TermSortBy.VIEW_DATE,\n        TermSortBy.RECALL,\n      ];\n      const override = action.payload;\n\n      const { ordered } = state.setting;\n\n      let newOrdered = toggleAFilter(\n        ordered + 1,\n        allowed,\n        override\n      ) as ValuesOf<typeof TermSortBy>;\n\n      state.setting.ordered = localStoreAttrUpdate(\n        new Date(),\n        { phrases: state.setting },\n        \"/phrases/\",\n        \"ordered\",\n        newOrdered\n      );\n    },\n    toggleIncludeNew(state) {\n      state.setting.includeNew = localStoreAttrUpdate(\n        new Date(),\n        { phrases: state.setting },\n        \"/phrases/\",\n        \"includeNew\"\n      );\n    },\n    toggleIncludeReviewed(state) {\n      state.setting.includeReviewed = localStoreAttrUpdate(\n        new Date(),\n        { phrases: state.setting },\n        \"/phrases/\",\n        \"includeReviewed\"\n      );\n    },\n  },\n\n  extraReducers: (builder) => {\n    builder.addCase(getPhrase.fulfilled, (state, action) => {\n      const { version, values, groups } = action.payload;\n      state.grpObj = groups;\n      state.value = values;\n      state.version = version;\n    });\n\n    builder.addCase(phraseFromLocalStorage.fulfilled, (state, action) => {\n      const localStorageValue = action.payload;\n      const mergedSettings = merge(phraseInitState.setting, localStorageValue);\n\n      const phraseReinforceList = Object.keys(mergedSettings.repetition).filter(\n        (k) => mergedSettings.repetition[k]?.rein === true\n      );\n      mergedSettings.frequency = {\n        uid: undefined,\n        count: phraseReinforceList.length,\n      };\n\n      return {\n        ...state,\n        setting: { ...mergedSettings, repTID: Date.now() },\n      };\n    });\n    builder.addCase(updateSpaceRepPhrase.fulfilled, (state, action) => {\n      const { record: newValue } = action.payload;\n\n      state.setting.repTID = Date.now();\n      state.setting.repetition = localStoreAttrUpdate(\n        new Date(),\n        { phrases: state.setting },\n        \"/phrases/\",\n        \"repetition\",\n        newValue\n      );\n    });\n    builder.addCase(setSpaceRepetitionMetadata.fulfilled, (state, action) => {\n      const { newValue } = action.payload;\n\n      state.setting.repTID = Date.now();\n      state.setting.repetition = localStoreAttrUpdate(\n        new Date(),\n        { phrases: state.setting },\n        \"/phrases/\",\n        \"repetition\",\n        newValue\n      );\n    });\n    builder.addCase(removeFromSpaceRepetition.fulfilled, (state, action) => {\n      const newValue = action.payload;\n\n      if (newValue) {\n        state.setting.repTID = Date.now();\n        state.setting.repetition = localStoreAttrUpdate(\n          new Date(),\n          { phrases: state.setting },\n          \"/phrases/\",\n          \"repetition\",\n          newValue\n        );\n      }\n    });\n\n    builder.addCase(deleteMetaPhrase.fulfilled, (state, action) => {\n      const { record: newValue } = action.payload;\n\n      state.setting.repTID = Date.now();\n      state.setting.repetition = localStoreAttrUpdate(\n        new Date(),\n        { phrases: state.setting },\n        \"/phrases/\",\n        \"repetition\",\n        newValue\n      );\n    });\n  },\n});\n\nexport const {\n  flipPhrasesPracticeSide,\n  togglePhrasesRomaji,\n  togglePhrasesFilter,\n  togglePhraseActiveGrp,\n  togglePhrasesReinforcement,\n  toggleIncludeNew,\n  toggleIncludeReviewed,\n  addFrequencyPhrase,\n  setPhraseDifficulty,\n  setPhraseAccuracy,\n  setMemorizedThreshold,\n  setSpaRepMaxItemReview,\n\n  removeFrequencyPhrase,\n  togglePhrasesOrdering,\n} = phraseSlice.actions;\nexport default phraseSlice.reducer;\n"],"names":[],"mappings":";;;;;;;;;;AAgCA;;;;;;;;AASA;;;;;;;;;;;;AAaA;;;;AAyBA;;;AAGA;AACA;AACA;;;AAGA;AACA;;;AAGA;;;;;;;;;AASA;;AAEA;AACA;AACA;;;AAGA;;;;;AAKA;;AAEA;;;;AAIA;;;;;;;;;;;;;;;AC9EA;;;;;;;;;;;;;;;AAgBA;;;;;;;;;;;;;;;AAgBA;AA2FA;AACA;;AA+BA;AACA;;AAgCA;AACA;ACpOA;;;;;;AAMA;;ACioBA;AACA;ACtgBA"}